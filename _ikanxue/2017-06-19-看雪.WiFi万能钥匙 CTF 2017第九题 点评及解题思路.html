---
title: 看雪.WiFi万能钥匙 CTF 2017第九题 点评及解题思路
author: 看雪学院
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1498051979&src=3&ver=1&signature=nULoNfhbsabgcFJEB9PUQyx1hdTxM6K*VNtcxOeUN354nW26WI5lTIy9FI3*gxCaEHwjjiMY16zPEkDRPZ*5EDahRkV9Y0RvDlydxvDRIorEYLQuD1ul8XQxRD8bq52pWttbh4WSMC2okz69WgA7jlgU2*T28luMaDgCXlH0Zms=
date: '2017-06-19 00:00:00 +0000'

---

{% raw  %}
<section style="background-color: rgb(255, 255, 255); box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="transform: translate3d(0px, 0px, 0px); text-align: center; margin: 30px 0% 20px; box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; width: 90%; vertical-align: top; background-color: rgb(223, 241, 238); padding: 5px; border-width: 0px; border-radius: 5px; border-style: none; border-color: rgb(62, 62, 62); box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; width: 100%; vertical-align: top; background-color: rgb(223, 241, 238); border-style: dashed; border-width: 1px; border-radius: 5px; border-color: rgb(74, 179, 172); padding: 10px; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: left; margin: -35px 0% 0px; transform: translate3d(-30px, 0px, 0px); box-sizing: border-box; font-size: 16px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EbL4Qw95bfyIM3rnNynl14PKicECpSXbJIiaNxIjMAGADPy74OuHSxkuYicb7Gkj5CDs1aL9o9jqA6A/640?wx_fmt=png" style="max-width: 100%; vertical-align: middle; box-sizing: border-box; font-size: 16px; visibility: visible !important; width: 15% !important; height: auto !important;"></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: justify; font-size: 15px; color: rgb(45, 66, 87); padding: 0px 10px; line-height: 1.8; box-sizing: border-box;"><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;">看雪CTF 2017 比赛进行至第九题</p><section><section><section><section><p>截止至今天中午12点，第九题破解人数为2人！</p><p>防守方 hsadkhk 夺下首位~<br></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7usicup5uOERDBSYSpUgBeNZdQUURuK07v4Dt4oaYI732GM1p6pC4HXg/0?wx_fmt=png" style="width: 336px !important; height: 374px !important; visibility: visible !important;"></p><p style="margin-top: 15px; margin-bottom: 15px;">此题过后，前十名排名保持不变。<br></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7sxdBNFicfVGt8HQAfCFfNWLN6M4ocxjrTuHNuuEfBpBMu8UlD8G2nrg/0?wx_fmt=png" style="width: 313px !important; height: 390px !important;"></p><p style="color: rgb(45, 66, 87); font-size: 15px; text-align: justify; white-space: normal; background-color: rgb(223, 241, 238);">这道题是否会成为分水岭式的一道题呢？<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><p style="color: rgb(45, 66, 87); font-size: 15px; text-align: justify; white-space: normal; background-color: rgb(223, 241, 238);">是否会有黑马一战成名呢？</p><p>期待ing......<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><p>接下来我们来回顾一下第九题</p><p>看看 看雪评委和出题者是怎么说的ヾ(๑╹◡╹)ﾉ"。</p></section></section></section></section></section></section></section></section></section></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 16px;"><br style="box-sizing: border-box; font-size: 16px;"></p></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 10px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; width: 100%; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; transform: translate3d(0px, 0px, 0px); box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; padding-left: 5px; padding-right: 5px; margin-bottom: 4px; box-sizing: border-box;"><p><span style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;">看雪评委 netwind 点评</span></p></section><section style="border-top: 2px dotted rgb(202, 198, 198); width: 100%; box-sizing: border-box; font-size: 16px;"></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; line-height: 1.8; padding: 2px 0px; box-sizing: border-box;"><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;"><span style="letter-spacing: 0px; box-sizing: border-box; font-size: 15px;">该题既要求选手有一定的crack功底，又需要掌握一定的PWN技巧。该题数据通过DES加密后传入，DES密钥隐藏在一个八元一次方程组里。程序的主体部分是作者实现的一个简单的基于栈的虚拟机，程序的漏洞存在于对索引类型数据边界没有作严格检查，通过编排数据，在未初始化的虚拟机栈上构造出一个越界的指针，使用load和store来索引的时候就会产生一个越界的读写，从而控制返回值。由于程序始终没有任何输出，并且禁用了大量系统调用，使得此题难度陡增，是十分精彩的一题！<br><br></span></p></section></section></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 10px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; width: 100%; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; transform: translate3d(0px, 0px, 0px); box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; padding-left: 5px; padding-right: 5px; margin-bottom: 4px; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 18px;">作者简介</p></section><section style="border-top: 2px dotted rgb(202, 198, 198); width: 100%; box-sizing: border-box; font-size: 16px;"></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; line-height: 1.8; padding: 2px 0px; box-sizing: border-box;"><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;"><span style="letter-spacing: 0px; box-sizing: border-box; font-size: 15px;"><br></span></p><p style="text-align: left;">虽然看雪ID是 hsadkhk，不过我常用的 id 其实是 explorer。是一个在读大学单身狗，大学期间最大的愿望是能参加一次 defcon。比较擅长的方向是pwn。接触看雪的时间和学二进制的时间一样长，在看雪学习了很多。这次受 netwind 大佬邀请出了一个pwn题，欢迎喜欢做二进制的朋友一起交流经验。</p><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;"><span style="letter-spacing: 0px; box-sizing: border-box; font-size: 15px;"><br></span></p></section></section></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 10px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; width: 100%; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; transform: translate3d(0px, 0px, 0px); box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; padding-left: 5px; padding-right: 5px; margin-bottom: 4px; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 18px;">看雪 CTF2017 第八题设计思路</p></section><section style="border-top: 2px dotted rgb(202, 198, 198); width: 100%; box-sizing: border-box; font-size: 16px;"><br></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; line-height: 1.8; padding: 2px 0px; box-sizing: border-box;"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">一个不算是太难的pwn题吧。属于正常人类能做出来的题目范畴。</p><h4 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;"><span style="font-size: 16px; text-decoration: underline;"><strong>设计思路</strong></span></h4><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">这一题的灵感来源于刚刚结束的DEF CON2017的mute和insanity两个题目。结合了这两个题目比较有趣的点之后写出了这题Silence Server。</p><h5 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;"><span style="font-size: 15px;">1. 禁用 syscall</span></h5><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">Silence
 
Server 顾名思义，整个题目没有任何一句输出的代码，甚至使用了seccomp来禁用掉了包括 write 在内的绝大部分系统调用。因为 seccomp 对系统调用的禁用是不可能被取消的。所以即使能通过透漏控制程序执行或者拿到 shell。也无法将 flag 输出回来。这个是这一题的比较坑人的地方。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">下面是禁用 syscall 的代码。除了白名单中的 10 个系统调用之外，其他全部无法使用。</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7oiaicrfMdd6TeKvWMTowvSsia3Of82APWays07Hh66X78iaNkLtMlXVL6Q/0?wx_fmt=png" style="width: 560px !important; height: 444px !important;"></p><h5 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;"><span style="font-size: 15px;">2. 简单虚拟机</span></h5><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">这个程序的主体部分是我自己实现的一个非常简单的基于栈的虚拟机。整个虚拟机只有17条指令。除了 push_d 指令之外的所有指令的操作数都是存放在一个栈中的。类似于x86上浮点指令的语法。当然和普通vm指令不同的一点是这个虚拟机是区分数据与索引的。对于纯粹的数据与索引有两套不同的字节码运算指令。我将64bit数据的最高位作为flag来区分数据与索引。最高位为1的数据将会被解释为索引类型，对这种类型的加减运算将会检查索引边界是否超过栈的范围(可以认为一个固定大小的栈是这个这个虚拟机的所有内存，不能索引超过栈内存的数据)。当然，程序的漏洞其实也就存于索引类型边界没有严格检查的地方。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">下面是 17 个 opcode 的定义。行为根据名字应该就能猜到。</p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7pO3PAXFVeAGHRTKo1IjeRFLQZLgwf14fNxNRNRs5eooM0laJYYWquQ/0?wx_fmt=png" style="width: 217px !important; height: 293px !important;"></p><h5 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;"><span style="font-size: 15px;">3. des 解密与求解 8 元一次方程组</span></h5><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">最后是程序的输入部分，为了不让程序的输入部分太过直白:) 
而且也为了满足后续漏洞利用的一个重要条件。程序需要用户输入des加密过opcode和密钥。我写了一个8元一次方程组，输入的密钥必须是此方程组的解才能进行解密。当然，des不用静态编译肯定是不够意思的：）</p><h4 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;"><span style="text-decoration: underline;"><strong>破解思路</strong></span></h4><h5 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;"><span style="font-size: 15px;">1. 输入数据</span></h5><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">为了能够输入数据，让虚拟机执行。首先要做的就是解 8 元一次方程组来获取密钥。方法和工具有很多z3，angr，matlab，python 的数学库。即使是手算我想也不是很困难：-）</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">然后就是 des 加密和生成字节码的工作。des加密很简单，我用的是标准的 DES-CBC。用 python 的 Crypto 库可以轻松加密。至于生成字节码，因为只有 17 个字节码而且几乎没有后继的立即数。所以直接写一个 python 字典来替换就可以了。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">下面就是生成一个完整 payload 的代码</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7eG6631fyjZV4pOlSxjAXtcXsh1eAj1M41ibEibLDibkj17ias5r7hFurTQ/0?wx_fmt=png" style="width: 770px !important; height: 351.168px !important;"></p><h5 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;"><span style="font-size: 15px;">2. 漏洞位置以及利用</span></h5><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">首先，这题我开启 linux 上的全部6种二进制漏洞保护：）所以普通的 shellcode，栈溢出等是没法用的，而且 mmap，mprotect 等系统调用都被禁用了。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">虚拟机中提供了 load 和 store 可以存取索引类型所引用的内存的功能。而且在load和 store 中其实是不检查索引类型是否越界的。对索引越界的检查全部都是放在索引类型写到栈上的时候。具体来说就是 change_to_point，p_add，p_add 这 3 个 opcode 中会检查。这样可以保证所有写入到栈上的索引类型不越界。程序的漏洞就在于，虚拟机使用的栈是存放在系统栈上的，而且在使用之前没有被初始化过。这样我们可以通过编排数据，来在未初始化的虚拟机栈上构造出一个越界的指针。这样使用load和store来索引的时候就会产生一个越界的读写。从而控制返回值。</p><h5 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;"><span style="font-size: 15px;">3. 具体利用细节</span></h5><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">首先是如何在虚拟中栈上构造越界的索引。在 getCode 函数中，输入的加密数据也是储存在栈上的。所以只要在加密数据之后构造就可以了。而且 opcode 中有 stop 这个指令，所以不用担心解密出来的错误code。这样就可以在 runCode 的虚拟机栈上构造出一个越界的索引了。当然，具体的偏移需要好好算一算</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">然后是 pie/aslr 绕过。因为 aslr 和 pie 的关系。内存中的地址都是随机的。因为没有输出，所以没有办法 leak 地址。不过只要将返回值读取进来，直接写字节码来对返回地址加减偏移，再将算好的地址写回去。这样就可以在不 leak 的情况下调用任意的 libc 函数以及 rop 了。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">下面是读取并计算 libc 以及程序加载基地址，并且储存在栈最低位的代码</p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7UPmLJQyvFwgnxia75Apd6ZKNVibdGq1ayxmu8ibbmUPHv0heazDiahvfuA/0?wx_fmt=png" style="width: 244px !important; height: 457px !important;"></p><h4 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><strong><span style="font-size: 15px;">side attack</span></strong></h4><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">虽然通过漏洞能够成功的执行rop。通过open，read就可以将flag读取到内存中。但是还是没有办法将flag输出出来。所以只能用side attack。我在libc里找到了这样一条rop</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7fjOepiaz3wKPDjNMgYCPHJZMlF8hd6fp7A9c1MguYJBl2kpXhic2ccKw/0?wx_fmt=png" style="width: 617px !important; height: 73px !important;"></p><p style="margin-bottom: 15px; line-height: 1.75em; margin-top: 15px;">当cl等于[rsi]的时候则跳转。否则返回。我们看一下跳转后的代码。</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7YbGibNOAibzoibxncn0ItfI8F3SvaaflEPWWHyUicXMpmTcezTib7icxLAvw/0?wx_fmt=png" style="width: 735px !important; height: 145px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">如果我们将rdi设置为0 。就能够让程序崩溃退出。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">只要将rsi指向读取到的flag，再通过rop设置cl。这样就可以让flag和我们指定的字节做比较。如果正确程序就崩溃退出。如果错误的话，下一个rop链可以跳转一个getchar来block停住程序。这样就可以根据程序是否崩溃来爆破flag的值了。通过反复的连接测试就可以得到完整的flag。</p></section></section></section></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; transform: translate3d(0px, 0px, 0px); box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; padding-left: 5px; padding-right: 5px; margin-bottom: 4px; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 18px;">下面选取攻击者 <span class="">kkHAIKE</span> 的破解分析</p></section><section style="border-top: 2px dotted rgb(202, 198, 198); width: 100%; box-sizing: border-box; font-size: 16px;"></section></section></section></section><p><br></p><p><span style="letter-spacing: 0px; box-sizing: border-box; font-size: 15px;"></span></p><section label="Copyright Reserved by ipaiban.com." style="text-align: left; margin: 5px 0px 0px; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; border-style: none;"><section style="display: inline-block; padding: 0.5em; border-radius: 3px; color: white; font-size: 1em; box-shadow: 0.1em 0.1em 0.2em rgb(165, 165, 165); background-color: rgb(0, 0, 0);"><p class="" style="color: rgb(255, 255, 255); line-height: 22px; font-size: 18px;">前言<br></p></section></section><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">1. 这题又是一个 pwn，促使我觉得自身的水平实在不够(第四题就用完了)，就去学习各路 dalao 的 writeup，</span><span style="font-size: 15px;">附赠一篇</span><span style="font-size: 15px;">。</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">2. 体会到几个工具的便利：</span></p><ul style="list-style-type: circle;" class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">checksec，替换我之前用命令行查看程序安全特征</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">pwntools，替换我之前用的 python 自带库 subprocess/telnetlib</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">ROPgadget，别人都在用，用的人都说叼，我还是手动靠谱</span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">3. 学到几个 pwn 关键词</span></p><ul style="list-style-type: circle;" class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><strong><span style="font-size: 15px;">ROP</span></strong><span style="font-size: 15px;"> 就是复写函数返回堆栈之后一系列的堆栈内容的集合</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><strong><span style="font-size: 15px;">gadget</span></strong><span style="font-size: 15px;"> 就是在所有已确认的二进制文件中可利用的代码片段</span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">4. 在做这题的过程中踩了无数坑，我会在 writeup 中提到部分坑点(毕竟踩完坑才能写出这篇)。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">5. 这题"可谓集大成也"，我会分反汇编、pwn 两大部分阐明<br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><hr><p><br></p><section label="Copyright Reserved by ipaiban.com." style="text-align: left; margin: 5px 0px 0px; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; border-style: none;"><section style="display: inline-block; padding: 0.5em; border-radius: 3px; color: white; font-size: 1em; box-shadow: 0.1em 0.1em 0.2em rgb(165, 165, 165); background-color: rgb(0, 0, 0);"><p class="" style="color: rgb(255, 255, 255); line-height: 22px; font-size: 18px;">反汇编<br></p></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px; text-decoration: none; background-color: rgb(0, 0, 0); color: rgb(255, 251, 0);"><strong>主函数</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">主函数流程比较简单，就不贴代码了</span></p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">设置 seccomp 规则(后详)</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">获取 虚拟机指令码</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">执行 虚拟机</span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(255, 251, 0); background-color: rgb(0, 0, 0); font-size: 16px;"><strong><span style="background-color: rgb(0, 0, 0); color: rgb(255, 251, 0);">获取虚拟机指令码</span></strong></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC76gmmQjc5uFtyr9tCibjkpWJyEmtJ5a9r1zGz4HRJhDR23hSZ7e5AflQ/0?wx_fmt=png" style="width: 770px !important; height: 1382.97px !important;"><br></p><p style="line-height: 1.75em; text-align: center; margin-top: 15px; margin-bottom: 10px;"><span style="font-size: 15px;">图1</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 10px;"><span style="font-size: 15px;">1. 一上来就要解个8元线性方程组，用 python 写个</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7oHkUa44UMCkqgavibkFbsgOUgYmbtwhDgvzdNYVC15Q7OMoZCm0f0Vw/0?wx_fmt=png" style="width: 708px !important; height: 245px !important;"></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">2. 解出 key 为 3378704c30723352</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">3. 根据 图2 画框几处特征辨析为 des 的 set_key 过程</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7B2Yl01aBQV3Ifywk9ntnoqtbjWJLzk1PPnY7jmgAUwDFsDtysVCA8Q/0?wx_fmt=png" style="width: 770px !important; height: 468.769px !important;"><br></p><p style="margin-top: 5px; margin-bottom: 5px; line-height: normal; text-align: center;"><span style="font-size: 15px;">图2</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">4. 记录坑点，之前我并没有仔细看
 des_cbc 函数内的算法，就拿普通的 des_ecb 做了测试，发现解密的结果不对，然后就偷懒直接改函数最后一个参数(mode 
0解密，1加密)让程序帮我生成密文，直到后面实在需要自动生成 payload 之后才回过头看这个。</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">5. 根据图 1 和图 3 几处特征：</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">① 加密函数需要比 ecb 多传一个参数 IV，并且 IV 就是 key 本身；</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">② 加密时先用 IV 与 明文 异或，再用结果加密符合 cbc 特点。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7hibrRh1Vl1zVL4cD83jjmrmWcbel5OjqVqunEOjGZlv9Rjibhygr1T8w/0?wx_fmt=png" style="width: 455px !important; height: 411px !important;"></p><p style="text-align: center;"><span style="font-size: 15px;">图3</span></p><h3 style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="color: rgb(255, 251, 0); background-color: rgb(0, 0, 0); font-size: 16px;"><strong><span style="background-color: rgb(0, 0, 0); color: rgb(255, 251, 0);">执行虚拟机</span></strong></span></h3><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">该部分代码很长也比较晦涩，感觉要纯靠经验和耐心看完，所以我只附上虚拟机的指令解释。</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">这个虚拟机是基于堆栈的虚拟机，函数内有个 1000 字节的堆栈数组变量，我就命名为 buf 吧(其实命名 stack 更合理)，本文之后出现的 buf 没特殊说明外均指该数组，命名 栈顶指针 为 bufp，定义 次顶层堆栈 为 栈次(bufp-1)</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7rytDiaLa5H6M4EOiaphRRvf4cpn2D9vDtPqPliab10l3BQsN4HKVqILzQ/0?wx_fmt=png" style="width: 770px !important; height: 517.407px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">有几个坑点要注意：</span></p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">指令结束，栈空则崩溃(bufp == buf)</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">指令完整执行完，也崩溃，一定要用 exit 退出</span></p></li></ul><h3 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(255, 251, 0); background-color: rgb(0, 0, 0); font-size: 16px;"><strong><span style="background-color: rgb(0, 0, 0); color: rgb(255, 251, 0);">反汇编总结</span></strong></span></h3><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我们有在 执行虚拟机 函数内随意而又精准得操控 buf 变量之后堆栈的能力，能在这个函数末尾构建 ROP。</span></p><section label="Copyright Reserved by ipaiban.com." style="text-align: left; margin: 5px 0px 0px; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; border-style: none;"><section style="display: inline-block; padding: 0.5em; border-radius: 3px; color: white; font-size: 1em; box-shadow: 0.1em 0.1em 0.2em rgb(165, 165, 165); background-color: rgb(0, 0, 0);"><p class="" style="color: rgb(255, 255, 255); line-height: 22px; font-size: 18px;">PWN<br></p></section></section><h2><br><span style="font-size: 15px;"></span><span style="font-size: 15px;"></span></h2><h2><strong><span style="color: rgb(255, 251, 0); background-color: rgb(0, 0, 0); font-size: 16px;">函数安全扫描</span></strong></h2><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">看到 dalao 们一开始都会做这个，学习一下&nbsp;./checksec.sh --file Silence_Server</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7FowLuEGCaXnHXQKLn7KQKP1HzrrvWzoD89DeutYTqxdPiaVdwCq3eibQ/0?wx_fmt=png" style="width: 770px !important; height: 66.14px !important;"></p><ol style="padding: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 35px; color: rgb(47, 47, 47); font-family: none; font-size: 18px; background-color: rgb(247, 247, 247);" class="list-paddingleft-2"><li><p><span style="font-size: 15px;">Full RELRO + PIE enabled = 有 ASLR</span></p></li><li><p><span style="font-size: 15px;">Canary found = 函数有堆栈保护</span></p></li><li><p><span style="font-size: 15px;">NX enabled = 堆栈代码不可执行</span></p></li></ol><h3 style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><strong><span style="color: rgb(255, 251, 0); background-color: rgb(0, 0, 0); font-size: 16px;">seccomp</span></strong></h3><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">seccomp 是个能在程序中开启的沙盒，能根据规则限制自身以及子进程的 syscall 访问，先贴个代码看程序准我们干什么</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7iagHw9kL6Q7fYW5oabICicAeKD1f9vKf3NAnmzTEK257zrcLwvJCXZHA/0?wx_fmt=png" style="width: 554px !important; height: 381px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">记录坑点，之前我还不知道 seccomp 沙盒机制的时候，看到放行了 execve，就自认为能调用system("/bin/sh")了，然后洋洋洒洒的写了一大板 ROP 准备测试。什么！！错误的系统调用，看来被 seccomp 限制住了，然后尝试&nbsp;execve("/bin/sh",0,0)&nbsp;也是一样，最后自己写个简易的测试代码，在这个规则下，连空程序都无法启动，血的教训，一定要先写测试代码</span></p><h3 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px;"><strong><span style="color: rgb(255, 251, 0); background-color: rgb(0, 0, 0);">尝试绕过 seccomp</span></strong></span><span style="font-size: 15px;"></span></h3><ol style="list-style-type: decimal;" class="list-paddingleft-2"><li><h3 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">因为没有 write 的 syscall，这个规则下无法输出任何东西，我在想能不能尝试绕过呢</span><span style="font-size: 15px;"></span></h3></li><li><h3 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">在还是在不知道 seccomp 多强的情况下，我尝试自己调用 seccomp_release/seccomp_reset 等，都无法去除已调用 seccomp_load 被内核载入的规则</span><span style="font-size: 15px;"></span></h3></li><li><h3 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">搜到网上的一篇</span><span style="font-size: 15px;">文章</span><span style="font-size: 15px;">，里面提到用 retf 切换 cpu 成32位可以绕过过为64位写的规则，但文章里的题目堆栈是可执行 shellcode 的，也许这条路能走通，我没有深入</span></h3></li></ol><h3 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(255, 251, 0); background-color: rgb(0, 0, 0); font-size: 16px;"><strong><span style="background-color: rgb(0, 0, 0); color: rgb(255, 251, 0);">柳暗花明</span></strong></span></h3><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我反复思考了规则内能使用的 syscall，都没有想出任何用法，没有 mprotect，不能把堆栈变为可执行，brk 也只能更改 映射的下限，其他的都是文件操作了，难道就没有路走了么？</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">程序题干里，与第四题不同的是详细的说明了 flag 的路径/home/pwn/flag，提示了我这题应该要用 open 直接 read 内容</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">突然脑袋里闪过这一题的标题
 Silence Server，silence 是沉默的意思，我想到了一个就算不输出，不说话也能够交流的办法。我可以问程序：第一位是 a 
么？不是的话程序退出了，是的话程序正常进行。这样考虑，就算不用说话只要它能听懂就能够交流出结果</span></p><h3 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(255, 251, 0); background-color: rgb(0, 0, 0); font-size: 16px;"><strong><span style="background-color: rgb(0, 0, 0); color: rgb(255, 251, 0);">ROP 构思</span></strong></span></h3><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p><span style="font-size: 15px;">open 是可以使用的 syscall，我可以操控堆栈，把文件名用堆栈传给 open</span></p></li><li><p><span style="font-size: 15px;">read 也可以使用，我可以在内存映射中找一块固定的可写的区域，存放读出文件内容</span></p></li><li><p><span style="font-size: 15px;">记录坑点，之前我为了找 open 的返回(rax)转成 read 的参数(rdi)，花了很久时间，结果突然想到，open 返回的是从 0 开始的数字，0/1/2 被系统内定成 标准输入输出 了，从 3 开始就能够被程序自身使用，一般情况下，就是 3 (这里考试要考)</span></p></li><li><p><span style="font-size: 15px;">可以用 memcmp，文件内容的处字符和我指定位置的字符(可以随意找个有指定字符的地址，不用自己输入，很多地方都有)</span></p></li><li><p><span style="font-size: 15px;">最后判断 memcmp 的结果，不一样就退出程序，一样就继续程序的执行</span></p></li></ul><p><br></p><h3 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(255, 251, 0); background-color: rgb(0, 0, 0); font-size: 16px;"><strong><span style="background-color: rgb(0, 0, 0); color: rgb(255, 251, 0);">gadget 寻找</span></strong></span></h3><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">从构思看我们需要</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">1. 从堆栈转移到参数寄存器的利用点，64 位 linux，调用约定前三个参数是 rdi、rsi、rdx，大家也可以用 ROPgadget 工具，我用的是 keypatch 生成字节码，用 winhex 搜索</span></p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">pop rdi; ret (5F C3) Silence_Server +0xfe3</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">pop rsi; ret (5E C3) libc.so +0x21747</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">pop rdx; ret (5A C3) libcs.so +0xba6c0</span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2. 在 libc.so +0x1726C0 有个 0-255 的表</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7sojuW0w1RibZGsKf8dvaqhcIvwzpMrsJKYBeA8cGUtZJibgOBnGkkicIQ/0?wx_fmt=png" style="width: 706px !important; height: 175px !important;"></p><p style="text-align: center;"><span style="font-size: 15px;">图4</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">需要一个判断 rax 假就退出的地方，这个地方就很完美</span></p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7HofLC77ruWHRib8yRxUm64BvBAHyaZW3Pyr6CEgFFgOdeqZXZlAVEYw/0?wx_fmt=png" style="width: 770px !important; height: 313.108px !important;"><br><span style="font-size: 15px;">图5</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">顺便附上 虚拟机运行 的堆栈图，其他的代码里再详细解释</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC74zzCntgwIfy4CGtI1cdmictjo8XrqoVDGYGL8N0gdhJXPLq8d7csetA/0?wx_fmt=png" style="width: 504px !important; height: 167px !important;"></p><p style="text-align: center;"><span style="font-size: 15px;">图6</span></p><h3 style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><strong><span style="color: rgb(255, 251, 0); background-color: rgb(0, 0, 0); font-size: 16px;">获取代码</span></strong></h3><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">因为服务器对传输敏感，send
 间的延迟时间需要反复调整，记录坑点，调整这个时间也花了不少时间(没有经验)，有时候还怀疑自己的 payload 
有问题，但手动又没问题，本地也没问题，结果是在这个 sleep 
上，代码里是经过多重考核的非常稳定的延迟时间。因为单字符测试等待的时间较久，设计成了参数模式用来多进程执行</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GhQcBREyuTnyNB7wK7ntC7HKeLU1E0PdWe1zMvsUMPxDMcrAibB93VTmbU4yictnxsttAiaaQCsIDZg/0?wx_fmt=png" style="width: 770px !important; height: 2504.14px !important;"></p><p><span style="letter-spacing: 0px; box-sizing: border-box; font-size: 15px;"><br></span></p><p style="text-align: center;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; overflow-wrap: break-word !important;">最后感谢 WiFi 万能钥匙安全应急响应中心的赞助支持，</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; overflow-wrap: break-word !important;">接下来的比赛大家一定要使出洪荒之力哦！↖(^ω^)↗</span><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; overflow-wrap: break-word !important;">比心&nbsp;❤</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_gif/1UG7KPNHN8EbL4Qw95bfyIM3rnNynl14o2uiaf1OaPQ2ydb80Y26EjHGnZT8CzlC12ibyML3S0YeFjVfTG8IuiaIA/0?wx_fmt=gif" style="visibility: visible !important; width: 150px !important; height: 150px !important;"></p><p><br></p><section label="Copyright Reserved by PLAYHUDONG." style="margin-top: 1em; margin-bottom: 1em; max-width: 100%; border-width: 0px; border-style: none; border-color: currentcolor; box-sizing: border-box !important; overflow-wrap: break-word !important;"><section style="margin-left: 1em; max-width: 100%; line-height: 1.4; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="padding: 0.2em 0.5em; border-radius: 0.3em; color: white; background-color: rgb(102, 102, 102); box-sizing: border-box !important; overflow-wrap: break-word !important; max-width: 100%; font-size: 1em; font-family: inherit; font-weight: inherit; text-align: inherit; text-decoration: inherit;">赞助商</span></section><section class="" style="margin-top: -0.7em; max-width: 100%; border-width: 1px; border-style: solid; border-color: rgb(192, 200, 209); border-radius: 0.4em; color: rgb(51, 51, 51); font-size: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><section style="padding: 1.4em 1em 1em; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><section style="max-width: 100%; font-size: 1em; font-family: inherit; font-weight: inherit; text-align: inherit; text-decoration: inherit; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="box-sizing: border-box !important; overflow-wrap: break-word !important; max-width: 100%; font-size: 15px;">上海连尚网络科技有限公司成立于
 2013 年，是一家专注于提供免费上网和内容服务的移动互联网企业。连尚网络自主研发的核心产品 WiFi 
万能钥匙，以分享经济的模式，通过云计算和大数据技术，利用热点主人分享的闲置WiFi资源，为用户提供免费、稳定、安全的上网服务，以帮助更多的人上网，找到属于他们的机会，改变自己的命运。</span></p></section></section></section></section><p><br></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><hr style="max-width: 100%; line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282630&amp;idx=1&amp;sn=61fcbc708235dec5d7897a0d7c315756&amp;chksm=b1815a0c86f6d31a50ba1f9a39d876e28f2c71096100b28e961df185f7be94ec77b9199efd51&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">等你来挑战！| 看雪 CTF 2017 攻击篇</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283303&amp;idx=1&amp;sn=9e39d732ef0a0615971b1f0814498b1a&amp;chksm=b1815dad86f6d4bbcbfe01f630a656c4975e709ef944c21d364f185ffb33aae80e677ddc23f4&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第三题 点评及解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283236&amp;idx=1&amp;sn=26f6fdd0f3d1d43eba75b9c8f2486e0e&amp;chksm=b1815c6e86f6d5786aab09dd4b1aae94e69d5f033621fda60550c42f9aa9d180be55eb49cc0c&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪.万能钥匙 CTF 2017 第二题点评及解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283184&amp;idx=1&amp;sn=fd8246361b0bd21c80717c888e67f55a&amp;chksm=b1815c3a86f6d52cfd48056237427263609a8184b1cea6b28d1bc56f942dd1498dd26764d4bb&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪.万能钥匙 CTF 2017第一题 WannaLOL 解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">更多比赛详情，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HeITaKZ4ia1yZqDFpI1U8icd14Ea3PO3LYThHvZ887eob5Ka9k3qJD2ialAI7WV6KThEzPoadyNsvtA/640?wx_fmt=jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 640px !important; height: 426px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪论坛：http://bbs.pediy.com/<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">商务合作<span style="max-width: 100%;"></span>：<span style="max-width: 100%;">wsc@kanxue.com</span></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><p><br></p><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; width: 100.5px; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="margin-top: 10px; max-width: 100%; box-sizing: border-box; text-align: center; transform: translate3d(0px, 0px, 0px); font-size: 11.2px; overflow-wrap: break-word !important;"><section class="" style="padding: 4px; max-width: 100%; box-sizing: border-box; display: inline-block; background-color: rgb(211, 0, 0); font-size: 11.2px; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; border-color: white; width: 1.6em; height: 1.6em; border-style: solid; border-width: 1px; font-size: 16.8px; line-height: 1.5em; color: rgb(255, 255, 255); overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; font-size: 16.8px; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">点</span></p></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; text-align: center; line-height: 0; overflow: hidden; transform: translate3d(0px, 0px, 0px); overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="margin: auto; max-width: 100%; box-sizing: border-box; width: 2px; height: 1em; background-color: rgb(211, 0, 0); overflow-wrap: break-word !important;"></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; width: 0px; border-top: 1em solid rgb(211, 0, 0); overflow-wrap: break-word !important; border-left: 0.5em solid transparent !important; border-right: 0.5em solid transparent !important;"></section></section></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; width: 569.5px; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="margin-top: 15px; max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 了解更多</span></p></section></section></section></section><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1498051979&src=3&ver=1&signature=nULoNfhbsabgcFJEB9PUQyx1hdTxM6K*VNtcxOeUN354nW26WI5lTIy9FI3*gxCaEHwjjiMY16zPEkDRPZ*5EDahRkV9Y0RvDlydxvDRIorEYLQuD1ul8XQxRD8bq52pWttbh4WSMC2okz69WgA7jlgU2*T28luMaDgCXlH0Zms=">微信地址</a> | <a href="http://ctf.pediy.com/game-fight-39.htm">阅读原文</a>
{% endraw  %}

