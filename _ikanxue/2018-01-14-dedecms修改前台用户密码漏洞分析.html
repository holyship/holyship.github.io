---
title: dedecms修改前台用户密码漏洞分析
author: reklawetihwx
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1515984875&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siPPs-NRfvlwjuvH7xFTtLmsOPyUEuRfepE4lmADgDB-KqTGJpoTQDDroKcwkYhW3KdLII8JQwmMT9y644AipdB5aPMw4MXNKo6ucOpqCvy3HlmNwby35CeGMFm8ILpKQXNGBVOAq30BXIm5jlbO*Olo=
date: '2018-01-14 00:00:00 +0000'

---

{% raw  %}
<p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8FOq4JPzEqQWO39QL2DoBfwprumIyu3eAlv1NQVfvKZgHYaibn9HkC78wBGvjQySZZnSsyXic3runjA/0?wx_fmt=jpeg" style="box-sizing: border-box !important; word-wrap: break-word !important; visibility: visible !important; width: 542px !important; height: 383.811px !important;"></p><h2 style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></strong></span><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></h2><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></strong></span></p><h2 style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">前言</span></strong></span></h2><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></strong></span></p><hr style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></strong></span><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: none;margin-left: 8px;margin-right: 8px;"><li><p style="max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">漏洞公布时间：2018/01/10</span></p></li><li><p style="max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">影响版本：V5.7SP2正式版(2018-01-09)之前所有版本</span></p></li></ul><h2 style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></h2><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><h2 style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">漏洞说明</span></strong></span></h2><p style="letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><hr style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">这个漏洞的前提是需要开启用户注册的功能，造成的危害是能够修改前台部分用户的密码，这部分用户是那些没有设置密保问题的用户。前台管理员密码虽然也没有设置密保问题，但是由于dedecms本身的功能即使修改密码也是无法登录的。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">dedecms重置密码的原理是给重置密码的用户发送一个重置密码的链接。那么在进行重置密码时，修改为其他的用户就能够修改其他用户的密码了，所以本质上来说这是一个越权漏洞。</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></strong></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></strong></span></p><h2 style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">漏洞分析</span></strong></span></h2><p style="letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><hr style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">假设dedecms已经开启了用户注册的功能，用户重置密码的的URL是为http://localhost/member/resetpassword.php。对应于源码的位置是member/resetpassword.php。</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><h3 style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">safequestion分析</strong></span></h3><p style="letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">在member/resetpassword.php中存在三个重置密码的方法，分别是getped、safequestion、getpasswd。而本次的漏洞与safequestion有关。</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">分析safequestion方法代码：</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><blockquote style="letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">else&nbsp;if($dopost&nbsp;==&nbsp;"safequestion")</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$mid&nbsp;=&nbsp;preg_replace("#[^0-9]#", "", $id);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;"SELECT safequestion,safeanswer,userid,email FROM #@__member WHERE mid = '$mid'";</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$row&nbsp;=&nbsp;$db-&gt;GetOne($sql);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;if(empty($safequestion)) $safequestion&nbsp;=&nbsp;'';</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;if(empty($safeanswer)) $safeanswer&nbsp;=&nbsp;'';</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;if($row['safequestion']&nbsp;==&nbsp;$safequestion &amp;&amp; $row['safeanswer']&nbsp;==&nbsp;$safeanswer)</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sn($mid, $row['userid'], $row['email'],&nbsp;'N');</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit();</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;else</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShowMsg("对不起，您的安全问题或答案回答错误","-1");</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit();</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">}</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">其中有几个关键的验证，如empty($safequestion)、empty($safeanswer)、if($row['safequestion'] == $safequestion &amp;&amp; $row['safeanswer'] == $safeanswer)。首先我们需要知道，一个没有设置密保问题的用户，默认的safequestion和safeanswer结果。</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><blockquote style="letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">mysql&gt; SELECT safequestion,safeanswer,userid,email FROM dede_member WHERE mid='1';</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">+--------------+------------+--------+-------+</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">| safequestion | safeanswer | userid | email |</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">+--------------+------------+--------+-------+</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | admin&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">+--------------+------------+--------+-------+</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">1&nbsp;row&nbsp;in&nbsp;set&nbsp;(0.00&nbsp;sec)</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">默认情况下的safequestion为0,safeanswer为空。那么如何通过这个验证呢？如果我们传输的safequestion为0，而empty($safequestion)为True。此时我们需要利用到php的隐式类型转换，即PHP在进行类型比较、类型判断时会自动进行一些类型的转换，如下：</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><blockquote style="letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">var_dump(empty(0));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;true</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">var_dump(empty('0'));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;true</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">var_dump(empty('0.0'));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;false</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">var_dump(0.0==0);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;true</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">var_dump('0.0'==0);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;true</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">var_dump(null=='');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;true</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">所以我们设置我们输入的safequestion为0.0，safeanswer为空就可以绕过这个验证，此时empty($safeanswer)为True，$row['safequestion'] == $safequestion也为True,而数据中查询出来的safeanswer本身就为NULL，所以我们设置为空，就可以通过验证。之后程序进入sn($mid, $row['userid'], $row['email'], 'N');中。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">所以这个地方重置的仅仅是那些没有设置密保问题的用户，因为只有这些用户他们的safequestion才是空</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></strong></span></p><h3 style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">sn函数分析</strong></span></h3><p style="letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">跟踪进入到member/inc/inc_pwd_functions.php:sn()中，</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><blockquote style="letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">function sn($mid,$userid,$mailto, $send&nbsp;=&nbsp;'Y')</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;$db;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$tptim=&nbsp;(60*10);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$dtime&nbsp;=&nbsp;time();</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;"SELECT * FROM #@__pwd_tmp WHERE mid = '$mid'";</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$row&nbsp;=&nbsp;$db-&gt;GetOne($sql);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;if(!is_array($row))</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//发送新邮件；</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newmail($mid,$userid,$mailto,'INSERT',$send);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;//10分钟后可以再次发送新验证码；</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;elseif($dtime&nbsp;-&nbsp;$tptim &gt; $row['mailtime'])</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newmail($mid,$userid,$mailto,'UPDATE',$send);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;//重新发送新的验证码确认邮件；</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;else</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ShowMsg('对不起，请10分钟后再重新申请',&nbsp;'login.php');</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">}</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">进入到sn()函数之后，会执行SELECT * FROM #@__pwd_tmp WHERE mid = '$mid',此条SQL语句查询的是dede_pwd_tmp,此表存储的就是重置密码的临时KEY。由于此时没有重置密码，所以没有对应此用户的记录。</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFtGzLFlkqXEzAxJLuia4eQ8wqf1jibuyhhyu5hAPBibngc0VQhlzpUo19Q/?wx_fmt=jpeg" style="background-color: rgb(238, 237, 235); border-width: 1px; border-style: solid; border-color: rgb(238, 237, 235); background-size: 22px; background-position: center center; background-repeat: no-repeat; cursor: pointer; box-sizing: border-box !important; word-wrap: break-word !important; width: 654px !important; height: 194.875px !important;"></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">进入到第一个判断newmail($mid,$userid,$mailto,'INSERT',$send);中</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></strong></span></p><h3 style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">newmail函数分析</strong></span></h3><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">追踪进入到member/inc/inc_pwd_functions.php:newmail()中</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><blockquote style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">function newmail($mid, $userid, $mailto, $type, $send)</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;$db,$cfg_adminemail,$cfg_webname,$cfg_basehost,$cfg_memberurl;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$mailtime&nbsp;=&nbsp;time();</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$randval&nbsp;=&nbsp;random(8);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$mailtitle&nbsp;=&nbsp;$cfg_webname.":密码修改";</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$mailto&nbsp;=&nbsp;$mailto;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$headers&nbsp;=&nbsp;"From: ".$cfg_adminemail."\r\nReply-To: $cfg_adminemail";</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$mailbody&nbsp;=&nbsp;"亲爱的".$userid."：\r\n您好！感谢您使用".$cfg_webname."网。\r\n".$cfg_webname."应您的要求，重新设置密码：（注：如果您没有提出申请，请检查您的信息是否泄漏。）\r\n本次临时登陆密码为：".$randval." 请于三天内登陆下面网址确认修改。\r\n".$cfg_basehost.$cfg_memberurl."/resetpassword.php?dopost=getpasswd&amp;id=".$mid;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;if($type&nbsp;==&nbsp;'INSERT')</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$key&nbsp;=&nbsp;md5($randval);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;"INSERT INTO `#@__pwd_tmp` (`mid` ,`membername` ,`pwd` ,`mailtime`)VALUES ('$mid', '$userid',&nbsp; '$key', '$mailtime');";</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($db-&gt;ExecuteNoneQuery($sql))</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($send&nbsp;==&nbsp;'Y')</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendmail($mailto,$mailtitle,$mailbody,$headers);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ShowMsg('EMAIL修改验证码已经发送到原来的邮箱请查收',&nbsp;'login.php','','5000');</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;($send&nbsp;==&nbsp;'N')</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ShowMsg('稍后跳转到修改页', $cfg_basehost.$cfg_memberurl."/resetpassword.php?dopost=getpasswd&amp;amp;id=".$mid."&amp;amp;key=".$randval);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ShowMsg('对不起修改失败，请联系管理员',&nbsp;'login.php');</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">进入到$type == 'INSERT'中，生成一个临时KEY,$key = md5($randval);,然后插入到数据库中，$sql = "INSERT INTO #@__pwd_tmp (mid ,membername ,pwd ,mailtime)VALUES ('$mid', '$userid', &nbsp;'$key', '$mailtime');";。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">接下来根据参数$send的值判断是将重置密码的链接通过邮箱发送还是直接跳转。这个参数最开始是在$dopost == "safequestion"中设置的，默认值是N，那么就会将对应id的密码返回。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFofMDiaibhF541zSARIuP1NFPOM7Pic7xpAptEwbia2f9SwlbRQUm7WmaUg/?wx_fmt=jpeg" style="background-color: rgb(238, 237, 235); border-width: 1px; border-style: solid; border-color: rgb(238, 237, 235); background-size: 22px; background-position: center center; background-repeat: no-repeat; cursor: pointer; box-sizing: border-box !important; word-wrap: break-word !important; width: 654px !important; height: 220.598px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">拿到重置链接直接在浏览器中访问就可以修改此id对应用户的密码了。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogF7fV27H3c0r97vAjicicWcVCWdM3hzwbA4lrRhxiaJWo195c8QicUQmTgtg/?wx_fmt=jpeg" style="background-color: rgb(238, 237, 235); border-width: 1px; border-style: solid; border-color: rgb(238, 237, 235); background-size: 22px; background-position: center center; background-repeat: no-repeat; cursor: pointer; box-sizing: border-box !important; word-wrap: break-word !important; width: 654px !important; height: 73.6891px !important;"></p><h2 style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></strong></span></h2><h2 style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">重置密码</strong></span></h2><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">重置密码发送的请求如下：</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><blockquote style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">URL:http://localhost/member/resetpassword.php</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">POST:dopost=getpasswd&amp;setp=2&amp;id=3&amp;userid=test02&amp;key=K5TrsKQB&amp;pwd=123456&amp;pwdok=123456</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">其中的pwd和pwdok是我设置的重置密码。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">此重置密码的请求就会进入到member/resetpassword.php的$dopost == "getpasswd"中</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><blockquote style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">else if($dopost == "getpasswd")</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;//修改密码</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;if(empty($id))</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShowMsg("对不起，请不要非法提交","login.php");</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit();</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$mid = preg_replace("#[^0-9]#", "", $id);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;$row = $db-&gt;GetOne("SELECT * FROM #@__pwd_tmp WHERE mid = '$mid'");</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;if(empty($row))</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShowMsg("对不起，请不要非法提交","login.php");</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit();</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;if(empty($setp))</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tptim= (60*60*24*3);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dtime = time();</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($dtime - $tptim &gt; $row['mailtime'])</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$db-&gt;executenonequery("DELETE FROM `#@__pwd_tmp` WHERE `md` = '$id';");</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShowMsg("对不起，临时密码修改期限已过期","login.php");</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit();</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require_once(dirname(__FILE__)."/templets/resetpassword2.htm");</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;elseif($setp == 2)</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($key)) $pwdtmp = $key;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sn = md5(trim($pwdtmp));</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($row['pwd'] == $sn)</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pwd != "")</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($pwd == $pwdok)</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pwdok = md5($pwdok);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql = "DELETE FROM `#@__pwd_tmp` WHERE `mid` = '$id';";</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$db-&gt;executenonequery($sql);</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql = "UPDATE `#@__member` SET `pwd` = '$pwdok' WHERE `mid` = '$id';";</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($db-&gt;executenonequery($sql))</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showmsg('更改密码成功，请牢记新密码', 'login.php');</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showmsg('对不起，新密码为空或填写不一致', '-1');</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showmsg('对不起，临时密码错误', '-1');</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">}</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">进入之后，会进行$db-&gt;GetOne("SELECT * FROM #@__pwd_tmp WHERE mid = '$mid'")查选，因为在重置密码时已经在dede_pwd_tmp表中保存了记录，所以此时存在数据。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFfWO2iacSqSloWBiaCcibNPaVlAhI21wr4DP3NY2q7uPSMBHPdWJk4W6gg/?wx_fmt=jpeg" style="cursor: pointer; box-sizing: border-box !important; word-wrap: break-word !important; visibility: visible !important; width: 754px !important; height: 311.025px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">之后根据step的值为2，进入到更改密码的操作中。更改密码之后会进行$sn = md5(trim($pwdtmp));if($row['pwd'] == $sn操作，与数据库的中密码进行校验，校验成功之后，就会执行一下的两条SQL语句：</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><blockquote style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">"DELETE FROM `#@__pwd_tmp` WHERE `mid` = '$id';"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # 删除临时密码表中的数据</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">"UPDATE `#@__member` SET `pwd` = '$pwdok' WHERE `mid` = '$id';";&nbsp;&nbsp;&nbsp; # 更新dede_memeber中的密码</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">至此就完整了整个任意用户密码的重置过程。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><h2 style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">POC</span></strong></span></h2><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><hr style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">这个漏洞的POC也比较的简单，通过safequestion方法重置密码即可。</span></p><h2 style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></h2><blockquote style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">URL:member/resetpassword.php</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;letter-spacing: 0px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);font-size: 12px;box-sizing: border-box !important;word-wrap: break-word !important;">POST:dopost=safequestion&amp;safequestion=0.0&amp;safeanswer=&amp;id=用户ID</span></p></blockquote><h2 style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></strong></span></h2><h2 style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(0, 81, 171);font-size: 18px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></strong></span></h2><h2 style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 18px;color: rgb(0, 81, 171);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">总结</span></strong></span></h2><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><hr style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">这个漏洞其实并没有使用什么特殊技巧，仅仅是由于程序在校验的时候不严格。所以这个漏洞也很好修复，将$row['safequestion'] == $safequestion &amp;&amp; $row['safeanswer'] == $safeanswer中的==变为===。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;">除此之外，我在调试这个漏洞时发现这个safequestion并没有对应到前台的某个操作，所以感觉这个方法一直没有被使用，而这个漏洞刚好利用了这个方法，所以如果不用这个方法的是完全可以删除的，最后就看官方如何修复吧。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 2px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(79, 79, 79);box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="white-space: normal;"><br></p><section label="Copyright © 2014 playhudong All Rights Reserved." style="white-space: normal;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8G9B6YFlthnv1h3cWDDXGAmK9wQfy6pod114tTuOSIFVeVd0vd1PEwicksgBGmxL0iaC0icX7B9EQzNg/?wx_fmt=png" style="margin-right: auto; margin-left: auto; display: block; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; visibility: visible !important; width: 160px !important; height: 8.44575px !important;"></section><p style="white-space: normal;"><br></p><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">本文由看雪SRC小组&nbsp;<strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">reklawetihwx&nbsp;</strong>原创，系看雪web小组征稿系列文章<br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">转载请注明来自看雪社区</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"></span></p><p style="margin: 15px 8px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">热门阅读</span></p><p style="margin: 15px 8px;white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"></span></p><ul class="list-paddingleft-2" style="list-style-type: none;"><li><p style="margin-top: 10px;margin-bottom: 10px;max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287391&amp;idx=2&amp;sn=36b62672417c3c56a1d8fb23c378eb83&amp;chksm=b1814d9586f6c483d25fb5a6c5e1654751476feedb40617587cdd878fa7bfafd2784eea05980&amp;scene=21#wechat_redirect" target="_blank" style="color: rgb(87, 107, 149);outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">方法 | 在Windows系统上修复Meltdown和Specture CPU漏洞</a></span></p></li><li><p style="margin-top: 10px;margin-bottom: 10px;max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287415&amp;idx=1&amp;sn=dba14b0b922e4577028ccab4bc6d1451&amp;chksm=b1814dbd86f6c4ab6df058462e0147f59ab8757ab3e65f5fdf6b3058d8d65d146cf4c04a32a6&amp;scene=21#wechat_redirect" target="_blank" style="color: rgb(87, 107, 149);outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">通俗理解这次的CPU漏洞，附带修改过带注释源码一份</a></span></p></li><li><p style="margin-top: 10px;margin-bottom: 10px;max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287434&amp;idx=1&amp;sn=a526b80315d80f63afe73923818dcd70&amp;chksm=b1814dc086f6c4d65f85d18c15738484e113d23b7af5f8c6c6734037bae31fb26e68a286ea8b&amp;scene=21#wechat_redirect" target="_blank" style="color: rgb(87, 107, 149);outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">简单看一下 &nbsp;微软新出的内核页表隔离补丁</a></span></p></li><li><p style="margin-top: 10px;margin-bottom: 10px;max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287468&amp;idx=1&amp;sn=ff2b2d716b79e1003b90e9540b64977e&amp;chksm=b1814de686f6c4f0d7069b2832e8af68a0a1def12ed0afcee3afc90211ea56e82bef7be3e392&amp;scene=21#wechat_redirect" target="_blank" style="color: rgb(87, 107, 149);outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">c++实现的一种代码膨胀变形壳</a></span></p></li></ul><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">点击阅读原文/read，</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">更多干货等着你~</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"></span></p><p style="white-space: normal;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogF7k9ial3PRnycAlV0MDpvGhZUiblIMHerzDl3m9zvOhQbeceHRibIK2xsg/?wx_fmt=jpeg" style="box-sizing: border-box !important; word-wrap: break-word !important; visibility: visible !important; width: 770px !important; height: 193.302px !important;"></p><p><br></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1515984875&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siPPs-NRfvlwjuvH7xFTtLmsOPyUEuRfepE4lmADgDB-KqTGJpoTQDDroKcwkYhW3KdLII8JQwmMT9y644AipdB5aPMw4MXNKo6ucOpqCvy3HlmNwby35CeGMFm8ILpKQXNGBVOAq30BXIm5jlbO*Olo=">微信地址</a> | <a href="https://bbs.pediy.com/thread-224008.htm">阅读原文</a>
{% endraw  %}

