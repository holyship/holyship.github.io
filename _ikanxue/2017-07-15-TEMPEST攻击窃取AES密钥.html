---
title: TEMPEST攻击窃取AES密钥
author: StrokMitream
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1500384871&src=3&ver=1&signature=FkzcjJJ48va4gLuFLNnuhkhH-og5pFwEaV31j2I9UYmZuCfoFGBOLJiXHWsGDm4fWeZ-VLFPoNws8A3ckZLud5gTJvKDA1yuOyo5Rf6d0QXuZtL3oFw6YQwiT7yaTYZKGSUV4esoFJQVt2GtaiSvdhG3nK4W6KzcJsUl1PxKc-E=
date: '2017-07-15 00:00:00 +0000'

---

{% raw  %}
<section data-role="outer" label="Powered by 135editor.com" style="font-family: 微软雅黑; font-size: 16px;"><section class="" style="padding: 0px 10px; box-sizing: border-box;"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1dq9Km1nzOicIQiajs8TVsbiavONqDZFksnmcpPf5ZW6ibicD318e6pksp5g/0.jpeg" style="width: 750px !important; height: 353.75px !important; visibility: visible !important;"><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><section label="Copyright Reserved by ipaiban.com." style="margin: 1em auto; padding: 0.5em 1em; white-space: normal; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-style: none;"><section class="" style="border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">一<br></p></section><section class="" style="background: rgb(0, 0, 0) none repeat scroll 0% 0%; color: rgb(255, 255, 255); border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">概述</p></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">边信道攻击能通过计算如电力的消耗来恢复加密算法（包括常见的AES加密算法）的密钥。然而这些先前的AES攻击手段需要无限制的物理设备访问。通过增强天线及信号处理，Fox-IT and Riscue演示了从真实的AES-256加密过程中获取密钥的步骤：</span></p><ol style="list-style-type: decimal;" class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);"> 1m开外之处实施攻击（实际环境下约30cm）;</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">使用低配置硬件（花费少于€200）注：€：欧元；</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">攻击耗时极短（距离1米需5分钟，距离30cm仅需50秒）；</span></p></li></ol><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">据我们所知，我们的这份报告是该类近距离攻击的第一次公开发表。该报告进一步凸显了在设计高度可靠系统（正是Fox-IT 所擅长的）中深度防范的必要性。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><section label="Copyright Reserved by ipaiban.com." style="margin: 1em auto; padding: 0.5em 1em; white-space: normal; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-style: none;"><section class="" style="border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">二<br></p></section><section class="" style="background: rgb(0, 0, 0) none repeat scroll 0% 0%; color: rgb(255, 255, 255); border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">简介<br></p></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">一些东西在电子产品中是固有不变的。TEMPEST泄露正是其一。</span><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">谨记：</span></p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">计算机只是通过驱动电子运动而工作。</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">该论断对任何计算机程序都适用——无论是JavaScript亦或是C语言编写的甚至定制硬件电路也适用。任何程序都要靠硬件电路来运行实现，由此，也带来一些有趣的副作用。引用来自以为苏格兰朋友——詹姆斯·克拉克·马克斯韦尔的话：</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">运动电荷激发磁场。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">故此，运行一个算法程序必将产生波动的磁场。我们可以在场源附近随意探测EM波辐射，甚至在一定距离外更加隐蔽的地方也是可以实现的。实际上，该技术是所有无线通信赖以实现的基础。所有的FM收音机、WiFi、GSM通信都是利用此原理！TEMPEST攻击就是在一定距离探测该场并从中获取一些有用的信息的。</span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1JTyC0MYBA5OeUmAxeV9OQbnBG2OoHia2ibF1icCdMbicqOBYwY4SPcdlRA/0.jpeg" style="width: 750px !important; height: 371.989px !important;"><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图：来自参考链接[1]</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><section label="Copyright Reserved by ipaiban.com." style="margin: 1em auto; padding: 0.5em 1em; white-space: normal; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-style: none;"><section class="" style="border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">三</p></section><section class="" style="background: rgb(0, 0, 0) none repeat scroll 0% 0%; color: rgb(255, 255, 255); border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">为何关注该方法<br></p></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">Fox-IT高级安全研究及发展部门已有数年为政府建设符合TEMPEST标准的设施的经验。该研究正式提出及关注的是攻击而非防御。这远超出了传统的TEMPEST分析——确定在给定距离的信号强度，研究在接近真实环境下的攻击手段。这些信息通常用于改进现有的、过时的防御对策。</span><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">当然，关于非对称加密的攻击已有相关公开信息，不过，我们并没有看到过关于对称加密如AES的TEMPEST攻击。这些公开的攻击技术利用非对称加密算法特殊的数学结构“放大”二进制位从而使之易于被探测到。然而，AES算法并没有该特殊之处。我们想通监测AES加密过程来拓展实现该功能。我们的攻击方案要求攻击端必须能观测输入和输出数据。这是极其现实的情景，对那些有公开、可见输出数据的加密设备，例如，网络加密程序。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">OK，让我们开始有趣的……</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><section label="Copyright Reserved by ipaiban.com." style="margin: 1em auto; padding: 0.5em 1em; white-space: normal; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-style: none;"><section class="" style="border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">四</p></section><section class="" style="background: rgb(0, 0, 0) none repeat scroll 0% 0%; color: rgb(255, 255, 255); border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">近场攻击重视<br></p></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">我们良好的开头是确立实施攻击的硬件配置。在Riscure的帮助下，我们的硬件成功地实现了功能。传统的方法是用示波器记录数据，用外置信号触发。攻击者拿着示波器，输入端的信号将会触发记录，记录的数据将会拷贝到电脑进行分析。该过程将在各个加密过程重复进行，直到收到足够多进行分析的数据。</span><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">我们用无线电的硬件代替示波器构成的电路，这样，我们就可以选择有用频带而丢弃没用的。数据率低得能以流的形式直接传输给电脑，这意味着我们能在更短的时间里捕获更多的信息。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">下图所示的是攻击的工作流程，分为4部分：模拟信号探测，无线信号记录，预处理以及数据分析。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1RajraOuxMib5ibNbUY0qc32cJMUGm8or1yatIvR9cWxAHQLLE3aiaSU8w/0.jpeg" style="width: 750px !important; height: 395.365px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图:攻击工作流程概述</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">攻击的实现流程</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&gt;模拟信号探测包括用天线探测电磁场，滤出所需频率并放大信号。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&gt;无线信号记录可以是任何能将高频信号混合成便于处理的低频信号并数字化输出的的硬件。更多关于此处的信息见后文。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&gt;预处理就是对记录的无线信号进行分析，找出信号中加密的开始位置，并将其分割成各个独立的加密块。同时，还需将一些复杂的信号转换成简单、便于分析的格式。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&gt;数据分析使用Riscue 的检测工具，寻找“预测密钥”与记录的数据间的联系从而找回真正的密钥。在这一步中，最复杂的部分是建立一个好的模型来模拟设备泄露信息的过程。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">以上的仅是模糊的、不具体的想法，在实际中又是如何呢？</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">模拟信号探测</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">从头至尾，该部分最重要的是用空电缆和磁带做成的磁性天线圈。该线圈对附近芯片产生的场作出反应，我们用滤波器和放大器对信号进一步的处理。我们先用滤波器从142MHz的时钟频率中滤出10MHz的频带，再用总价低于€200、来自Mini Circuits 的硬件进行放大。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1H8e8icicO7Ilmg2NuPIQoPE04bcsquTPkib3FllMsNx39pDUjHIQicY3xg/0.jpeg" style="width: 750px !important; height: 256.988px !important;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图：模拟信号探测器</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">信号记录</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">记录仪器从极其高端的无线电装备到€20的USB SDRs，相差极大。我们发现甚至廉价的USB加密狗都可以用来实现攻击！这不是一个奢侈的政府才能玩得起的游戏，而是每个愿意花一些零花钱和时间的人都可以玩的游戏。以下是3种设备的比较：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1gvrggibuEIU9m0Bp2NHZyeNeneg4S2sF0alibVc9X62Gt7T5Y8Kib6SFA/0.jpeg" style="width: 750px !important; height: 309.673px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图：天线比较</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">接下来，我们看到的是用SR-7100记录10MHz带宽的信号。下图所示的轨迹图是运行于SmartFusion2目标设备AES-256加密过程的一个信号区段。我们用OpenSSL实现基于ARM Cortex-M3核心的SmartFusion2。每一阶段的处理都有清晰、明确的模式。输入和输出经过Contex-M3,并计算密钥及14轮的加密。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1zBUso2fBZB0dO2QfunPOFD3TBNQU7qZ80eNTCict3oMEDXLyaYV3PdQ/0.jpeg" style="width: 750px !important; height: 303.75px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图：依赖于AES算法模式概览</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">因此，我们可以测量与信号相关联部分的芯片的瞬时电力消耗。当然，这离完全取得密钥还早着呢，我们还需要观察不同输入下不同加密的加密区块，以便建立一个好的模型模拟信息的泄露。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">数据分析</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">专家：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">我们所捕获记录的数据是以设备功耗有关的。这是极有用的因为功耗是由设备正在处理的数据决定的。我们正是利用这点来获取密钥的。让我们快速验证一下，我们是可以通过记录的信息“看到”设备在处理的数据的——可以试着检验探测的信号与“1”这个比特位之间的联系。我们希望得到输入及输出处理的冲激响应分布图。下图所示波形图显示，我们确实可以探测到目标设备正在处理的数据。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1hwHzORdwG3UfQ1yD65GxD2iaicE2Iicv2ibpTqQ7ibbkDSl3scxt6cR9BpA/0.jpeg" style="width: 750px !important; height: 159.375px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图: I/O数据相关性曲线</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">现在，我们结合猜测和相互联系来找出密钥。假设我们知道32Byte密钥中的1Byte，我们就可以预测一些AES算法里的内容。预测内容与信号分析结果之间的联系应当是非常清晰的（就像上面的I/O数据图）。当然，作为攻击者，我们事先并不知道密钥。不过，我们可以轻而易举地列出这1Byte密钥的256种可能。在相关性分析中，数值最高的既是正确的。用此种办法，仅需数秒钟就可在所有可能性（每1Byte 256种可能，32Byte一共就是8192种可能）中找到正确的数值。相反的是，如果直接暴力攻击AES-256算法的话，将会有2种可能性，就算计算到宇宙的尽头也算不完。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">在我们的攻击中，有许多可用的中介，当然，这很大程度上取决于软件及硬件的实现。OpenSSL采用查表——T tables 的方法，这对于32位系统不失为一种合理、普遍的选择。T tables的使用，极大地降低了整个算法的查找数量和花费。使用查表法作为中介，将会带来非线性因素，这将使得正确猜测与仅有1bit之差的猜测结果相差更大。尤其是如果我们控制了输入的话，那么我们将能用简单的模型成功实现。我们呈现的结果反映了每1bit的从T tables载入的数据间的联系。我们也在进一步提高模型的准确度。改进模型更加详细地描述了信息是如何泄露的，不过我们尽量不在实践中使用，因为我们并不需要如此高精度的信息。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">至于SmartFusion2，泄露大部分来源于连接Cortex-M3和片上存储的AHB总线。我们可以通过联系T tables查找的地址来攻击密钥。如果这样的话，那么计算1bit数值并不能很好地模拟出电力消耗。取而代之的是，我们计算总线上传输的两个顺序相邻地址的数值。这表明在传输数据时，总线相当于瞬间短路。现在，我们是传输两个地址的数据，我们必须知道先前及接下来的地址。如果指令高速缓存不工作，这将会是未来指令的地址。如果指令高速缓存有效，那么这便是先前加载或存储的数据。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">注意到为了避免缓存一致性问题，SmartFusion2没有D-高速缓存。下面的图表反映的是用地址线模型分析256种预测密钥的相关性的曲线。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1ZExoS9hR2JfTekIbKPjXtmxXJbYp3RYjpicPic46K4N4FlAt3NSmCslA/0.jpeg" style="width: 750px !important; height: 249.375px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图：所有预测密钥的相关性曲线</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">由图可知，正确的密钥峰值最高！这意味着我们可以恢复密钥（一字节一字节的）仅需探测和输入数据。注意到图中余下的密钥分布在较低位置的其他频段内，这是因为我们的中间体与密钥线性相关，所以有不同的猜测组，每组都是N位。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">现在，我们能从目标设备中获取密钥了，是时候尝试在一定距离来实现。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><section label="Copyright Reserved by ipaiban.com." style="margin: 1em auto; padding: 0.5em 1em; white-space: normal; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-style: none;"><section class="" style="border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">五</p></section><section class="" style="background: rgb(0, 0, 0) none repeat scroll 0% 0%; color: rgb(255, 255, 255); border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">一定的距离<br></p></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">从一定距离之外进行攻击是真实存在的新的挑战。没有理由在这样的条件下先前的攻击就武无效了——不过我们坚信该实践是前所未有的。我们探测的是相同的物理效应，因此分析过程相同的，不同之处仅在天线部分。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">小线圈</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">小线圈天线仅需要的€20的RTLSDR。这是一个绝好的、不留任何痕迹的攻击密封器件的方法。视具体目标而定，有时候内置的放大器RTL SDR就足够了，这样的话，总的预算就真的是€20！</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">尽管这些线圈的攻击距离很轻易就达到几厘米，但是距我们的目标1m却相差甚远。根据下图，我们可以看到接收到的信号随距离的衰减。从图可知，信号强度降得非常快，并逐渐降至噪声水平。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1VnlgDaSYh0KE2NicpJtMibY0rfyXl7K4h9CiaTlicnPpaSpGE0ZrbnUPAg/0.jpeg" style="width: 750px !important; height: 287.565px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图：小线圈</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">对数周期天线</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">为了提升攻击距离，我们尝试了另一种天线。下图是信号对定向性较好的PCB对数周期天线的衰减情况。信号随距离呈线性衰减使我们有一个更好的机会达到1m的目标。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1gwT7PFmLk7vc2vpicKrq51QcyZoc8xkRQibO5XWJR1wwhQlTe2vnksLg/0.jpeg" style="width: 750px !important; height: 292.077px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图：PCB对数周期天线</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">由于随着频带的变窄天线尺寸逐渐增大，我们最初为了尽量小和廉价，选择了400MHz的天线。然而，SmartFusion2的最高频率为142MHz。为此，我们换用Xilinx的Pynq板，其他的软件与之前一致。我们仍然是攻击ARM核心与存储的总线，不过我们的时钟基准频率是400MHz。经此我们发现，切换到另一块板子相当容易。尽管内存速率为先前142MHz的3倍(是我们使用的DDR的6倍)，我们仍然可以用RTL-SDR支持的带宽攻击Pynq板。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">然而，所有的模拟滤波器都是为142MHz信号而设计的。为了简单方便起见，我们用毯子包裹的两个箱子作为防护罩，以此减轻外部信号的影响。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ1OYVe7hMjxQvKsrFVgMQxCjZAfULKyZPLUEYTfalKKaVW2hibKa2lyHA/0.jpeg" style="width: 750px !important; height: 263.205px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图：防护罩和攻击装备</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">这些预算内的装备——包括：RTL-SDR USB加密狗，迷你放大器（ZFL-500+）和可选用的高通滤波器，让我们的攻击距离拓展到30cm。我们在大约50s就可以捕获到400k的数据。尽管没有达到1m的目标，但是以如此廉价的装备实现这样的距离已经是可喜的一步了。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">理想环境</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">我们发现在DIY实验环境下，在一定距离外攻击是有可能的，只是在理想条件下，可以实现的距离又是多少呢？</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">我们有机会使用OSPL的电波暗室——完全隔离外部信号，最大程度地反射内部信号，如下图所示。盘锥形的全向天线（如下图）工作在非常宽的频带内。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GH0YX6qNGpVCPWv7yQ1DJ16BnMpHeqFW2XvH62xRZgQLjxRtP5pyPkianzhkTfZTNQBEQTxF5kT0A/0.jpeg" style="width: 750px !important; height: 562.667px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px; text-align: center;"><span style="color: rgb(63, 63, 63); font-size: 14px;">图：OSPL电波暗室内的攻击设备</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">为了证明我们确实是从一定距离外探测的，我们必须考虑目标设备与探测器间的电磁隔离：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&gt;目标设备由暗室内的USB电源供电。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&gt;放大器由暗室外的独立电源供电。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&gt;目标设备SmartFusion2需要通过以太网接收外部命令。为了使之与我们的笔记本电脑和SDR隔离，我们在其离开暗室前将之转换成光纤信号。这也让我们避免了以太网线缆给暗室内部带来外来干扰信号。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&gt;Pynq板只需初始化向量便可自动运行而无需以太网输入。每轮成功的加密输出都会反馈到输入。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">尽管是总价&lt;€200(天线除外)的装备，我们也能成功地从1m的距离外攻击Pynq，通过5分钟的探测，可以搜集到240万条信息。该结果表明，在理想环境下，以1m的距离攻击目标是可以实现的。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><section label="Copyright Reserved by ipaiban.com." style="margin: 1em auto; padding: 0.5em 1em; white-space: normal; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-style: none;"><section class="" style="border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">六</p></section><section class="" style="background: rgb(0, 0, 0) none repeat scroll 0% 0%; color: rgb(255, 255, 255); border-width: 2px; border-style: solid; border-color: rgb(0, 0, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 8px 12px; display: inline-block;"><p style="margin: 0px;">结论<br></p></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">我们的实验证明了TEMPEST对加密算法例如AES-256攻击的可实现性。据我们目前所了解到的，这是第一份关于该类攻击的公开报告。低带宽的要求使得我们可以以异常的花费实现一定距离的攻击：</span><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&gt;30cm的距离在DIY实验室，仅需50s时间</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&gt;1m的距离在理想环境下，5分钟时间</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><span style="font-size: 15px; color: rgb(63, 63, 63);">在实际运用中，该装备非常适合网络加密应用。大多数目标设备都是运行批量加密（或许其中就有攻击者控制的的数据）任务的，而且密文也很容易从网络上捕获。这再次强调了在构建高度安全系统中深度防御的迫切需要——联系我们团队如果需要有关建议。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; letter-spacing: 1px;"><br></p><p style="text-align: center; margin: 15px 1em; letter-spacing: 0.5px; line-height: 1.75em;"><span style="font-size: 14px; color: rgb(136, 136, 136);">本文由 看雪翻译小组 StrokMitream 编译，来源 Craig Ramsay&amp; Jasper Lohuis</span></p><p style="text-align: center; margin: 15px 1em; letter-spacing: 0.5px; line-height: 1.75em;"><span style="color: rgb(136, 136, 136); font-size: 15px;">转载请注明来自看雪社区</span><span style="font-size: 14px; color: rgb(136, 136, 136);"><br></span></p><p style="text-align: center; margin: 15px 1em; letter-spacing: 0.5px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(255, 104, 39);">如果你喜欢的话，不要忘记点个赞哦！<br></span></p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_gif/1UG7KPNHN8EpuLDF719D3pt2qpx7QYXicAtoWxV68dVmStvKalhQh7lJywyNvMzc4wG0BWI4F048ibibh5H6htic2Q/0?wx_fmt=gif" style="visibility: visible !important; width: 312px !important; height: 172px !important;"></p><p style="margin: 15px 1em; text-align: left; letter-spacing: 0.5px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important; margin: 15px 1em; text-align: left; letter-spacing: 0.5px; line-height: 1.75em;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(63, 63, 63);"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">热门阅读文章：<br></strong></span></p><hr style="max-width: 100%; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><ul style="list-style-type: circle;" class="list-paddingleft-2"><li><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important; margin: 15px 1em; text-align: left; letter-spacing: 0.5px; line-height: 1.75em;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283175&amp;idx=1&amp;sn=c799c0b1773dea71c74457c446cb2c59&amp;chksm=b1815c2d86f6d53b6e6722395e4d3d4cfdd2af00131e0462b3a19767bf4e271dd8ead5c8e35b&amp;scene=21#wechat_redirect" target="_blank">选择看雪企业 SRC 的 5 大理由</a><br></span></p></li><li><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important; margin: 15px 1em; text-align: left; letter-spacing: 0.5px; line-height: 1.75em;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283987&amp;idx=1&amp;sn=bae7e5f9b2e51f06c66d1901f36af4d4&amp;chksm=b1815f5986f6d64f6cb9e2a8d92335fa4cdddd6f06821e5badf067a9a32f5c429e267bfb5a8d&amp;scene=21#wechat_redirect" target="_blank">欢迎展示您的个人主页~</a><br></span></p></li><li><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important; margin: 15px 1em; text-align: left; letter-spacing: 0.5px; line-height: 1.75em;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284006&amp;idx=2&amp;sn=4e3778b3ebd607618713476adb5b9aa2&amp;chksm=b1815f6c86f6d67af9560503f5f1db135243e8661ffbeaf3fe0aa4d272278be8c68683d45a0c&amp;scene=21#wechat_redirect" target="_blank">CPU 异常浅析</a><br></span></p></li><li><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important; margin: 15px 1em; text-align: left; letter-spacing: 0.5px; line-height: 1.75em;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283977&amp;idx=1&amp;sn=be01625a23e5e04953ef3d70c51c9aa6&amp;chksm=b1815f4386f6d6551be14752b1b53ddec0e0e293aaa48a41e4568040cd25c0474b42b7452e6f&amp;scene=21#wechat_redirect" target="_blank">如何手动绕过SQL注入过滤器？（一）</a><br></span></p></li><li><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important; margin: 15px 1em; text-align: left; letter-spacing: 0.5px; line-height: 1.75em;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283940&amp;idx=1&amp;sn=101627b11a4a69f064c50e31af541b8b&amp;chksm=b1815f2e86f6d63891261de8b0a3af7f06a3c0850bd309e1f4d8ffe108b4662ecf20eced9d0e&amp;scene=21#wechat_redirect" target="_blank">SQL注入新手教程（第二部分）</a><br></span></p></li></ul><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important; margin: 15px 1em; text-align: left; letter-spacing: 0.5px; line-height: 1.75em;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(63, 63, 63);">更多优秀文章，长按下方二维码，“<span style="font-size: 15px; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8F7ckRiaZtp76v0KXiaibibdH9bCfZtDdhqeqbk5LToic1TlqZZJ05wLxqexpbloufvSCKbUEPbEtFUzzQ/640?wx_fmt=jpeg" style="visibility: visible !important; width: 750px !important; height: 499.805px !important;"></p><p style="line-height: 2em; margin-top: 15px; margin-bottom: 15px;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(63, 63, 63);"></span><span style="font-size: 15px; color: rgb(255, 255, 255);">&nbsp; <span style="display: none; line-height: 0px;">‍</span></span><span style="font-size: 15px; color: rgb(255, 255, 255);">&nbsp;&nbsp;</span><span style="font-size: 15px; background-color: rgb(136, 136, 136); color: rgb(255, 255, 255);">看雪论坛：http://bbs.pediy.com/<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="line-height: 2em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px; color: rgb(255, 255, 255);">&nbsp; &nbsp; </span><span style="font-size: 15px; background-color: rgb(136, 136, 136); color: rgb(255, 255, 255);">微信公众号 ID：ikanxue</span></p><p style="line-height: 2em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px; color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 15px; background-color: rgb(136, 136, 136); color: rgb(255, 255, 255);">微博：看雪安全</span></p><p style="line-height: 2em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px; color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 15px; background-color: rgb(136, 136, 136); color: rgb(255, 255, 255);">商务合作：wsc@kanxue.com</span></p></section></section><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1500384871&src=3&ver=1&signature=FkzcjJJ48va4gLuFLNnuhkhH-og5pFwEaV31j2I9UYmZuCfoFGBOLJiXHWsGDm4fWeZ-VLFPoNws8A3ckZLud5gTJvKDA1yuOyo5Rf6d0QXuZtL3oFw6YQwiT7yaTYZKGSUV4esoFJQVt2GtaiSvdhG3nK4W6KzcJsUl1PxKc-E=">微信地址</a> | <a href="http://bbs.pediy.com/thread-219070.htm">阅读原文</a>
{% endraw  %}

