---
title: AMD CPU 出现堆栈溢出漏洞，专家称其利用条件较为苛刻
author: 看雪学院
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1515984875&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siPPs-NRfvlwjuvH7xFTtLmsOPyUEuRfepE4lmADgDB-KqTGJpoTQDDroKcwkYhW3KalhX7tNfGuA8xob5X*bkU57PblCUZsM0Zp2U5j0qcNmLW1WUWrXkSdhMsVGA*sKbshSvg1GqwlRFSeczoAzuNI=
date: '2018-01-08 00:00:00 +0000'

---

{% raw  %}
<p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-left: 8px;margin-right: 8px;"><img src="https://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EX9OJYs6GSgGYhMzeXh6ffbQYhG1xkX8mPG65q2Aibh6aPvsIFs1NGyqkHMh90BRKT24dFhy1W9pA/0?wx_fmt=png" style="color: rgb(11, 21, 29); visibility: visible !important; width: 558px !important; height: 202.74px !important;"></p><section class="" style="padding: 10px;max-width: 100%;box-sizing: border-box;display: inline-block;width: 670px;vertical-align: top;background-color: rgb(246, 246, 246);overflow-wrap: break-word !important;"><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">谷歌专家 Cfir Cohen 发现&nbsp;</span><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">AMD</span><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;处理器的平台安全处理器（PSP）中的 fTMP 模块存在一个堆栈溢出漏洞，影响 AMD 64 位 x86 的处理器。研究人员透露虽然该漏洞目前尚未得到解决，但是其利用条件也是非常严苛的。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">AMD PSP 是内置于主 CPU 芯片上的专用安全处理器，提供类似于英特尔管理引擎的管理功能；Trusted Platform Module（可信平台模块）是安全加密处理器的国际标准，也是专用微控制器，通过将加密密钥集成到设备中来保护硬件；而 fTMP 则是 Trusted Platform Module 的固件实现。</span></p></blockquote><h4 style="margin-left: 8px;margin-right: 8px;"><br><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"></span></h4><h4 style="margin-left: 8px;margin-right: 8px;"><strong><span style="color: rgb(79, 79, 79);letter-spacing: 2px;font-size: 16px;">漏洞通过 EK 证书加以利用</span></strong></h4><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">安全专家 Cohen 手动静态分析发现函数 EkCheckCurrentCert 中有一个基于堆栈的溢出，该函数通过 TPM2_CreatePrimary 调用用户控制数据（存储在 NV 存储器中的 DE 编码的认证密钥（EK）证书）。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">Cohen 解释说，TLV（类型长度值）结构被解析并复制到父堆栈帧，但在管理 TLV 结构时特制的 EK 证书缺少边界检查导致了堆栈溢出。因此攻击者可以使用特制的 EK 证书来获得 AMD 安全处理器的远程代码执行权。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 16px;"><strong><span style="color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></strong></span></p><h4 style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 16px;"><strong><span style="color: rgb(79, 79, 79);letter-spacing: 2px;">漏洞利用条件较为苛刻</span></strong><strong><span style="color: rgb(79, 79, 79);letter-spacing: 2px;"></span></strong></span></h4><p><br></p><blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">Cohen 称利用该漏洞的先决条件是需要进行物理访问，而有关专家专家指出， PSP 并没有实现堆栈 cookies、No-eXecute（NX）标志或地址空间布局随机化（ASLR）等常见的缓解技术。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">与此同时， security biz Capsule8 的联合创始人和首席技术官 Dino Dai Zovi 也表示漏洞应该不太受远程执行。 因为使用了该漏洞的证书需要被写入到 NVRAM 中，所以攻击者必须具有主机的特权访问或物理访问权限。</span></p></blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">随后 AMD 的发言人向媒体证实该漏洞确实难以被利用：攻击者首先必须访问主板，然后修改 SPI-Flash 才能进行漏洞利用。考虑到这些条件，攻击者可能将会访问受 TPM 保护的信息，比如加密密钥。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">目前 AMD 计划在有限数量的固件版本上解决该漏洞，安全更新将在本月晚些时候发布。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><section class="" style="max-width: 100%;letter-spacing: 2px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;background-color: rgba(1, 0, 0, 0);text-align: justify;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;">来源：hackernews</span></p></section></section></section></section><p><br></p><p><br></p><p><br></p><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><ul class=" list-paddingleft-2" style=""><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287274&amp;idx=4&amp;sn=9f497d3365eb08deed563891d86853d6&amp;chksm=b1814c2086f6c5369fbd9a11002ca526258f0641808179ed27e83c2d8d23a6261e5bbb000fe1&amp;scene=21#wechat_redirect" target="_blank">看雪学院招募看雪讲师</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287349&amp;idx=1&amp;sn=0763551bb2121d1aa1200a46c2483d09&amp;chksm=b1814c7f86f6c5690de4c83aa499c85bcc36f5177bf707fdffc6d43a845d4a5bed67d587cb9c&amp;scene=21#wechat_redirect" target="_blank">曝出 CPU 严重设计缺陷后，Intel 如坐针毡</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287387&amp;idx=1&amp;sn=7db4fde79062d898f320a2cf51c81b96&amp;chksm=b1814d9186f6c487819de2f734da7aa3e2797f46ef339752b037f5eaa29ae27ea55ea20ce2fe&amp;scene=21#wechat_redirect" target="_blank">解读计算机处理器之殇 - Meltdown 与 Spectre</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287387&amp;idx=3&amp;sn=d7125e34bac095aa2a2d6b89d12ed780&amp;chksm=b1814d9186f6c48740865b2624ec37a8e571985b1d45f4423b53b3f44c3270ea4fdea535312c&amp;scene=21#wechat_redirect" target="_blank">GPS 追踪服务存在漏洞，用户隐私易泄露</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287387&amp;idx=2&amp;sn=ee0f400d8e8fac0b85a520d26e1e8714&amp;chksm=b1814d9186f6c4877b65154b2833c899a6ff045cd32a7222b2acf8b0f9b778a79f14ff406388&amp;scene=21#wechat_redirect" target="_blank">安卓发布公告，修复多处关键漏洞</a></span></p></li></ul><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"></span></p><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;text-align: center;letter-spacing: 2px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">更多安全资讯，戳左下角“阅读原文”查看！<br style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></strong></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;text-align: center;letter-spacing: 2px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></strong></span><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HTpGlibXdQ4YIynJnSjWwOjSroH8JkP00Cpl0TvGwSCibJpPmSmcartSbQUfodq49ulaLk1Yicrem3A/?wx_fmt=jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 754px !important; height: 189.285px !important;"></p><p><br></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1515984875&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siPPs-NRfvlwjuvH7xFTtLmsOPyUEuRfepE4lmADgDB-KqTGJpoTQDDroKcwkYhW3KalhX7tNfGuA8xob5X*bkU57PblCUZsM0Zp2U5j0qcNmLW1WUWrXkSdhMsVGA*sKbshSvg1GqwlRFSeczoAzuNI=">微信地址</a> | <a href="https://zhuanlan.kanxue.com/user-733834.htm">阅读原文</a>
{% endraw  %}

