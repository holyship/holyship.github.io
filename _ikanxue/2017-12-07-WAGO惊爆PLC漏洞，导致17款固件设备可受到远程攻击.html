---
title: WAGO惊爆PLC漏洞，导致17款固件设备可受到远程攻击
author: ljcnaix
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1512886045&src=3&ver=1&signature=0dsH*cvrb7sDcdE*f0PtKJTfSmWmpGSr1bt6eLQusWUeX1D3PeY-hy0sLVqqzj8ewzefSEoH9llGPntsMnS0FJf5iStmwBdHOzRdsVPvs4IrK3Mi0uDkVXuVrONN9Wa*yXs28hjsana9VkWQiVbX80aKbOZEA32*9RXU37zRTjE=
date: '2017-12-07 00:00:00 +0000'

---

{% raw  %}
<p><br></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8Hb2LQv4StIPwtLHGKqFP9Mia9aruy07JEQg5L0JhvWzGnEMT97HqDVibcrCT0yxic4IgscWWyWEge3Q/0?wx_fmt=jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 540px !important; height: 405px !important;"></p><p><br></p><section class="" style="padding: 10px;max-width: 100%;box-sizing: border-box;display: inline-block;width: 670px;vertical-align: top;background-color: rgb(246, 246, 246);overflow-wrap: break-word !important;"><p style="margin-left: 8px;margin-right: 8px;"><span style="letter-spacing: 2px;color: rgb(63, 63, 63);font-size: 15px;"></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 2px;"></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 2px;"></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">可编程逻辑控制器（PLC）支持着机器人、核能、石油、天然气的生产和运输以及许多其他工业任务的远程自动化。</span></p><blockquote><table class="cquote" role="presentation" width="NaN"><tbody><tr><td style="vertical-align: top;border-color: currentcolor;border-style: none;border-width: medium;-moz-border-top-colors: none;-moz-border-left-colors: none;-moz-border-bottom-colors: none;-moz-border-right-colors: none;padding: 4px 10px;"><br class="Apple-interchange-newline"><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(111, 111, 111);">可编程逻辑控制器（<span style="font-size: 15px;color: rgb(111, 111, 111);letter-spacing: normal;">Programmable Logic Controller</span>，简称PLC）是一种数字运算操作的电子系统，专为在工业环境应用而设计的。它采用一类可编程的存储器，用于其内部存储程序，执行逻辑运算、顺序控制、定时、计数与算术操作等面向用户的指令，并通过数字或模拟式输入/输出控制各种类型的机械或生产过程。可编程逻辑控制器及其有关外部设备，都按易于与工业控制系统联成一个整体，易于扩充其功能的原则设计。</span></p></td></tr></tbody></table></blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">PLC漏洞可能对生产过程和关键基础设施构成严重威胁，WAGO有17种型号的PFC200系列PLC容易受到远程攻击。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">SEC Consult的安全研究人员在固件版本为02.07.07，CODESYS运行时2.4.7.0的PFC200 PLC上发现了一个漏洞。CODESYS运行时，通常包含在PLC中，为用户对PLC编程提供支持。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">早在2012年，IOActive的安全研究人员Reid
 
Wightman就发现了CODESYS运行时版本2.3.x和2.4.x中的漏洞，该漏洞允许对运行这些版本的PLC进行未经授权的远程管理。利用这个漏洞，攻击者可以执行特权操作并执行相当于重新编程设备的文件修改。CODESYS运行时3S的作者发布了一个补丁来解决这些漏洞，但供应商和用户需要在受影响的设备上手动打上这个补丁。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">前不久，SEC
 
Consult的安全研究人员在CODESYS运行时发现了另一个漏洞，即使在运行早期补丁的系统上也可以进行经过认证的远程访问。CODESYS运行时包含一个以CODESYS的root权限运行的“plclinux_rt”服务。根据SEC
 Consult研究人员的说法，攻击者可以通过发送特制的数据包来触发以下功能：</span></p><ul style="margin-left: 8px;margin-right: 8px;" class=" list-paddingleft-2"><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">任意文件读/写/删除（著名的“Digital Bond”工具集对此提供了支持）</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">切换当前PLC中执行的函数</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">循环执行当前PLC程中的任何函数</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">删除当前PLC中的变量列表</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">还有更多的功能...</span></p></li></ul><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">这似乎足以干扰PLC的运行甚至注入新的PLC代码来执行远程攻击者希望的任何操作。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">WAGO已经证实，750-88X系列的PFC2001 PLC和750-810X系列的PFC100 PLC不会受到攻击。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">而有17款未公开具体版本信息的PLC受到漏洞影响。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">临时的缓解措施包括禁用“plclinux_rt”服务，并将PLC物理隔离。但由于PLC对高可用性要求极高，大多数用户不太可能选择禁用该服务，因此多数的WAGO设备应该会被物理隔离。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">然而，通过简单的Censys搜索显示，许多PFC200设备可以通过互联网直接访问（当然这个搜索不能确定这些PLC是否是易受攻击的版本）。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">CODESYS运行时被许多供应商广泛部署，在过去几年中已经被曝出多个漏洞。这些漏洞可能有未知的更广泛的影响面。正如SEC Consult所警告的那样，“使用CODESYS 2.3.X/2.4.X运行时的任何供应商的设备都可能具有相同的漏洞。”</span></p><p style="margin-left: 8px;margin-right: 8px;"><br><span style="font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 2px;"></span></p><p style="margin-left: 8px;margin-right: 8px;"><br></p><section class="" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;background-color: rgba(1, 0, 0, 0);overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 2px;box-sizing: border-box !important;overflow-wrap: break-word !important;">来源：securityaffairs<br></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;background-color: rgba(1, 0, 0, 0);overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 2px;box-sizing: border-box !important;overflow-wrap: break-word !important;">本文由看雪翻译小组 ljcnaix 编译<br></span></p></section></section></section></section><p><br></p><p><br></p><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 1px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><ul class=" list-paddingleft-2" style=""><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 1px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458286814&amp;idx=2&amp;sn=e494b451bb978992e640fbd6df86440e&amp;chksm=b1814a5486f6c3425ea8ce30ef9404d96675f886fb322792a441e34f23f8b7a0c67a1ea589a5&amp;scene=21#wechat_redirect" target="_blank">NSA 雇员在家中私藏机密文件，或面临 10 年的监禁</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 1px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458286814&amp;idx=3&amp;sn=1ec42fb975bebc418735af4efa937d74&amp;chksm=b1814a5486f6c34226082882f52a00952e92e5226a030642b9f7dced62c0dbfae910b270e0fb&amp;scene=21#wechat_redirect" target="_blank">只需40美元，就可以买到一款可永久使用的勒索软件</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 1px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458286789&amp;idx=3&amp;sn=ee93fbf08acc150922c1a778bcba5801&amp;chksm=b1814a4f86f6c35918efb0f03248dbdece317fc1d4d5e9183415d16c007aea132f3c6b3d969f&amp;scene=21#wechat_redirect" target="_blank">谷歌明年将开始禁止 Chrome 浏览器植入第三方软件</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 1px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458286752&amp;idx=2&amp;sn=ac0b4bf8f41d683870bb5bd6305956f4&amp;chksm=b1814a2a86f6c33c879d2e32627e083096b68e150c90834a63e17e01b55f98df3e123fd24450&amp;scene=21#wechat_redirect" target="_blank">美国当局将允许比特币期货在芝商所和芝期所交易</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 1px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458286789&amp;idx=2&amp;sn=df30f19ac53a9522619fdc315c95e6f9&amp;chksm=b1814a4f86f6c3596840668a45e138e3ed065e2a2c0af2538bda875eafcd282377a09bb9c0f5&amp;scene=21#wechat_redirect" target="_blank">Cisco 修复 WebEx Player 多处高危 Bug</a></span></p></li></ul><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 1px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"></span></p><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;text-align: center;letter-spacing: 1px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">更多安全资讯，戳左下角“阅读原文”查看！<br style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></strong></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></strong></span><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HTpGlibXdQ4YIynJnSjWwOjSroH8JkP00Cpl0TvGwSCibJpPmSmcartSbQUfodq49ulaLk1Yicrem3A/640?wx_fmt=jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 754px !important; height: 189.285px !important;"></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1512886045&src=3&ver=1&signature=0dsH*cvrb7sDcdE*f0PtKJTfSmWmpGSr1bt6eLQusWUeX1D3PeY-hy0sLVqqzj8ewzefSEoH9llGPntsMnS0FJf5iStmwBdHOzRdsVPvs4IrK3Mi0uDkVXuVrONN9Wa*yXs28hjsana9VkWQiVbX80aKbOZEA32*9RXU37zRTjE=">微信地址</a> | <a href="https://zhuanlan.kanxue.com/article-4298.htm">阅读原文</a>
{% endraw  %}

