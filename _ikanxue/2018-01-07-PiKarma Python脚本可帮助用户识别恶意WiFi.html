---
title: PiKarma Python脚本可帮助用户识别恶意WiFi
author: 哆啦咪
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1515984875&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siPPs-NRfvlwjuvH7xFTtLmsOPyUEuRfepE4lmADgDB-KqTGJpoTQDDroKcwkYhW3KSPrFj0cwDOMyk5IVWxHvsuQMoRHD8dFwVvv3t4vJ1meGWpOivarY8cvLw3XGs5WYv9bmdxKeF8Qr0CR8mekQIQ=
date: '2018-01-07 00:00:00 +0000'

---

{% raw  %}
<p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-left: 8px;margin-right: 8px;"><img src="https://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EEkOg6CuibnF1kka3lLuxFPCyBW8NraXG4sd2Jxp6gQUWXP0sKJp5QaNBrjZtL86LszvAWmBDrJUw/0?wx_fmt=png" style="color: rgb(11, 21, 29); visibility: visible !important; width: 558px !important; height: 273.42px !important;"></p><section class="" style="padding: 10px;max-width: 100%;box-sizing: border-box;display: inline-block;width: 670px;vertical-align: top;background-color: rgb(246, 246, 246);overflow-wrap: break-word !important;"><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span><strong><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"></span></strong></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">2017年12月公布的一个开源项目因其巨大的作用很快吸引了大家的注意，特别是对常常出门旅行，不得不连接许多Wifi网络的用户。而这大大增加了他们被黑客入侵的几率。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">这个开源项目称为“PiKarma”，是由一个土耳其安全研究员Besim Altinok原创的Python脚本，可以识别嗲有KARMA攻击的wifi网络。这个攻击是著名Wifi中间人攻击中的一种。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><h2 style="margin-left: 8px;margin-right: 8px;"><strong><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">PiKarma 可帮助用户免于KARMA攻击</span></strong></h2><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">KARMA攻击背后的原理很简单，当用户连接Wifi网络时，大多数设备会记录无线网络的设置，因此，下一次设备就会自动连接已经连接过的Wifi网络。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">这个过程进行时，设备会向附近的访问点发送Wifi无线探测器，询问是否<span style="color: rgb(79, 79, 79);font-size: 15px;letter-spacing: 2px;background-color: rgb(246, 246, 246);">该设备曾经连接过</span>某一无线网络。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">一个发动KARMA攻击的攻击者会配置其访问点，改变wifi网络的设置，并回复所有探索请求，绕过受害者的设备，假装该设备曾经连接过这个恶意网络。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><img src="http://mmbiz.qpic.cn/mmbiz_gif/1UG7KPNHN8EEkOg6CuibnF1kka3lLuxFPLaUf5b274YvYHzny18pvypvUfQqRMMpFpvkcfaKLbcLRBudTeCPbmQ/0?wx_fmt=gif" style="box-sizing: inherit; border-style: none; vertical-align: middle; max-width: 90%; width: 473px !important; height: 230px !important;"></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">KARMA and MANA攻击位于硬件或软件的中心，大多数网上流传的WIFI拦截工具包有免费的，有付费的，如 FruityWifiMana, WiFi Pineapple, MANA Toolkit等。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">这些工具都很有用，因为大多数设备能够自动记住所有以前连接过的WiFi细节，也因为大多数用户对这种黑客攻击手法一无所知。即使有用户了解，他们通常也不会从设备的WiFi配置部分删除以前的网络。</span></p><p style="margin-left: 8px;margin-right: 8px;"><strong><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></strong></p><h2 style="margin-left: 8px;margin-right: 8px;"><strong><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">PiKarma 可切断用户设备中的可疑WiFi</span></strong></h2><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">PiKarma允许用户在进行敏感通信前，测试WiFi网络，并确定某个位置的WiFi网络是否安全。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">如果脚本检测到KARMA攻击，则会记录详细信息，并自动发送拒绝请求，从而使用户免于连接恶意网络。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">PiKarma唯一的缺点是用户需要有一个辅助网卡来监视主卡。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">虽然Altinok仅在TP LINK TL-WN722N和Dark RangeMax上测试了PiKarma，但我们有理由相信该脚本能与其他基于USB的插入式的WiFi卡一起使用。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">同样，Altinok仅在Kali Linux上测试了PiKarma，但该脚本应该可以在其他平台（例如Windows或Mac）上运行。研究人员称：“如果安装了必要的模块，它就可以在每个系统上运行。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><h2 style="margin-left: 8px;margin-right: 8px;"><strong><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">WiPi-Hunter项目</span></strong></h2><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">Altinok也是WiPi-Hunter的主要力量，WiPi-Hunter是一个提供开源工具来检测各种基于WiFi攻击的项目。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">以前还发布过其他工具，包括PiSavar（检测WiFi菠萝攻击），PiDense（监视可疑或非法无线网络）和PiFinger（搜索WiFi菠萝痕迹并计算无线网络安全评分）等。</span></p><p><br></p><p><br></p><section class="" style="max-width: 100%;letter-spacing: 2px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;background-color: rgba(1, 0, 0, 0);text-align: justify;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;">来源：bleepingcomputer</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;background-color: rgba(1, 0, 0, 0);text-align: justify;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;">本文由看雪翻译小组 哆啦咪 编译<br></span></p></section></section></section></section><p><br></p><p><br></p><p><br></p><p><br></p><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><ul class="list-paddingleft-2" style=""><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287274&amp;idx=4&amp;sn=9f497d3365eb08deed563891d86853d6&amp;chksm=b1814c2086f6c5369fbd9a11002ca526258f0641808179ed27e83c2d8d23a6261e5bbb000fe1&amp;scene=21#wechat_redirect" target="_blank">看雪学院招募看雪讲师</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287349&amp;idx=1&amp;sn=0763551bb2121d1aa1200a46c2483d09&amp;chksm=b1814c7f86f6c5690de4c83aa499c85bcc36f5177bf707fdffc6d43a845d4a5bed67d587cb9c&amp;scene=21#wechat_redirect" target="_blank">曝出 CPU 严重设计缺陷后，Intel 如坐针毡</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287313&amp;idx=3&amp;sn=fa80f559608a23e2550128428e999db9&amp;chksm=b1814c5b86f6c54d062f67681e46352916e843c62e80f3024e0af5375003eb7ca3e98a178ff4&amp;scene=21#wechat_redirect" target="_blank">利用算法可修复损坏图片、增强低分辨率图片</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287313&amp;idx=2&amp;sn=da49603f4f7a057e8613b7650597aaef&amp;chksm=b1814c5b86f6c54de34aa8ef38fdc1d0326118e7743182f0ea905ee2fcc82b0f234e41ce685b&amp;scene=21#wechat_redirect" target="_blank">三星安卓浏览器中发现严重漏洞可绕过“同源策略”</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287349&amp;idx=3&amp;sn=6bb8d79379dba05d28cf290f9f3c7bb2&amp;chksm=b1814c7f86f6c569ef2635942feaef1ed37786ecbefde0419843c490b9a38b389113fe5df904&amp;scene=21#wechat_redirect" target="_blank">前NSA黑客逆向卡巴斯基杀毒软件，可检测机密文件</a></span></p></li></ul><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"></span></p><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;text-align: center;letter-spacing: 2px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">更多安全资讯，戳左下角“阅读原文”查看！<br style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></strong></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;text-align: center;letter-spacing: 2px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></strong></span><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HTpGlibXdQ4YIynJnSjWwOjSroH8JkP00Cpl0TvGwSCibJpPmSmcartSbQUfodq49ulaLk1Yicrem3A/?wx_fmt=jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 754px !important; height: 189.285px !important;"></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1515984875&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siPPs-NRfvlwjuvH7xFTtLmsOPyUEuRfepE4lmADgDB-KqTGJpoTQDDroKcwkYhW3KSPrFj0cwDOMyk5IVWxHvsuQMoRHD8dFwVvv3t4vJ1meGWpOivarY8cvLw3XGs5WYv9bmdxKeF8Qr0CR8mekQIQ=">微信地址</a> | <a href="https://zhuanlan.kanxue.com/article-4360.htm">阅读原文</a>
{% endraw  %}

