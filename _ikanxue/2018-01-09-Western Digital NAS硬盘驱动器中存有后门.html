---
title: Western Digital NAS硬盘驱动器中存有后门
author: 哆啦咪
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1515984875&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siPPs-NRfvlwjuvH7xFTtLmsOPyUEuRfepE4lmADgDB-KqTGJpoTQDDroKcwkYhW3KfPQA2LmcnhzlStTbBD7vSuFKQPyn3L8auIKD3da2DARqzQ-XJPZgx0SQZ7pU6RoaM1tpnctQKxl4hmHCN5Ytxw=
date: '2018-01-09 00:00:00 +0000'

---

{% raw  %}
<p style="max-width: 100%;min-height: 1em;text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-left: 8px;margin-right: 8px;"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HGI16ic3pdjjKKGupXUgqcDcEx9bfUmMJA2NYQYDoN3wNcE9xVtSHPMIS5wPszFZ6mzu8libf942Zg/0?wx_fmt=jpeg" style="color: rgb(11, 21, 29); visibility: visible !important; width: 542px !important; height: 197.288px !important;"></p><section class="" style="padding: 10px;max-width: 100%;box-sizing: border-box;display: inline-block;width: 670px;vertical-align: top;background-color: rgb(246, 246, 246);overflow-wrap: break-word !important;"><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">一位安全研究人员发现了西部数据MyCloud NAS设备的一系列重要的安全漏洞。其中一个漏洞为硬编码后门账户。他呼吁其公司尽快更新其便携式硬盘驱动器的固件。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">海湾科技研究与开发部门的安全研究员James Bercegay在2017年6月发现并向西部数据报告了这些漏洞。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">西部数据发布更新固件后，研究人员于上周三发表了一份详细报告。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><h2 style="margin-left: 8px;margin-right: 8px;"><strong><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">RCE，后门和CSRF</span></strong></h2><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">该报告描述了三个主要的漏洞，可能被滥用，造成严重后果。下面提供了所有漏洞的简短摘要，如果想要更详细地了解每个漏洞，请应参</span><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">Bercegay's bug report</span><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">：</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">1）无限制的文件上传<br style="box-sizing: inherit;">研究人员在WD MyCloud内置的Web服务器上找到一个PHP文件可以让攻击者在该设备上上传文件。研究人员通过这个漏洞，在该设备上上传了一个web shell，使之完全掌控该设备。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">2）硬编码后门帐户<br style="box-sizing: inherit;">攻击者可以使用用户名“mydlinkBRionyg”和密码“abc12345cba”登录WD MyCloud NAS设备。 虽然该后门程序不会给予攻击者管理员访问权限，但是攻击者可利用另一个漏洞获得后门帐户的root权限。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">3）CSRF（跨站点请求伪造）<br style="box-sizing: inherit;">一个CSRF，可用于在设备上执行恶意命令，并重置设备的后端界面语言。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><h2 style="margin-left: 8px;margin-right: 8px;"><strong><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">该漏洞极具传染性，可能会影响私人NAS设备</span></strong></h2><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">在所有发现的漏洞中，Bercegay认为硬编码后门帐户影响最大，因为通过此漏洞，攻击者不仅可以攻击连接到互联网的NAS设备，还可以攻击本地网络所隔离的设备。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">研究人员认为这个漏洞利用非常简单，因此影响范围更大，更危险。“不仅如此，锁定到局域网的用户也不安全。简单来说，只要用户访问一个内置有iframe或img标签的网站，该网站会使用主机名为如“wdmycloud”和“wdmycloudmirror”等，向有漏洞的设备发送一个请求，从而接管该WDMyCloud。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">研究人员提供了一个例子。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">下面的代码适用于图片，当加载到WD NAS设备所有者的计算机上时，将格式化MyCloud设备。由于代码可以隐藏在广告或一个像素的iframe中，用户在加载页面时甚至不会注意到它。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">&lt; img src="http://wdmycloud/cgi-bin/nas_sharing.cgi?dbg=1&amp;cmd=51&amp;user=mydlinkBRionyg&amp;passwd=YWJjMTIzNDVjYmE&amp;start=1&amp;count=1;rm+-rf+/;"&nbsp;&gt;</span></p></blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">西部数据发布固件版本2.30.174，已删除后门帐户并修复了漏洞。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">以下WD MyCloud设备正在使用易受攻击的固件版本：</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">Vulnerable:</span></p><ul style="margin-left: 8px;margin-right: 8px;" class="list-paddingleft-2"><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">MyCloud</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">MyCloudMirror</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">My Cloud Gen 2</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">My Cloud PR2100</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">My Cloud PR4100</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">My Cloud EX2 Ultra</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">My Cloud EX2</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">My Cloud EX4</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">My Cloud EX2100</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">My Cloud EX4100</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">My Cloud DL2100</span></p></li><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">My Cloud DL4100</span></p></li></ul><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">Not Vulnerable:</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">MyCloud 04.X Series</span></p></li><li><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: normal;">MyCloud 2.30.174</span></p></li></ul><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">Bercegay发现的一些缺陷也是去年3月Exploitee.rs社区的研究人员发现的。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">D-Link和WD在2014年共享相同的后门账户</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">伯塞吉还指出了另一个有趣的细节。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">研究人员说，西部数据似乎通过第三方软件供应商与D-Link DNS-320L ShareCenter共享固件代码。</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">Bercegay说旧的D-Link DNS-320L ShareCenter固件代码也带有相同的后门程序，但是D-Link四年前就把它移除了。</span></p><p><br></p><section class="" style="max-width: 100%;letter-spacing: 2px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section class="" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;background-color: rgba(1, 0, 0, 0);text-align: justify;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;">来源：bleepingcomputer</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;background-color: rgba(1, 0, 0, 0);text-align: justify;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;">本文由看雪翻译小组 哆啦咪 编译<br></span></p></section></section></section></section><p><br></p><p><br></p><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><ul class="list-paddingleft-2" style=""><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287274&amp;idx=4&amp;sn=9f497d3365eb08deed563891d86853d6&amp;chksm=b1814c2086f6c5369fbd9a11002ca526258f0641808179ed27e83c2d8d23a6261e5bbb000fe1&amp;scene=21#wechat_redirect" target="_blank">看雪学院招募看雪讲师</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287349&amp;idx=1&amp;sn=0763551bb2121d1aa1200a46c2483d09&amp;chksm=b1814c7f86f6c5690de4c83aa499c85bcc36f5177bf707fdffc6d43a845d4a5bed67d587cb9c&amp;scene=21#wechat_redirect" target="_blank">曝出 CPU 严重设计缺陷后，Intel 如坐针毡</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287387&amp;idx=1&amp;sn=7db4fde79062d898f320a2cf51c81b96&amp;chksm=b1814d9186f6c487819de2f734da7aa3e2797f46ef339752b037f5eaa29ae27ea55ea20ce2fe&amp;scene=21#wechat_redirect" target="_blank">解读计算机处理器之殇 - Meltdown 与 Spectre</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287387&amp;idx=3&amp;sn=d7125e34bac095aa2a2d6b89d12ed780&amp;chksm=b1814d9186f6c48740865b2624ec37a8e571985b1d45f4423b53b3f44c3270ea4fdea535312c&amp;scene=21#wechat_redirect" target="_blank">GPS 追踪服务存在漏洞，用户隐私易泄露</a></span></p></li><li><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287387&amp;idx=2&amp;sn=ee0f400d8e8fac0b85a520d26e1e8714&amp;chksm=b1814d9186f6c4877b65154b2833c899a6ff045cd32a7222b2acf8b0f9b778a79f14ff406388&amp;scene=21#wechat_redirect" target="_blank">安卓发布公告，修复多处关键漏洞</a></span></p></li></ul><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;letter-spacing: 2px;line-height: 1.5em;text-align: justify;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"></span></p><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;text-align: center;letter-spacing: 2px;line-height: 1.5em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">更多安全资讯，戳左下角“阅读原文”查看！<br style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></strong></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;text-align: center;letter-spacing: 2px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></strong></span><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HTpGlibXdQ4YIynJnSjWwOjSroH8JkP00Cpl0TvGwSCibJpPmSmcartSbQUfodq49ulaLk1Yicrem3A/?wx_fmt=jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 754px !important; height: 189.285px !important;"></p><p><br></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1515984875&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siPPs-NRfvlwjuvH7xFTtLmsOPyUEuRfepE4lmADgDB-KqTGJpoTQDDroKcwkYhW3KfPQA2LmcnhzlStTbBD7vSuFKQPyn3L8auIKD3da2DARqzQ-XJPZgx0SQZ7pU6RoaM1tpnctQKxl4hmHCN5Ytxw=">微信地址</a> | <a href="https://zhuanlan.kanxue.com/article-4376.htm">阅读原文</a>
{% endraw  %}

