---
title: “异鬼Ⅱ”Bootkit木马详细分析
author: 腾讯电脑管家
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1502116456&src=3&ver=1&signature=fMd4ZeYncDjRuvdiU8EiAqzwJV-51HguOx4pnyGlqXjJ10eFEeoZU*4ykBfJ5DfCcbB*9QgBsAKzwmoYzWJII-UCUQe91DIDs-kmMMgnLkCOlMS33rhZSdCbuQgMgXCijXU1ZoKJvHIHk6YxsVdXM48oQJ*xE2a4exR7PoJvNNs=
date: '2017-07-27 00:00:00 +0000'

---

{% raw  %}
<p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">下载站的高速下载器一直是恶意木马大规模传播的温床，前段时间的暗云Ⅲ木马通过高速下载器传播推广，感染机器数高达数百万台。近期，腾讯电脑管家又拦截到了一个<strong>通过高速下载器大范围传播的恶性Bootkit木马——异鬼Ⅱ</strong>，令人吃惊的是这个恶意VBR的植入者，居然是一款比较知名的软件——甜椒刷机。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">正因为开发者是正规的软件公司，<strong><span style="font-size: 15px; color: rgb(63, 63, 63);">软件上打了官方的数字签名，不少安全厂商将其加入白名单中，导致大量机器感染。</span></strong></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></strong></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">◆ </span></strong></span>该木马主要有以下特点：</span></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><section class="" style="margin-top: 10px; margin-bottom: 10px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><section class="" style="padding-left: 8px; padding-top: 8px; box-sizing: border-box;"><section style="padding-bottom: 5px; border-width: 1px; border-style: solid; border-color: rgb(192, 200, 209); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><section class="" style="background-color: rgb(255, 255, 255); margin: -8px 5px 0px -5px; border-width: 1px; border-style: solid; border-color: rgb(192, 200, 209); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><section class="" style="text-align: center; box-sizing: border-box;"><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1. 正规软件携带恶意代码：异鬼Ⅱ隐藏在正规软件中，带有官方数字签名，导致大量安全厂商直接放行。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2. 影响范围广：通过国内几大知名下载站的高速下载器推广，并且异鬼Ⅱ能够兼容xp、win7、win10等主流操作系统，影响数百万台用户机器。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">3. 云控、灵活作恶：木马的VBR感染模块，以及最终实际作恶的模块均由云端下发，作者可任意下发功能模块到受害者电脑执行任意恶意行为，目前下发的主要是篡改浏览器主页、劫持导航网站、后台刷流量等。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">4. 隐蔽性强、顽固性强：通过感染VBR长期驻留在系统中，普通的重装系统无法清除木马；异鬼Ⅱ还通过底层磁盘钩子守护恶意VBR，对抗杀软查杀。</span></p></section></section></section></section></section><section style="height: 8px; width: 100%; border-right: 1px solid rgb(192, 200, 209); transform: rotate(-45deg); transform-origin: right bottom 0px; margin-top: -9px; margin-bottom: 4px; border-color: rgb(192, 200, 209); box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><br></section></section></section></section></section><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZGBfQG0N2MP2pxRUecoI3r8RaicribsJzHUusf61PEYWg6Q9scrbw6aPg/0?wx_fmt=png" style="width: 544px !important; height: 348px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&nbsp;（更多“异鬼”资料查看http://tav.qq.com/index/newsDetail/255.html）</span></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&nbsp;</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">◆&nbsp;&nbsp; </span></strong></span><span style="color: rgb(63, 63, 63); font-size: 16px;"><strong>一、甜椒刷机通过下载器静默推广传播，云控篡改VBR</strong></span></span></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><span style="color: rgb(63, 63, 63); font-size: 16px;"><strong><br></strong></span></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">近期，甜椒刷机通过各大网站高速下载器疯狂静默推广，该版本的甜椒看似刷机软件，实则为恶性木马。异鬼Ⅱ隐藏了能够拉起云端恶意代码的后门，一旦运行，会从云端下载VBR感染模块感染电脑VBR，即使用户重装系统，也无法清除。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZEBvjYHh9YcVHz2ZicjJoGW2VDtuDNQ5t2q2EXkeyJYGwSicSUmuPxB8Q/0?wx_fmt=png" style="width: 738px !important; height: 367.222px !important;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZibOh0bicibxHPABhGXMjiaqfDv4gUYmNqIBY9XGaFHUViaIKyWRUHpAJU0Q/0?wx_fmt=png" style="width: 738px !important; height: 492.256px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">该版本甜椒刷机与官方http://www.onekeyrom.com/index.html最新版版本不同，应该是一个支线版本，但和官网的安装包用的是同一个数字证书签名，且木马使用的C&amp;C服务器与其官方软件所用服务器一致。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZH7T7WJUZ7hQTj5JGUhSBNOjHZAAcaAJPSJ0rYvE2WYPE7awj44bf9w/0?wx_fmt=png" style="width: 738px !important; height: 426.062px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">1. 安装包行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1)&nbsp;&nbsp; 运行后安装包首先会判断自身文件名中是否包含“20174”字符，如果包含则开始静默安装并在</span><span style="font-size: 15px; color: rgb(63, 63, 63); text-decoration: underline;">注册表、互斥量</span><span style="font-size: 15px; color: rgb(63, 63, 63); text-decoration: underline;"></span><span style="font-size: 15px; color: rgb(63, 63, 63);">上做标记，准备感染。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZZbeUbX7OE3nCnLhzFVtzqNzfplXN53C7sT9Ex5exiaKgzTJ85c8Duqw/0?wx_fmt=png" style="width: 636px !important; height: 533px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">创建名为SamRootDetect的互斥量，创建HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{FC70EFDD-2741-495C-9A93-42408F6878D9}\un注册表键值。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZzyUzPhdEItYYFJMcjKG0CicYxcyE4XaiaPps6ZYtT2whs5HrY8Y8oYgA/0?wx_fmt=png" style="width: 738px !important; height: 588.886px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">释放所有安装文件到指定目录后，运行主程序TJShuaji.exe，并Sleep 20秒，TJShuaji.exe启动后会检测互斥量，检测到才进行感染，所以必须在20秒内启动。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZyCqDiaWhfOPLcG28tCzhq1BoqrMxiaaOH0BGVfMPvTAibS5dfRCYdTSoQ/0?wx_fmt=png" style="width: 738px !important; height: 667.866px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">2. TJShuaji.exe行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1） 检测是否存在名为SamRootDetect或者OdinDetect的互斥量，或者命令行中是否包含有以上字符串。若是，则设立感染标志。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZI8sukgwLibaFIEgEnRZflTdjMTFh6ySNTfPT9FSWgqFLqkgcpHBsbdA/0?wx_fmt=png" style="width: 738px !important; height: 552.416px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2）满足以上条件，则设立感染标志。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZjqNkuWoiakTjuFKEjlpGUPaUbqsU35DeicHcBN3cn8m4kiaGMSf93etIA/0?wx_fmt=png" style="width: 738px !important; height: 164.44px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">3）判断感染标志，创建线程进行感染行为。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZ4ia30iaaKedtrEpbbRbT4E7mXx4WOZFHPcuCHVW4tJvbMdUIRMQJUvHQ/0?wx_fmt=png" style="width: 738px !important; height: 131.182px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">4）在线程中判断注册表否存在{FC70EFDD-2741-495C-9A93-42408F6878D9}\un键值（母体创建），以及是否存在{FC70EFDD-2741-495C-9A93-42408F6878D9}\ex键值（感染后会设置，防止重复感染）。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZPxOKdQibUO9Kt3miceuQq4SpF6QLgibFziaP9pvDicAGnyQRVKJbFU6uSibg/0?wx_fmt=png" style="width: 738px !important; height: 597.929px !important;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">5）满足以上条件后，访问以下URL，根据操作系统版本信息等下载数据，</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">http://bd.705151.com/clientapi/clientreport.ashx?u=%d&amp;pc=%s&amp;os=%d&amp;sid=%d</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">其中u为注册表un键值，pc为mac、cpuid等硬件信息的hash值，sid写死为10，os为32或64。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZVL3w6uCzdLmkx2eh1Fqd5grCUnzpdJHfFibgnUQ6YiagdpcxibPnPGaBg/0?wx_fmt=png" style="width: 738px !important; height: 615.649px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">6）提交信息后，服务器根据上传的版本信息重定向到不同的URL返回下载结果。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">32位：http://npic.shangfx.com/42c/43/6/a07/31a2d803.wav</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">64位：http://cache.yzrub.com/842/99/bb26/a2087bb.wav</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">文件下载回来后，解密并用zlib解压后在内存中加载执行，以下将其称作installdll.dll</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZeKMvgS5qdiaa8b9ESd5ib9c7c2Wg7FeAyRiaYMtTfAu99flC7d2VrOB8g/0?wx_fmt=png" style="width: 738px !important; height: 328.661px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZVL8XXHjvHVFn7orf3YG6qkyAicKtZiawqYwshBsFicyLhwgYBNpbyXtwg/0?wx_fmt=png" style="width: 738px !important; height: 53.4567px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&nbsp;</span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZ1EqRJAYhA3sjOTSeaMUnM6W2ic6HSPtibL9bmPC3mPdvPicKLULK3CJdg/0?wx_fmt=png" style="width: 738px !important; height: 50.4869px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">3. installdll.dll行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">该文件pdb路径与VBR中的木马PDB路径一致，可以确定为同一伙人开发。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZ2atb8UWdJhqia1Xa9dibgicNZFumWQfC56wHicmCoSlu6gmAx1ETwBXwXw/0?wx_fmt=png" style="width: 738px !important; height: 30.2534px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1）判断指定进程下是否有甜椒刷机安装包程序，以确定自己是否为被指定的程序推广安装，若否，则退出，不会进行感染。此外，如果注册表存在\duowan\YYExplorer等路径，即便没有找到相关文件也会进行感染。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZkaBVicfj0V3rZIp92KwTDH2dRbo2EWyTibdjfLH5S9WsKxUMBAEpEEcg/0?wx_fmt=png" style="width: 738px !important; height: 644.15px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2）检测进程列表中的进程名是否包含有smsniff、Wireshark、Dbgview、Procmon、procexp、OLLYDBG、regshot、ProcessHacker、idaq、devenv等字符，有则退出。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZhJqmzicMH2Dd60HWpR3hmOY4hLxUSRmQN0OtcoODOVe6KbgXUnFenag/0?wx_fmt=png" style="width: 481px !important; height: 594px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZFZdNhaqkiaZ44aShhXelnjw8pkKbk5zgwK8x5VROEic952eVAytVkUZQ/0?wx_fmt=png" style="width: 611px !important; height: 251px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">3）检测进程中是否有SbieDll.dll、api_log.dll、dir_watch.dll、SXIn.dll模块，有则退出。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZZbziaPyo6szuz3fibJFORyeEbGPTeCsj2I0zHdKrkEoQYAoeIxgNznMA/0?wx_fmt=png" style="width: 738px !important; height: 280.91px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZjNFZwZdGOabetKdUvozXlNaibeV2RmKLwKjyrMG5ic0cBE31u9p5jM4A/0?wx_fmt=png" style="width: 534px !important; height: 212px !important;"><span style="font-size: 15px; color: rgb(63, 63, 63);"> <br></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">4）通过进程名检测瑞星、360安全卫士、360杀毒、金山卫士、金山毒霸、腾讯电脑管家、百度杀毒、百度卫士、卡巴斯基、诺顿、MSE、火绒等安全软件，根据检测结果执行不同的感染逻辑，杀软进程名使用XOR 0x29加密。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZ559OwjoE66UdWdx72rj9jjID2lRlYJOY55BQL5EQlK7f7adyibv7nTw/0?wx_fmt=png" style="width: 696px !important; height: 553px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">&nbsp;</span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZTDXpoMZqBwQIibnZxYlhkQnqynCBpDia87aSquWd1pc6jMAia2be31AuQ/0?wx_fmt=png" style="width: 390px !important; height: 388px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">5）
 
感染相关的代码在dll中，木马会在内存中展开感染模块并加载执行，以下将其称为infect.dll，该dll提供两个导出函数，一个为BkInstall、BkTryWriteDisk，分别对应直接应用层写磁盘和通过驱动写磁盘的功能。此外，该dll有两个版本，分别对应win10操作系统和其他windows操作系统。如果要调用BkTryWriteDisk，则会先释放驱动到driver目录下并加载。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZal3ZWgv0ER1odicxpl1Jtj6YPMTL7tiaWyxLRtuXddlkTDq2slNBbAbA/0?wx_fmt=png" style="width: 738px !important; height: 113.473px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZO4673ibGTOmcCZk4hGXots4pTzCwnMEaicZGl596onoVBMybA6tK7oEw/0?wx_fmt=png" style="width: 738px !important; height: 581.868px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">4. infect.dll行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1）BkInstall，该函数直接打开磁盘写入木马。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZQPicdBGwSPcBOzTAdFDMZEyPpZFgKsMN4gxnMHDsEzHibRk3iboDq8Ipg/0?wx_fmt=png" style="width: 738px !important; height: 347.027px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2）BkTryWriteDisk，与\\.\{28F28D04-F525-fd5d-87197-C7A95250BCE2}设备进行通信，将要写入的内容和地址传给该设备进行磁盘写操作。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZWokoibrBq3EBejYIibjPic8dR6pPXkpkkz6mNAb7ibMxwrrDPrkYWmuyEA/0?wx_fmt=png" style="width: 738px !important; height: 421.471px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">5. WriteDiskBySys.sys行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">该驱动加了VMP，从其老版本以及pdb信息和应用层的调用方式分析，可知该驱动会创建名为{28F28D04-F525-fd5d-87197-C7A95250BCE2}的设备，供应用层调用，主要实现向指定磁盘位置写入数据的功能。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZicwHrwOyvDiaDH0JtsotS1lhHwZJCkiaqqauCwl7dV3cbVDrKZPhNHvNA/0?wx_fmt=png" style="width: 738px !important; height: 26.9343px !important;"></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">◆ <span style="color: rgb(63, 63, 63); font-size: 16px;"><strong>二、从VBR进入内核</strong></span></span></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><span style="color: rgb(63, 63, 63); font-size: 16px;"><strong><br></strong></span></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">该恶意的VBR是基于著名的网银木马Carberp的泄漏源码修改而来的，从VBR起一路hook到进入windows内核。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZDgicvtWX9V9aFCnDIo4PhTRAW7TjY1YGuariaCxjHvmRSNbp1aKZpRmA/0?wx_fmt=png" style="width: 713px !important; height: 734px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">1. VBR行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">由VBR到windows内核的启动过程见http://tav.qq.com/index/newsDetail/255.html，下图所示为被感染后的VBR数据。恶意VBR代码实现解密并加载磁盘尾部的palyload数据到windows内核中得到dump_diskfs.sys并执行。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZlkqGC9iccniborkaLEtcNpzHBsTkHR8YjC6GUKm1lP7jdlZkY50ODNjw/0?wx_fmt=png" style="width: 738px !important; height: 573.336px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">2. dump_diskfs.sys行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1）加载的内核驱动不会落地，驱动名字为dump_diskfs.sys。与系统中的几个正常驱动名字非常相近，并且同样不会落地，因此具有很大的迷惑性。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZoyuAfXaSDyicdfjJNmtng47FZ2JpNHyfBgvfibgic5F94vbBVSjp9FGug/0?wx_fmt=png" style="width: 738px !important; height: 66.548px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2）从playload数据中解压出一个应用层dll，将其保存到C:\\Windows\\system32\\usbsapi.dll</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">payload数据：</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZ7JbsM5clDU2C2Cy4icb8zwRMssODg7ibASJQBA6OcXBB3mN5HP2vqjfA/0?wx_fmt=png" style="width: 738px !important; height: 244.862px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZTiahwmuI9yozPgKweREbcbR6En1ygC2bRxsVXmdsD5TWN70bYFJtlpw/0?wx_fmt=png" style="width: 738px !important; height: 220.973px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">3）将解压出来的dll注入usbapi.dll到应用层：注册LoadImageNotifyRoutine回调，将usbapi.dll注入到explorer.exe，services.exe，spoolsv.exe，注入的方式是在目标进程的导入表中添加usbapi.dll为新的导入项。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZoAoxvpGCiazfRpzDKTrMm5Kt8rA6beIwZm0mbxJoiaOBxj1k4EcuFMfA/0?wx_fmt=png" style="width: 738px !important; height: 259.366px !important;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">4） 
向explorer.exe，services.exe，spoolsv.exe注入完成后的清理工作，注入完成后，驱动会删除LoadImageNotifyRoutine，并且强制删除usbsapi.dll，同时将正常的usbmon.dll拷贝重命名为usbsapi.dll。此外，驱动还会修改usbsapi.dll的时间属性为过去的某一固定时间，以迷惑安全分析人员。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZP6RjHHfQ7TOhBcPgV8JdYhfkCrW4OcBcx0N9yBJusQnOhquwickMTLw/0?wx_fmt=png" style="width: 738px !important; height: 284.962px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">5）hook磁盘驱动保护VBR。直接hook了磁盘驱动中的IRP_MJ_INTERNAL_DEVICE_CONTROL派遣函数。对写VBR区域的操作不做操作，只返回一个错误码。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZ9FTicZ2Y5J1El7oTOthUQic1h1od0CViaURzlQuID28lIL7Paqs7xz6sA/0?wx_fmt=png" style="width: 738px !important; height: 322.502px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZg65I8Zfbwus2uBhqLeAaQJpOcagOFBCaAwq1hlbCTKU3hw0hIIY4Gw/0?wx_fmt=png" style="width: 738px !important; height: 541.769px !important;"><br></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">◆ <span style="color: rgb(63, 63, 63); font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">三、插入到应用层的usbsapi.dll行为</span></strong></span></span></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><span style="color: rgb(63, 63, 63); font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);"><br></span></strong></span></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZ98DXFzsYWUtgibn7Ob3HoFMb6Fp5jGumdYmf12NPyKexiczDj5mqUJ3Q/0?wx_fmt=png" style="width: 737px !important; height: 484px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">1. usbsapi.dll行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">内存中展开一个dll，并将其加载，以下将其命名为injectdll_mini.dll</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZxZEbogYEjUFPKgibzvmfZ1XqrwicUgWbLFEDXxE57J36eesibXuibA4JIg/0?wx_fmt=png" style="width: 738px !important; height: 404.802px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">2. injectdll_mini.dll行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">injectdll_mini.dll主要实现内存加载。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZiccsMtsYJIkWaz7hBZRlfoUbLuxghkHsdR5Mj1n29m6ZRiaavVaHzfgg/0?wx_fmt=png" style="width: 738px !important; height: 222.68px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1）线程1——加载插件：查找指定目录下的wav文件，提取尾部数据，用zlib解压出一个PE文件，在内存中展开，三个进程加载的文件路径不同（文件名根据进程信息计算得来）。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZuAayauyfnibuic12szKXg8ccL8qToqB69y5VcBzSM78S89G3ia5d9S2Kg/0?wx_fmt=png" style="width: 738px !important; height: 489.564px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZtWzOJq35Jk8y6WovzVW8fldFq5RhHZfJPgQ094Elz0pKoSZI11Iz2g/0?wx_fmt=png" style="width: 738px !important; height: 194.525px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">插件保存目录如下：</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">C:\Windows\System32\config\systemprofile\AppData\Local\Microsoft\Media（services、spoolsv）</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">C:\Users\{USERNAME}\AppData\Local\Microsoft\Media（explorer）</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2）线程2——下载插件：连接C&amp;C，往iqp.sjime.com的upd 
8000端口发送包含当前进程信息的数据，接收并解密服务器返回的数据，从数据中解密提取要下载的url地址，从相关url地址下载wav文件到指定目录。如果失败，则6分钟后尝试备用域名buu.211360.com，不过当前两个域名都指向同一ip地址。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZGlOkh00PuuNDMQl417FFlmkxLTXvULPKJlteReicwJcg9pPYY7hbJUg/0?wx_fmt=png" style="width: 738px !important; height: 133.949px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">分析时，服务器返回的插件下载地址分别为：（spoolsv大部分不返回数据）</span></p><ul style="list-style-type: disc;" class=" list-paddingleft-2"><li><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="color: rgb(63, 63, 63); font-size: 15px;">services.exe （svcdll64.dll）</span><span style="font-size: 14px;"><span style="color: rgb(63, 63, 63);"></span><em><span style="color: rgb(63, 63, 63);">（http://932.kjwkn.com/uploads/wid/201704/1914595972.wav）</span></em></span></p></li><li><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px;"><span style="color: rgb(63, 63, 63);">explorer.exe （NewLockWebEx.dll）</span></span><span style="font-size: 14px;"><em><span style="color: rgb(63, 63, 63);">（http://ju58.tswzsh.com/a26/5e3/f51f/74/8f0a8f6.wav）</span></em></span></p></li></ul><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZvGcaYTDZOOibCIN5CuIPXusKhXYianficSB5ur6c0wzKNicuWbxJ606IRw/0?wx_fmt=png" style="width: 738px !important; height: 78.5833px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">下载成功的wav文件会保存到以下目录。</span></p><ul style="list-style-type: disc;" class=" list-paddingleft-2"><li><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><em><span style="color: rgb(63, 63, 63); font-size: 14px;">C:\Windows\System32\config\systemprofile\AppData\Local\Microsoft\Media</span></em></p></li><li><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 14px;"><em><span style="color: rgb(63, 63, 63);">C:\Users\{USERNAME}\AppData\Local\Microsoft\Media</span></em></span></p></li></ul><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZqa6pppFKkAW7ymyjKnpsFyiaYDvn2sDQcplJp3pT25NweBibyBkqQcBQ/0?wx_fmt=png" style="width: 738px !important; height: 581.427px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZEjLhgrriaUHK1ZgSebSyic4DVWLxVXzvUVjMplCiaEicFL0sJ7UXHbk1Tw/0?wx_fmt=png" style="width: 738px !important; height: 499.963px !important;"><br></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);"><br></span></strong></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">◆ 四、恶意插件行为分析</span></strong></span></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);"><br></span></strong></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">1. explorer.exe （NewLockWebEx.dll）行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">该插件的行为主要是通过修改注册表、通过修改浏览器配置信息、通过修改浏览器缓存中的导航网站cookie等方式来实现主页推广劫持。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZjLZ7buh1wNRcXkBFmxGEGZZWibw6CHGJwtqtmQlK93iaicCF1rqibGbYwg/0?wx_fmt=png" style="width: 572px !important; height: 490px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZTQa6AmWp3bziaQEkQFHfqsD2jpvRrSLO6xmppOXYgOLIre4VGM5WyGg/0?wx_fmt=png" style="width: 639px !important; height: 478px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZVbL5AumPBgE3ZBNYdUftEXeo0Bp9UkSGGbLQ6f3B41QWAJQxZ4hywg/0?wx_fmt=png" style="width: 738px !important; height: 554.566px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZzDVy06uRFW9H9oTiaOrgibbF2xRHCpWoORTPuVhXqxz6zKggvJJntianw/0?wx_fmt=png" style="width: 453px !important; height: 469px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZZ8NiaoKdvopiaA7ZkibOlKiagHJFibYzKvDuia5jBWB0LOEOAiaYvUolo5aqw/0?wx_fmt=png" style="width: 639px !important; height: 414px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">2. services.exe （svcdll64.dll）行为</span></strong><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">该插件通过修改host文件、强删安全软件配置文件、修改浏览器配置文件来实现锁主页，此外，会连C&amp;C定时上报信息。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1）加载驱动，强制删除安全软件配置文件。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZXxSDbiaAXDTZiatQCIMwpeicsqRibKu0xSeSpNACXb785BKUscwI7oboibg/0?wx_fmt=png" style="width: 738px !important; height: 186.846px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZZHAZyhwndBIyCTBePH0fIsCdDC3AqFUmJicwWoF9oiaiakADfmyhY3cmA/0?wx_fmt=png" style="width: 498px !important; height: 570px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZm3Sj6KsR9ibialuopxd2zicjCFqFb4F5ngDI4fRcucIbrHzQj7cp0wMPg/0?wx_fmt=png" style="width: 720px !important; height: 452px !important;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2）修改host文件，用于劫持sougou导航。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZDTZtpSSOz4ah0ylaWqrEXKEaibQeKec6pKQIr69eNktzPsaCDUkflMA/0?wx_fmt=png" style="width: 537px !important; height: 561px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">3）修改多款浏览器的主页配置信息。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZq2xhIxFaEXKXV9bibp5FXiceHSYjtPxUdIHyZTJic4ZyibJTia25D1agZ0A/0?wx_fmt=png" style="width: 738px !important; height: 547.741px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">pdb：</span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZWpZ2XxIr6xPm5m9CibA5OUDYKD1wbA8yHWUpjW9jHicFp0XiaoB6ffR1Q/0?wx_fmt=png" style="width: 610px !important; height: 29px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">4）与C&amp;C进行通信，10分钟上报一次状态信息（系统版本，杀软情况等）。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZk6XIjrFGnIiaRoNicq7mSvukPw4DAkiasWQ6j7RqWsSkPwC2Ujz9jJhog/0?wx_fmt=png" style="width: 689px !important; height: 508px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><strong><span style="font-size: 15px; color: rgb(63, 63, 63);">3. spoolsv.exe （printfll264.dll）行为</span></strong></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">该插件下载成功率较低，主要功能是刷流量、后台点广告、推广安装软件等。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1）printfll264.dll内置两个模块(printfll264_1,printfll264_2)会注入到傀儡进程中。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">修改注册表,设置svchost.exe和rundll32.exe进程使用的ie内核版本，后继会用到这傀儡进程模拟浏览器来刷流量。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZrY83q4kvmV8riabUZ8AptHwNoIJgAicKHEoWZPdRLOFtibf6RWEzYkk1Q/0?wx_fmt=png" style="width: 738px !important; height: 536.882px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2）创建一个32位的svchost.exe傀儡进程，将数据段中的printfll264_1注入到该进程中执行，以下我们将该PE文件命名为DevData.exe</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZ8Dzj6Rt7EY6bgFKHKN0uSMPNFLCJo2r31FWnyUJdiaVBibEOzHyZwRMw/0?wx_fmt=png" style="width: 738px !important; height: 479.785px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">DevData.exe的pdb如下： </span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZoO8qlTs4XicoYjSsbkVLpNwE3uUXSHQ06nPMg7DbEQJGwyCPHHlhc0w/0?wx_fmt=png" style="width: 738px !important; height: 33.3046px !important;"><br></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">其功能为点广告、刷流量。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">3）通过UDP连接服务器，返回刷流量的url列表，然后通过模拟浏览器，访问指定的网站刷流量。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZ7m83E7JcYLhGlsNGdAPNOVC27iaGkw4BBnE8yuKjiadXZHKQY8AuJ3Bg/0?wx_fmt=png" style="width: 719px !important; height: 1259px !important;"></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">4）发现刷的网站都是一些自媒体的专辑视频，点击量很高，但是点赞和评论量为0，明显是刷出来的访问量。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZXwwk7Hat0ZQVlPTVbH9uxczUCCZ1TmaYnzFiaYfic9dNrFtoZqgvYjIg/0?wx_fmt=png" style="width: 738px !important; height: 386.896px !important;"> <br> </p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">刷流量的链接：<em><span style="color: rgb(63, 63, 63); font-size: 14px;">http://bowl.jumu8.com/t/bowl.html</span></em> 跳转到</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 14px;"><em><span style="color: rgb(63, 63, 63);">http://my.tv.sohu.com/pl/9123507/87376056.shtml</span></em></span><span style="font-size: 15px; color: rgb(63, 63, 63);">，中间有一层跳转，方便了作者统计流量。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZqoXkIciaHct5lib6EW6GqDKhIMoWaPYtnKibweIUtnFMkSBKiaaSvflKqg/0?wx_fmt=png" style="width: 738px !important; height: 357.069px !important;"><br></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">◆ <strong><span style="color: rgb(63, 63, 63); font-size: 16px;">五、中毒判断</span></strong></span></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><strong><span style="color: rgb(63, 63, 63); font-size: 16px;"><br></span></strong></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1. 检查电脑以下目录是否存在.wav文件。</span></p><ul style="list-style-type: disc;" class=" list-paddingleft-2"><li><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><em><span style="color: rgb(63, 63, 63); font-size: 14px;">C:\Windows\System32\config\systemprofile\AppData\Local\Microsoft\Media</span></em></p></li><li><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><em><span style="color: rgb(63, 63, 63); font-size: 14px;">C:\Users\用户名\AppData\Local\Microsoft\Media</span></em></p></li></ul><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2. 检查是否存在<em><span style="color: rgb(63, 63, 63); font-size: 14px;">C:\windwos\system32\usbsapi.dll</span></em>文件。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">3. 注册表存在以下键值，说明已感染</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 14px;"><em><span style="color: rgb(63, 63, 63);">HKEY_LOCAL_MACHINE\ Software\Classes\CLSID\{FC70EFDD-2741-495C-9A93-42408F6878D9}\ex 值：1</span></em></span></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 14px;"><em><span style="color: rgb(63, 63, 63);"><br></span></em></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">◆ <span style="color: rgb(63, 63, 63); font-size: 16px;"><strong>六、查杀及安全建议</strong></span></span></p><p style="margin: 5px 1em; text-align: left; letter-spacing: 1px; line-height: normal;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><span style="color: rgb(63, 63, 63); font-size: 16px;"><strong><br></strong></span></span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1. 尽量不要通过下载站下载软件，如果一定要用到高速下载器，安装时记得去掉不需要的推荐软件。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2. 由于该木马文件有数字签名，且被大多数安全软件默认为信任，因此多数安全厂商还无法查杀该木马。目前电脑管家已经能够查杀该VBR木马，发现电脑有异常的用户可下载电脑管家进行清理。</span></p><p style="margin: 20px 1em; text-align: left; letter-spacing: 1px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FTyvSKWacHOicuhRuJopUTZJHB6c36OWEHo6y5OknKPicEicNHbNSric4vHKmvUuPcMMpA9zicEISpblQ/0?wx_fmt=png" style="width: 738px !important; height: 356.629px !important;"><br></p><p><br></p><section label="Copyright © 2014 playhudong All Rights Reserved." style="border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-style: none; margin: 5px 0px 0px; padding: 10px 0px; background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8G9B6YFlthnv1h3cWDDXGAmK9wQfy6pod114tTuOSIFVeVd0vd1PEwicksgBGmxL0iaC0icX7B9EQzNg/640?wx_fmt=png" style="margin: 0px auto; display: block; visibility: visible !important; width: 160px !important; height: 8.44575px !important;"></section><p class=""><br></p><p style="letter-spacing: 1px; margin: 15px 1em; text-align: center; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">本文由腾讯电脑管家原创，转载请注明来自看雪社区</span></p><p style="text-align: center;"><br></p><p style="text-align: left;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HFWP586ic3Pf4F6hD1rnmHpScQgCs4x9dJWoHHNnoiamW5RMTq8alBq5UiahM3G1W9TK3RPXQHXWZUQ/640?wx_fmt=jpeg" style="visibility: visible !important; width: 770px !important; height: 381.992px !important;"></p><p style="text-align: center;"><br></p><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 16px; color: rgb(63, 63, 63);">热门阅读</span></p><ul style="list-style-type: disc;" class=" list-paddingleft-2"><li><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284204&amp;idx=1&amp;sn=1f45d8c97686ee0f2403163959a80ff6&amp;chksm=b181402686f6c930101c1e214ebe45db3ed65f9ba0906b2885f4a23e29f56676687df90f8d41&amp;scene=21#wechat_redirect" target="_blank"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(63, 63, 63); font-size: 15px;"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283175&amp;idx=1&amp;sn=c799c0b1773dea71c74457c446cb2c59&amp;chksm=b1815c2d86f6d53b6e6722395e4d3d4cfdd2af00131e0462b3a19767bf4e271dd8ead5c8e35b&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">选择看雪企业 SRC 的 5 大理由</a></span></p></li><li><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284204&amp;idx=1&amp;sn=1f45d8c97686ee0f2403163959a80ff6&amp;chksm=b181402686f6c930101c1e214ebe45db3ed65f9ba0906b2885f4a23e29f56676687df90f8d41&amp;scene=21#wechat_redirect" target="_blank"></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284080&amp;idx=1&amp;sn=5eaa43c57cecd289401b3ae0a17cd049&amp;chksm=b18140ba86f6c9acad02a8bd902c439e0a72602fe84f915d46c724e01c3337924129758d014d&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline; font-size: 15px;"><span style="font-size: 15px;">议题征集 | 2017 安全开发者峰会</span></a></span></p></li><li><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284204&amp;idx=1&amp;sn=1f45d8c97686ee0f2403163959a80ff6&amp;chksm=b181402686f6c930101c1e214ebe45db3ed65f9ba0906b2885f4a23e29f56676687df90f8d41&amp;scene=21#wechat_redirect" target="_blank"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284204&amp;idx=1&amp;sn=1f45d8c97686ee0f2403163959a80ff6&amp;chksm=b181402686f6c930101c1e214ebe45db3ed65f9ba0906b2885f4a23e29f56676687df90f8d41&amp;scene=21#wechat_redirect" target="_blank">浅谈macRansom</a></span></p></li><li><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284229&amp;idx=2&amp;sn=61720f3a096b2e759adbdea8a96a189a&amp;chksm=b181404f86f6c959c89c32d3cc35be7546e0619e6f5ee61aec9dd1472daec95fb997d5c5e332&amp;scene=21#wechat_redirect" target="_blank">一个lpk.dll病毒的分析报告</a></span></p></li><li><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284116&amp;idx=1&amp;sn=4ae9de8a41b6a92b9b1cda29129733c6&amp;chksm=b18140de86f6c9c86f058016383461ba1f7c517bb3cdb306544b9a26fb579f6ce730809dbfc2&amp;scene=21#wechat_redirect" target="_blank">【暴雷漏洞】CVE-2012-1889 个人漏洞分析报告</a></span></p></li><li><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284102&amp;idx=1&amp;sn=881ed6e337462737148a5e905795ca13&amp;chksm=b18140cc86f6c9da359d9cd53a806d4ce3e2e4fe9daff7445cf1e34b612a40c73b27690f1cbe&amp;scene=21#wechat_redirect" target="_blank">Safengine Shielden 2.3.8.0 脱壳 ∷之∷ 修复IAT</a></span></p></li></ul><p style="text-align: center;"><br></p><p style="text-align: center;"><span style="font-size: 15px; background-color: rgb(178, 178, 178); color: rgb(63, 63, 63);">点击阅读原文/read，还有更多干货等着你~</span></p><p><br></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1502116456&src=3&ver=1&signature=fMd4ZeYncDjRuvdiU8EiAqzwJV-51HguOx4pnyGlqXjJ10eFEeoZU*4ykBfJ5DfCcbB*9QgBsAKzwmoYzWJII-UCUQe91DIDs-kmMMgnLkCOlMS33rhZSdCbuQgMgXCijXU1ZoKJvHIHk6YxsVdXM48oQJ*xE2a4exR7PoJvNNs=">微信地址</a> | <a href="http://bbs.pediy.com/thread-219751.htm">阅读原文</a>
{% endraw  %}

