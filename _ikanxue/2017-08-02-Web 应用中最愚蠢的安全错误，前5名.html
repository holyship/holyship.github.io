---
title: Web 应用中最愚蠢的安全错误，前5名
author: rainbow
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1502116456&src=3&ver=1&signature=fMd4ZeYncDjRuvdiU8EiAqzwJV-51HguOx4pnyGlqXjJ10eFEeoZU*4ykBfJ5DfCcbB*9QgBsAKzwmoYzWJII3ZAH6epc4p6P8E7MEGPNa8LbbCJOaWTaJKhB4-fjOcX9kvmsv5nn2yF5K0q69Kv5AJ1b*AhrROSKGQTET66ckU=
date: '2017-08-02 00:00:00 +0000'

---

{% raw  %}
<section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><section class="" style="font-size: 15px; letter-spacing: 2px; padding: 0px 2px; box-sizing: border-box;"><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;">在这个博客文章中，我将总结一些在过去5年中一直影响许多网络项目的常见的被忽视的问题。所有这些问题都是显而易见的，绝对可以预测的，可以被脚本小子、全自动扫描器和内部安全检查利用到。来看看吧！</p><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><br style="box-sizing: border-box;"></p></section></section></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><p style="margin: 15px auto; text-align: center; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H6fwTkj8lOZOy21RkLfu0JTck2ytyqlkvaCZGN2A8giaRlIqn3sTa4rT1629kZXxaCW6fvXYKM0Sw/0?wx_fmt=png" style="max-width: 100%; border-radius: 0px 3.8em; box-sizing: border-box; width: 429px !important; height: 175px !important;"></p></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: left;"><section class="" style="padding: 0px 1px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); letter-spacing: 1px; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);">1. Apache到Nginx迁移配置文件的公开</p></section><p><br></p></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><section class="" style="font-size: 15px; letter-spacing: 2px; padding: 0px 2px; box-sizing: border-box;"><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;">别忘了.htaccess和.htpasswd文件不能被Nginx使用。因此，可以通过HTTP请求检索其内容，比如这样：</p><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><span style="font-size: 12px;"><em>http://i-moved-from-apache-to-nginx.com/.htpasswd</em></span></p><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><span style="font-size: 12px;"><em><br></em></span></p></section></section></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><p style="margin: 15px auto; text-align: center; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8H6fwTkj8lOZOy21RkLfu0JSick7qmC2Ee7groW7EkkkEXbH23rTAlY04s5Jm3y4m2APODym8tzLmw/0?wx_fmt=jpeg" style="max-width: 100%; border-radius: 0px 3.8em; box-sizing: border-box; width: 612px !important; height: 408px !important;"></p></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: left;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);">2. CDN实现源代码公开</p></section><p><br></p></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><section class="" style="font-size: 15px; letter-spacing: 2px; padding: 0px 2px; box-sizing: border-box;"><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;">开始使用CDN的最简单方法是将所有文件从Web服务器复制到CDN。在这种情况下，您不应该忘记，CDN本质上是静态内容服务器，所有的应用程序代码都可以访问，包括图像和其他资源，如下所示：</p><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><span style="font-size: 12px;"><em>http://i-started-to-use-CDN.COM/index.php</em></span></p><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;">&nbsp;</p></section></section></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><p style="margin: 15px auto; text-align: center; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8H6fwTkj8lOZOy21RkLfu0JQk8zpfpxKGPaFrNSsFPqiacqx2JSZa4hIT385sELSzFL4RDiaQGhVedw/0?wx_fmt=jpeg" style="max-width: 100%; border-radius: 0px 3.8em; box-sizing: border-box; width: 612px !important; height: 409px !important;"></p></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: left;"><section class="" style="padding: 0px 2px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); letter-spacing: 2px; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);">3. 使用X-Forwarded-For，X-Real-IP和其他消息头绕过基于主机的身份验证。</p></section><p><br></p></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><section class="" style="font-size: 15px; letter-spacing: 2px; padding: 0px 2px; box-sizing: border-box;"><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;">不要忘记HTTP请求中的所有消息头都来自于攻击者。如果要检查请求的来源是属于Intranet或localhost的，请仔细检查您正在使用的来源。这个简单的curl命令可以提供帮助：&nbsp;</p><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><span style="font-size: 12px;"><em>curl -X'X-Forwarded-For：127.0.0.1'http://i-protected-by-host-based-auth.com/</em></span></p><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><span style="font-size: 12px;"><em><br></em></span></p></section></section></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><p style="margin: 15px auto; text-align: center; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8H6fwTkj8lOZOy21RkLfu0JG6ibebfCicnXqib6W669CXSm3iaibzveIVTg9b5gh8Zy6tTQZBAsTPticrSA/0?wx_fmt=jpeg" style="max-width: 100%; border-radius: 0px 3.8em; box-sizing: border-box; width: 612px !important; height: 428px !important;"></p></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: left;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);">4. 虚拟主机滥用</p></section><p><br></p></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><section class="" style="font-size: 15px; letter-spacing: 2px; padding: 0px 2px; box-sizing: border-box;"><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;">我之前提到过，所有的HTTP请求都来自于攻击者，因此不可能信任HTTP请求中的任何内容。HOS消息头也不例外。如果您的负载平衡器端有一台个staging.company.com虚拟主机，请相信我，即使您的DNS配置中没有CNAME记录，攻击者也会发现并利用此主机。这个简单的命令可以帮助识别这个问题：<em><span style="font-size: 12px;">curl -X'HOST：staging.intranet'http：// i-like-virt-hosts /</span></em></p></section></section></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><p style="margin: 15px auto; text-align: center; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8H6fwTkj8lOZOy21RkLfu0JJ32bypI2fGaF9pqALicyLtxYDiceRwwF9FkJFY2GBQWTYDZlic8zq14Rw/0?wx_fmt=jpeg" style="max-width: 100%; border-radius: 0px 3.8em; box-sizing: border-box; width: 612px !important; height: 408px !important;"></p></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: left;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);">5、通过不安全的 crossdomain.xml 进行跨站脚本攻击。</p></section><p><br></p></section><section class="Powered-by-XIUMI V5" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><section class="" style="font-size: 15px; letter-spacing: 2px; padding: 0px 2px; box-sizing: border-box;"><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;">许多Web项目在此配置文件中仍然存在问题。这样一来，攻击者就可以通过使用受害者的会话操作易受攻击的资源，与XSS漏洞一样。请仔细检查所有crossdomain.xml文件的通配符域，如下所示：</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H6fwTkj8lOZOy21RkLfu0Jslfx9l2iccB2ULRvw64g8OngL0gnEhXHse82sLvrg6cMiayFsq3jA3dA/0?wx_fmt=png" style="width: 695px !important; height: 77px !important;"></p><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;">这五个错误清单只是我基于Wallarm在过去5年收集的统计数据所创建的自己的列表。我希望这是一个有用的阅读，不要忘记自动化所有的这些检查，因为安全意味着持续的防御。请享用！</p><p style="margin: 15px 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); line-height: 1.75em;"><br></p><section label="Copyright © 2014 playhudong All Rights Reserved." style="border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-style: none; margin: 5px 0px 0px; padding: 10px 0px; background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8G9B6YFlthnv1h3cWDDXGAmK9wQfy6pod114tTuOSIFVeVd0vd1PEwicksgBGmxL0iaC0icX7B9EQzNg/640?wx_fmt=png" style="margin: 0px auto; display: block; visibility: visible !important; width: 160px !important; height: 8.44575px !important;"></section><p class=""><br></p><p style="letter-spacing: 1px; margin: 15px 1em; text-align: center; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">本文由看雪翻译小组 rainbow 原创，转载请注明来自看雪社区</span></p><p style="text-align: center;"><br></p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HFWP586ic3Pf4F6hD1rnmHpScQgCs4x9dJWoHHNnoiamW5RMTq8alBq5UiahM3G1W9TK3RPXQHXWZUQ/640?wx_fmt=jpeg" style="visibility: visible !important; width: 766px !important; height: 380.008px !important;"></p><p style="text-align: center;"><br></p><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 16px; color: rgb(63, 63, 63);">热门阅读</span></p><ul style="list-style-type: disc;" class=" list-paddingleft-2"><li><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284266&amp;idx=1&amp;sn=4e3714835ada031a3ae3c86e44753194&amp;chksm=b181406086f6c97636d7e05ef95256655b529267c0e9702d6e6f8848c2357ad5626d079a9ad1&amp;scene=21#wechat_redirect" target="_blank">使用x64dbg+VS2015 Spy++去除广告弹框</a><br></span></p></li><li><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284236&amp;idx=1&amp;sn=2b9e3b3cc4de69e91d5572a8961f572b&amp;chksm=b181404686f6c95030550e3e20f16a3923c719671b14d00391cc8879b944f9840bfac6c8139d&amp;scene=21#wechat_redirect" target="_blank">从 Android 源码看 SO 的加载</a></span></p></li><li><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284229&amp;idx=2&amp;sn=61720f3a096b2e759adbdea8a96a189a&amp;chksm=b181404f86f6c959c89c32d3cc35be7546e0619e6f5ee61aec9dd1472daec95fb997d5c5e332&amp;scene=21#wechat_redirect" target="_blank">一个lpk.dll病毒的分析报告</a></span></p></li><li><p style="letter-spacing: 1px; margin: 15px 1em; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284255&amp;idx=1&amp;sn=a07808a74f61d543163a309214775b46&amp;chksm=b181405586f6c9438606b0c36e56e0c41b5b089e587b9dd991f59fffe72558259a752ddf981d&amp;scene=21#wechat_redirect" target="_blank">虚拟机保护技术浅谈</a><br></span></p></li></ul><p style="text-align: center;"><br></p><p style="text-align: center;"><span style="font-size: 15px; background-color: rgb(178, 178, 178); color: rgb(63, 63, 63);">点击阅读原文/read，还有更多干货等着你~</span></p><p><br></p><p><br></p></section></section></section></section><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1502116456&src=3&ver=1&signature=fMd4ZeYncDjRuvdiU8EiAqzwJV-51HguOx4pnyGlqXjJ10eFEeoZU*4ykBfJ5DfCcbB*9QgBsAKzwmoYzWJII3ZAH6epc4p6P8E7MEGPNa8LbbCJOaWTaJKhB4-fjOcX9kvmsv5nn2yF5K0q69Kv5AJ1b*AhrROSKGQTET66ckU=">微信地址</a> | <a href="http://bbs.pediy.com/thread-219996.htm">阅读原文</a>
{% endraw  %}

