---
title: 看雪.WiFi万能钥匙 CTF 2017第十五题 点评及解题思路
author: 看雪学院
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1499131012&src=3&ver=1&signature=iU4hCwtQzyv2pey6SDTnZ62YXf1MWi8Zh8usUjq2T6Tp8olMm-6I1I4qsl-rYUzkEslKlH6cxolxoLxftDKuPvgdNnLHIR8LTF2*Be9VTK*tiiBekJmsTwSfr3p3vgy5O8DQzkuB6gtbaHl5PTiFws2CA-umU46XdH7ljXJZf8s=
date: '2017-07-01 00:00:00 +0000'

---

{% raw  %}
<section style="max-width: 100%; box-sizing: border-box; color: rgb(62, 62, 62); font-size: 16px; line-height: 25.6px; white-space: normal; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin-top: 30px; margin-bottom: 20px; max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); text-align: center; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="padding: 5px; max-width: 100%; box-sizing: border-box; display: inline-block; width: 603px; vertical-align: top; border: 0px none rgb(62, 62, 62); border-radius: 5px; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(223, 241, 238);"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="padding: 10px; max-width: 100%; box-sizing: border-box; display: inline-block; width: 593px; vertical-align: top; border: 1px dashed rgb(74, 179, 172); border-radius: 5px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="padding-right: 10px; padding-left: 10px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(45, 66, 87); line-height: 1.8; word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important; overflow-wrap: break-word !important;">看雪CTF 2017 比赛进行至第十五题</p><section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">截止至今天中午12点，第十五题破解人数为 9 人！</p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">防守方 hsadkhk 依然位居首位~</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EticGm5d1vOCicZah5hZxwroyGvfLm0C7pdkQyZqP5vORCvZJJ9otTpT6XrGJ5lic2iclEhNkqibvacvQ/0?wx_fmt=png" style="width: 350px !important; height: 537px !important; visibility: visible !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="line-height: 1.8;">今天是最后一题，攻击方风间仁处于第一位~，kkHAIKE位列第二位。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EticGm5d1vOCicZah5hZxwroPpibfX67mrp9fGRrQicxQ27RzGQeIX2ukl7ZDpJHUwRVNLoYFKpzUs6w/0?wx_fmt=png" style="width: 331px !important; height: 393px !important;"></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;">比赛至此告一段落了，<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></p>比赛的最终结果，请大家持续关注！<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">接下来我们来回顾一下第十五题</p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">看看 看雪评委和出题者是怎么说的ヾ(๑╹◡╹)ﾉ"。</p></section></section></section></section></section></section></section></section></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"></p></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; width: 670px; vertical-align: top; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; color: rgb(247, 247, 247); font-size: 18px; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(51, 59, 108);"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;">看雪评委 netwind 点评</span></p></section><section style="max-width: 100%; box-sizing: border-box; border-top-width: 2px; border-top-style: dotted; border-top-color: rgb(202, 198, 198); width: 191.688px; word-wrap: break-word !important; overflow-wrap: break-word !important;"></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; line-height: 1.8; word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box; letter-spacing: 0px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; box-sizing: border-box; min-height: 1em; line-height: 1.75em; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; letter-spacing: 0px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">题目中的VM是作者设计的一个全新的VM，体积虽小，五脏俱全。VM功能包括反调试、反虚拟机、反 API 断点、导入表保护、OEP 抽取，代码虚拟化、代码乱序、代码拆分、代码混淆；攻方需了解vm的基本知识，识别出各条handler，然后根据各handler序列分析出整个流程；作者同时采用lua脚本来进行代码保护，攻方还需掌握lua反编译知识；在算法上采用了简单的异或算法。此题重在考察选手VM分析能力和LUA反编译能力。<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></p></section></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; width: 670px; vertical-align: top; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; color: rgb(247, 247, 247); font-size: 18px; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(51, 59, 108);"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">作者简介</strong></p></section><section style="max-width: 100%; box-sizing: border-box; border-top-width: 2px; border-top-style: dotted; border-top-color: rgb(202, 198, 198); width: 82px; word-wrap: break-word !important; overflow-wrap: break-word !important;"></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="letter-spacing: 0px; line-height: 1.75em; color: rgb(51, 59, 108); font-size: 15px; text-align: justify;">demoscene，反病毒工程师，反外挂工程师。</span><br></p><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="letter-spacing: 0px; line-height: 1.75em; color: rgb(51, 59, 108); font-size: 15px; text-align: justify;"><br></span></p></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; width: 670px; vertical-align: top; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; color: rgb(247, 247, 247); font-size: 18px; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(51, 59, 108);"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="font-size: 16px;"><strong>看雪 CTF 2017 第十五题设计思路</strong></span></p></section><section style="max-width: 100%; box-sizing: border-box; border-top-width: 2px; border-top-style: dotted; border-top-color: rgb(202, 198, 198); width: 255.703px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px;"><strong>一、设计思路</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">一个专业实用的保护系统应该不仅能防 keygen 还应该能防爆破防代码分析</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">纵观当前市面上最好的几款保护，使用的技术皆为 RSA 算法+代码虚拟化保护，这是当前最流行，最强的软件保护技术。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; line-height: 1.75em;">题目设计主要考察分析vm的能力，所以不使用复杂的算法，只进行了简单的异或。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">根据去年CTF时各位大牛写的分析文章，对VM的弱点进行了修补，增强了VM的强度。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; line-height: 1.75em;">吸收去年CTF其它守护方的设计思路，结合lua脚本，实现双虚拟机保护。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><strong><span style="font-size: 16px;">二、设计亮点</span></strong></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; line-height: 1.75em;">1、一个体积虽小，五脏俱全的新VM，非市面上已经被N多人分析过的VM，需要攻击者重新分析，考察分析VM的基本功。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; line-height: 1.75em;">vm实现的功能：反调试、反虚拟机、反 API 断点、导入表保护、OEP 抽取，代码虚拟化、代码乱序、代码拆分、代码混淆。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2、结合 lua 脚本，使用自写虚拟机+lua虚拟机，实现双虚拟机保护。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;考察攻击者的 lua 反编译知识。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">3、不用使复杂算法，避免算法分析。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px;"><strong>三、破解思路</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">1、由于本题只是对输入进行了简单的异或判断，所以无需费力气分析算法，只要把 vm 流程，各个 handler 分析清楚，找到异或的 key 即可。目前壳处理的指令还比较少，混淆模式也比较简单，所以要理清楚并不难，只是由于大家都第一次接触到此 VM，所以可能需要花点时间。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2、本题算法较简单，主要难点在分析VM和反编译lua脚本上</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">3、分析vm要求大家了解vm的基本知识，vm的整体框架，流程，然后区分出花掉令和正常的指令，去掉花指令，保留正常指令，识别出各条handler，然后根据各handler序列分析出整个流程</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">4、反编译lua需要找到lua字节码并保存下来，然后使用网上的方法，进行反编译，这里的难点在于找到 lua_loadbuffer的地址，在此函数里把字节码dump下来即可</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px;"><strong>四、其它说明</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">1、CrackMe使用vs2008编译，已在xp，win7 32、 win7 64系统上测试功能正常</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2、CrackMe使用自己实现的虚拟机BBProtect加密，之前未曾发在网上，复合题目要求</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">3、BBProtect 程序在已放到 BBProtect目录里</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">4、由于加了vm，所以杀软软件可能会报毒，cm没有任何恶意功能，可放心运行</span></p></section></section></section></section></section><p><br></p><section class="" style="max-width: 100%; box-sizing: border-box; color: rgb(62, 62, 62); font-size: 16px; line-height: 25.6px; white-space: normal; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; color: rgb(247, 247, 247); font-size: 18px; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(51, 59, 108);"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important; overflow-wrap: break-word !important;">下面选取攻击者 loudy 的破解分析<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></p></section><section style="max-width: 100%; box-sizing: border-box; border-top-width: 2px; border-top-style: dotted; border-top-color: rgb(202, 198, 198); width: 309.719px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br></section></section></section></section><p><span style="font-size: 15px; line-height: 1.75em;">使用工具：</span><span style="font-size: 15px; line-height: 1.75em;">IDA6.8</span><span style="font-size: 15px; line-height: 1.75em;">（反汇编分析）&nbsp;</span><span style="font-size: 15px; line-height: 1.75em;">python</span><span style="font-size: 15px; line-height: 1.75em;">（编程解码）&nbsp;</span><span style="font-size: 15px; line-height: 1.75em;">OD</span><span style="font-size: 15px; line-height: 1.75em;">（动态调试）</span><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">步&nbsp;&nbsp;&nbsp;&nbsp;骤：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px; color: rgb(255, 251, 0); background-color: rgb(0, 0, 0);"><strong>一、定位关键代码</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">该程序有加壳，但对主要流程影响不大，难点在于分析luajit代码，定位主要流程。只要流程清晰了，该题没有难度，只是简单异或运算。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">（1）脱壳</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">其实也不算真正脱壳，其实就是等程序运行起来后，dump内存镜像。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">这样在IDA中可以分析解密后的函数和解密后的字符串，如下图</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">（2）定位关键点</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">从IDA的字符串窗口可以看到该程序使用了LuaJIT 2.1.0-beta3&nbsp;且Lua版本号为Lua 5.1。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">通过“main”（调用Lua的main函数）关键字在IDA中定位到如下位置。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">其上面从0040103D开始的一大段mov指令实际是在栈中生成了一个luajit的bytecode。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px; color: rgb(255, 251, 0); background-color: rgb(0, 0, 0);"><strong>二、解密</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">通过OD动态加载后，通过识别luajit文件头{0x1b，0x4c，0x4a}提取出该文件。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">接下来Google找到luajit-decomp项目源码和LuaJIT-2.1.0-beta3源码，编译luajit，替换luajit-decomp中的对应文件，对提取出的luajit反编译，得到如下结果。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EticGm5d1vOCicZah5hZxwro3kPWIZTpicib2nnPDyia3TH36zuiczzhTWm2PukHR7E4uvKtopRRCFOFgA/0?wx_fmt=png" style="width: 770px !important; height: 620.756px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EticGm5d1vOCicZah5hZxwroG4jOUTdJ1tSao1ZuO7TzWS2EicRlXibMrnAsaVjQxvLyzldFHRpKrQsA/0?wx_fmt=png" style="width: 770px !important; height: 548.482px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EticGm5d1vOCicZah5hZxwro4aotq3m3guZUniaJCv4AW6jGCL10RnQgb2icRSD2NdkGuaIfnfKlpU2Q/0?wx_fmt=png" style="width: 770px !important; height: 121.665px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我们主要关注其中的main函数，上面已经用c语法注释出来。其实就是对输入分别与下面这一串异或，返回结果。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">[112,101,100,105,121,49,50,51,52,53,54,55]</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">接下来0040222C处的代码取得lua输出的每一个值分别与下面这一串值异或。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">[0x5,0x12,0xa,0x29,0x42,0x41,0x75,0x61,0x35,0x83,0x55,0x94]</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">接下来004022F0处，异或后的值分别与下面着串值比较，相等则注册成功。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">[0x18,0x16,0x1e,0x2f,0x48,0x11,0x21,0x37,0x33,0x86,0x52,0x94]</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">那么python编写如下代码，即可得到真正注册码“maposafe2017”。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EticGm5d1vOCicZah5hZxwrofhq46bKNbljxNvefYptNQZP1mNU0owTFePAicywjhib19ZT9TT6UtyMw/0?wx_fmt=png" style="width: 770px !important; height: 127.516px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">全文完，注册码“maposafe2017”。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><hr><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">最后感谢 WiFi 万能钥匙安全应急响应中心的赞助支持，</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; text-align: center; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">接下来的比赛大家一定要使出洪荒之力哦！↖(^ω^)↗</span><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">比心&nbsp;❤</span></p><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_gif/1UG7KPNHN8F7ckRiaZtp76v0KXiaibibdH9bfyDfqPrYWQibxej8Zzu0vKAC2JDuEkRHibZXWWfv0FzdCgYL0NZuQG7Q/0?wx_fmt=gif" style="box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; visibility: visible !important; width: 240px !important; height: 240px !important;"></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><br></p><section label="Copyright Reserved by PLAYHUDONG." style="margin-top: 1em; margin-bottom: 1em; max-width: 100%; border: 0px none currentcolor; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section style="margin-left: 1em; max-width: 100%; line-height: 1.4; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="padding: 0.2em 0.5em; max-width: 100%; border-radius: 0.3em; color: white; font-size: 1em; font-family: inherit; font-weight: inherit; text-align: inherit; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(102, 102, 102);">赞助商</span></section><section class="" style="margin-top: -0.7em; max-width: 100%; border: 1px solid rgb(192, 200, 209); border-radius: 0.4em; color: rgb(51, 51, 51); font-size: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section style="padding: 1.4em 1em 1em; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section style="max-width: 100%; font-size: 1em; font-family: inherit; font-weight: inherit; text-align: inherit; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">上海连尚网络科技有限公司成立于 2013 年，是一家专注于提供免费上网和内容服务的移动互联网企业。连尚网络自主研发的核心产品 WiFi 万能钥匙，以分享经济的模式，通过云计算和大数据技术，利用热点主人分享的闲置WiFi资源，为用户提供免费、稳定、安全的上网服务，以帮助更多的人上网，找到属于他们的机会，改变自己的命运。</span></p></section></section></section></section><p><br></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><hr style="max-width: 100%; line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282630&amp;idx=1&amp;sn=61fcbc708235dec5d7897a0d7c315756&amp;chksm=b1815a0c86f6d31a50ba1f9a39d876e28f2c71096100b28e961df185f7be94ec77b9199efd51&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">等你来挑战！| 看雪 CTF 2017 攻击篇</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283817&amp;idx=1&amp;sn=f4549d3b36638ce6a7ffcb6a7250808a&amp;chksm=b1815fa386f6d6b5e6f41fdcf44c36b6fa45cbb8df30fec8bf08f6d32556997991c9c34f3602&amp;scene=21#wechat_redirect" target="_blank">看雪.WiFi万能钥匙 CTF 2017第十四题 点评及解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283781&amp;idx=1&amp;sn=86f0f91593cf909d956dfae52c6cd3b1&amp;chksm=b1815f8f86f6d69924b655c6f6070e14d7f2fef695ff1caf4b1e83b00ab36370e196dafa364c&amp;scene=21#wechat_redirect" target="_blank">看雪.WiFi万能钥匙 CTF 2017第十三题 点评及解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283759&amp;idx=1&amp;sn=c27021ae0bfd4414464e6630be2588d1&amp;chksm=b1815e6586f6d773955d1ae620cb1945a431eff773e0cab42ef59d783a6d32304911916254c0&amp;scene=21#wechat_redirect" target="_blank">看雪.WiFi万能钥匙 CTF 2017第十二题 点评及解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283725&amp;idx=1&amp;sn=4c981e3c7f97db095c8b6375c938d4e6&amp;chksm=b1815e4786f6d751d435081c8d6d41902d9cad656d0a2514435fe418ed05cf1e89f541e4fe58&amp;scene=21#wechat_redirect" target="_blank">看雪.WiFi万能钥匙 CTF 2017第十一题 点评及解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283714&amp;idx=2&amp;sn=6860ed543d45ce46c143d62479275880&amp;chksm=b1815e4886f6d75e9c39979e6d6d5cf956fd83d00cfca6e176ca33a6b3c795d711efe4d288df&amp;scene=21#wechat_redirect" target="_blank">看雪.WiFi万能钥匙 CTF 2017第十题 点评及解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">更多比赛详情，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170); box-sizing: border-box !important; word-wrap: break-word !important;">关注看雪学院公众号</span>”查看！</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8F7ckRiaZtp76v0KXiaibibdH9bCfZtDdhqeqbk5LToic1TlqZZJ05wLxqexpbloufvSCKbUEPbEtFUzzQ/640?wx_fmt=jpeg" style="box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; visibility: visible !important; width: 640px !important; height: 427px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">看雪论坛：http://bbs.pediy.com/</span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">商务合作<span style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span>：<span style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">wsc@kanxue.com</span></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><br></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><br></p><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; width: 100.5px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin-top: 10px; max-width: 100%; box-sizing: border-box; text-align: center; transform: translate3d(0px, 0px, 0px); font-size: 11.2px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="padding: 4px; max-width: 100%; box-sizing: border-box; display: inline-block; font-size: 11.2px; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(211, 0, 0);"><section class="" style="max-width: 100%; box-sizing: border-box; border: 1px solid white; width: 1.6em; height: 1.6em; font-size: 16.8px; line-height: 1.5em; color: rgb(255, 255, 255); word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; font-size: 16.8px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">点</span></p></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; text-align: center; line-height: 0; overflow: hidden; transform: translate3d(0px, 0px, 0px); word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin: auto; max-width: 100%; box-sizing: border-box; width: 2px; height: 1em; word-wrap: break-word !important; overflow-wrap: break-word !important; background-color: rgb(211, 0, 0);"></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; width: 0px; border-top-width: 1em; border-top-style: solid; border-top-color: rgb(211, 0, 0); word-wrap: break-word !important; overflow-wrap: break-word !important; border-left-width: 0.5em !important; border-left-style: solid !important; border-left-color: transparent !important; border-right-width: 0.5em !important; border-right-style: solid !important; border-right-color: transparent !important;"><br></section></section></section></section></section></section></section><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1499131012&src=3&ver=1&signature=iU4hCwtQzyv2pey6SDTnZ62YXf1MWi8Zh8usUjq2T6Tp8olMm-6I1I4qsl-rYUzkEslKlH6cxolxoLxftDKuPvgdNnLHIR8LTF2*Be9VTK*tiiBekJmsTwSfr3p3vgy5O8DQzkuB6gtbaHl5PTiFws2CA-umU46XdH7ljXJZf8s=">微信地址</a> | <a href="http://ctf.pediy.com/">阅读原文</a>
{% endraw  %}

