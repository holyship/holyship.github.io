---
title: 看雪.WiFi万能钥匙 CTF 2017第十三题 点评及解题思路
author: 看雪学院
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1499131012&src=3&ver=1&signature=iU4hCwtQzyv2pey6SDTnZ62YXf1MWi8Zh8usUjq2T6Tp8olMm-6I1I4qsl-rYUzkEslKlH6cxolxoLxftDKuPkLyq5jzpH2tN2ZnjmxRooO5VLzrRdhnja7vgmXXSm-Oyqleaoa-WR06nBN3ltSZYNWGHC4TPP5MrMTv-58MwNw=
date: '2017-06-27 00:00:00 +0000'

---

{% raw  %}
<section style="max-width: 100%; box-sizing: border-box; background-color: rgb(255, 255, 255); overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="margin-top: 30px; margin-bottom: 20px; max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); text-align: center; overflow-wrap: break-word !important;"><section class="" style="padding: 5px; max-width: 100%; box-sizing: border-box; display: inline-block; width: 603px; vertical-align: top; background-color: rgb(223, 241, 238); border-width: 0px; border-radius: 5px; border-style: none; border-color: rgb(62, 62, 62); overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="padding: 10px; max-width: 100%; box-sizing: border-box; display: inline-block; width: 593px; vertical-align: top; border-style: dashed; border-width: 1px; border-radius: 5px; border-color: rgb(74, 179, 172); overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="margin-top: -35px; max-width: 100%; box-sizing: border-box; text-align: left; transform: translate3d(-30px, 0px, 0px); overflow-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EbL4Qw95bfyIM3rnNynl14PKicECpSXbJIiaNxIjMAGADPy74OuHSxkuYicb7Gkj5CDs1aL9o9jqA6A/640?wx_fmt=png" style="box-sizing: border-box; vertical-align: middle; overflow-wrap: break-word !important; visibility: visible !important; width: 85.6406px !important; height: auto !important;"></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="padding-right: 10px; padding-left: 10px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(45, 66, 87); line-height: 1.8; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; overflow-wrap: break-word !important;">看雪CTF 2017 比赛进行至第十三题</p><section style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><section style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><section style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><section style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;">截止至今天中午12点，第十三题破解人数为 2 人！</p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;">防守方 hsadkhk 依然位居首位~</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H4ektLy5peaBxicibXicW0ERMcFWZUwISedBpLHKErPicQCuHNd5Fr77lEuibS8jg5nhMIfCQFWNdiabQg/0?wx_fmt=png" style="width: 334px !important; height: 474px !important; visibility: visible !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;">此题过后，风间仁依然处于第一位~，kkHAIKE升至第二位。<br></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H4ektLy5peaBxicibXicW0ERMu0icuyF2rgo8VxEC83ZJBJibENTibEflnvPyKpuYcN4YcPVYInB9yk2ibA/0?wx_fmt=png" style="width: 312px !important; height: 387px !important;"></p><p>比赛进入尾声，仅剩 2 题。</p><p>对于比赛前几名的争夺战，将在前十名之间展开。<br></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;">期待ing......<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;">接下来我们来回顾一下第十三题</p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;">看看 看雪评委和出题者是怎么说的ヾ(๑╹◡╹)ﾉ"。</p></section></section></section></section></section></section></section></section></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"></p></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; width: 670px; vertical-align: top; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; overflow-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;">看雪评委 netwind 点评</span></p></section><section style="max-width: 100%; box-sizing: border-box; border-top: 2px dotted rgb(202, 198, 198); width: 191.688px; overflow-wrap: break-word !important;"></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; line-height: 1.8; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box; letter-spacing: 0px; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; box-sizing: border-box; min-height: 1em; line-height: 1.75em; overflow-wrap: break-word !important;"><span style="max-width: 100%; letter-spacing: 0px; box-sizing: border-box !important; overflow-wrap: break-word !important;">此题考查攻方选手对算法的分析能力。该题算法模型是：考虑一条有限域椭圆曲线上的已知点 G1, G2, 以及给定的系数 h1,h2,h3,求点S(x,y) 满足方程：h1( S + h3*G1) = h2(S + h3*G2)&nbsp; mod n，判断正确的key等价于判断方程两边运算的点的x坐标： 两个大数相等。如果对算法模型不熟悉，做起来可能会有一定难度。</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; box-sizing: border-box; min-height: 1em; line-height: 1.75em; overflow-wrap: break-word !important;"><span style="max-width: 100%; letter-spacing: 0px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></section></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; width: 670px; vertical-align: top; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; overflow-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">作者简介</strong></p></section><section style="max-width: 100%; box-sizing: border-box; border-top: 2px dotted rgb(202, 198, 198); width: 82px; overflow-wrap: break-word !important;"></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; line-height: 1.8; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box; letter-spacing: 0px; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></strong></p><span style="letter-spacing: 0px;">论坛ID为<strong>readyu</strong>，毕业于中国科学技术大学自动控制专业，从事软件开发多年。在软件保护技术、加密算法方面有一些体会。曾在北京多看科技从事电子阅读加密技术的研究，现在MIUI做系统与安全相关的工作。</span><br><span style="letter-spacing: 0px;"></span><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box; letter-spacing: 0px; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></section></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; width: 670px; vertical-align: top; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; overflow-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; overflow-wrap: break-word !important;">看雪 CTF 2017 第十二题设计思路</p></section><section style="max-width: 100%; box-sizing: border-box; border-top: 2px dotted rgb(202, 198, 198); width: 255.703px; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><p style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">根据规则，crackme 内部name固定。 SN唯一。<br>本题sn为：<br>7A7102F36F3B344D666132A6FF7EF4BA05B99640BB815C9E712A72C64B6ABC582C2<br><br>正确提示：<br>"Oh Yes! You got it.",<br><br><br><span style="font-size: 16px; text-decoration: underline;"><strong>设计思路</strong></span>：<br><br>（1）考虑一条有限域椭圆曲线上的已知点 G1, G2, 以及给定的系数 h1,h2,h3,求点S(x,y) 满足方程, 以下大写字母表示有限域椭圆曲线上的点， 小写字母表示数值：</p><p style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">h1( S + h3*G1) = h2(S + h3*G2)&nbsp;&nbsp; mod n</p><p style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">那么， 判断正确的key， 等价于判断方程两边运算的点的x坐标： 两个大数相等。</p><p style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">因此， 比较key，不会出现明文比较。这里S是可以计算的，并没有用到ECDLP（椭圆曲线离散对数）。</p><p style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">那么，如何求出S(x,y)：</p><p style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">=&gt; (h1 - h2) S = h2*h3*G2 - h1*h3*G1</p><p style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">S(x,y) = (h2*h3/(h1 - h2)) * G2-&nbsp; (h1*h3/(h1 - h2)) * G1&nbsp; mod n</p><p style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">sn = S(x,y) ， x,y is the point on the cuver ECC2K-130</p><p style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">椭圆曲线选取公开的ECC2K-130：</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">（参数取自如下pdf文档）<br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">http://www.ecc-challenge.info/anon.pdf</span></p><p style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">========<br>ECC2K-130&nbsp;&nbsp; GF(2^m)<br>========<br>E:&nbsp;&nbsp;&nbsp;&nbsp; y^2&nbsp; + xy =&nbsp;&nbsp; x^3 + a*x^2 + b&nbsp; <br><br>m = 131<br>f = x^131 + x^13 + x^2 + x + 1<br><br>a = 0<br>b = 1<br><br>E 即：&nbsp; y^2 + xy = x^3 + 1&nbsp; , over&nbsp; GF(2^131)<br><br>point P (G1)：<br>X= 51C99BFA6F18DE467C80C23B98C7994AA<br>Y= 42EA2D112ECEC71FCF7E000D7EFC978BD<br><br>Point Q (G2)：<br>X= 6C997F3E7F2C66A4A5D2FDA13756A37B1<br>Y= 4A38D11829D32D347BD0C0F584D546E9A<br><br>np (number of points) = 80000000000000001353F755C0E8FC9A4<br><br>n&nbsp; (prime order) = 200000000000000004D4FDD5703A3F269<br><br>（2） 补充细节的考虑 之一 关于hash。<br><br>为了使得h1, h2, h3 线性无关，并且与name, 和相关字符 关联起来， 这里取md5 hash作为系数。<br>h1 = hash1(0x1 name - pediy);<br>h2 = hash2(0x2 0x2 name - 2017);<br>h3 = hash3(0x3 0x3 0x3 name - crackme);<br>hash 采用md5<br><br>例如： name = readyu<br><br>readyu-pediy<br>hexstring= 017265616479752D7065646979<br>hash1=<br>51c75f1f444baa97ed18dd6c340835d7<br><br>readyu-2017<br>hexstring= 02027265616479752D32303137<br>hash2=<br>0e5cf7f068d6efa16f42f935ec424a75<br><br>readyu-crackme<br>hexstring= 0303037265616479752D637261636B6D65<br>hash3=<br>a4cd1d64486abde1be441944460cd41d<br><br>（3） <br><br>补充细节的考虑 之二 关于sn 编码。<br><br>采用一个素数P269， 把S（x,y） 用d加密编码。 结果就是sn。用到了费马小定理。<br>sn = S^d mod P<br><br>P269(prime)= 10000000000000000000000000000000000000000000000000000000000000000079<br><br>e=0x5<br><br>d= CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCD2D<br><br>这里有：<br>m^(P-1) = 1 (mod P)&nbsp;&nbsp;&nbsp;&nbsp;(m为自然数， P为素数，&nbsp; 1 &lt;= m &lt; P) 费马小定理<br>e*d = 1 &nbsp; （ mod&nbsp; (P-1) ）&nbsp;&nbsp; , 素数P的欧拉函数是P-1<br><br>=〉<br>(m^d)^e&nbsp; = m&nbsp; ( mod P)<br><br><br>（4） 答案：<br><br>计算hash：<br>readyu-pediy<br>017265616479752D7065646979<br>hash1 = 51c75f1f444baa97ed18dd6c340835d7<br><br>readyu-2017<br>02027265616479752D32303137<br>hash2 = 0e5cf7f068d6efa16f42f935ec424a75<br><br>readyu-crackme<br>0303037265616479752D637261636B6D65<br>hash3 = a4cd1d64486abde1be441944460cd41d<br><br>计算S(x,y)：<br>h1=51C75F1F444BAA97ED18DD6C340835D7<br>h2=0E5CF7F068D6EFA16F42F935EC424A75<br>h3=A4CD1D64486ABDE1BE441944460CD41D<br>G1(x,y)=(51C99BFA6F18DE467C80C23B98C7994AA , 42EA2D112ECEC71FCF7E000D7EFC978BD)<br>G2(x,y)=(6C997F3E7F2C66A4A5D2FDA13756A37B1 , 4A38D11829D32D347BD0C0F584D546E9A)<br><br>S(x,y) = (h2*h3/(h1 - h2)) * G2 - (h1*h3/(h1 - h2)) * G1&nbsp; mod Order</span></p><p style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">Order = 200000000000000004D4FDD5703A3F269</span></p><p style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">h1 - h2 = 436A672EDB74BAF67DD5E43</span></p></section></section></section></section></section><p><br></p><section class="" style="max-width: 100%; box-sizing: border-box; background-color: rgb(255, 255, 255); overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; overflow-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; overflow-wrap: break-word !important;">下面选取攻击者 <span class="" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">风间仁</span> 的破解分析</p></section><section style="max-width: 100%; box-sizing: border-box; border-top: 2px dotted rgb(202, 198, 198); width: 309.719px; overflow-wrap: break-word !important;"></section></section></section></section><p><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">1. 处理逻辑</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">name是内置的：readyu<br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">code 是输入的</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H4ektLy5peaBxicibXicW0ERMGEF1icOpCIicWjHjqrlomOBv1gBbsicficqJHT35rhzd5rbGGKmL9tTiaWw/0?wx_fmt=png" style="width: 770px !important; height: 428.328px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">z = 10000000000000000000000000000000000000000000000000000000000000000079</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">r = code ^ 5 mod z</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">r 有34字节, &nbsp;前17字节作为x, &nbsp;后17字节作为y</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">epInput = (x,y)</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">根据 name 计算 3 个 md5 值：</span></p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">md0=md5("\x01readyu-pediy")=51C75F1F444BAA97ED18DD6C340835D7</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">md1=md5("\x02\x02readyu-2017")=0E5CF7F068D6EFA16F42F935EC424A75</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">md2=md5("\x03\x03\x03readyu-crackme")=A4CD1D64486ABDE1BE441944460CD41D</span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">椭圆曲线：m=131, a=13, b=2, c=1, a2=0, a6=1</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">前面的 epInput 是这个曲线上的点</span></p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">ep1 = ( 51C99BFA6F18DE467C80C23B98C7994AA, 42EA2D112ECEC71FCF7E000D7EFC978BD )</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">ep2 = ( 6C997F3E7F2C66A4A5D2FDA13756A37B1, 4A38D11829D32D347BD0C0F584D546E9A )</span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">n = 200000000000000004D4FDD5703A3F269</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">校验 (md2 * ep1 + epInput) * md0 mod n == (md2 *ep2 + epInput) * md1 mod n</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H4ektLy5peaBxicibXicW0ERMDdXmn8zyqUpwu0I1I6LDHBhBiavaZG0wzCKmEm0ArH5HbgKETSibXGOw/0?wx_fmt=png" style="width: 770px !important; height: 2441.5px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2. 计算</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">(md2 * ep1 + epInput) * md0 mod n == (md2 *ep2 + epInput) * md1 mod n</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">=&gt; <br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">epInput = (md2 * md1 * ep2 - md2 * md0 * ep1) * (((md0 - md1) ^-1) mod n)</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">得到 ( 02D23461BA71B50AF182DC76E5A7C726F5, 07BE013AF19BD185BCD20BB341EA31298B )</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H4ektLy5peaBxicibXicW0ERMLyuXXWibxhZxiac3qFHgM8uZiaDzBLw3RK39I2LQb0B6XPzPVAib0dvdHg/0?wx_fmt=png" style="width: 770px !important; height: 815.784px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">用RDLP计算得到code</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H4ektLy5peaBxicibXicW0ERMJZn2toxickbjwjtgoW0qmBhbUDX13HzbegEN1mmsmP17V92CzyLicmuA/0?wx_fmt=png" style="width: 702px !important; height: 638px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">&gt;&gt;&gt; 7A7102F36F3B344D666132A6FF7EF4BA05B99640BB815C9E712A72C64B6ABC582C2</span></p><p style="text-indent: 28px;"><br></p><hr style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; overflow-wrap: break-word !important;">最后感谢 WiFi 万能钥匙安全应急响应中心的赞助支持，</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; overflow-wrap: break-word !important;">接下来的比赛大家一定要使出洪荒之力哦！↖(^ω^)↗</span><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; overflow-wrap: break-word !important;">比心&nbsp;❤</span></p><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_gif/1UG7KPNHN8F7ckRiaZtp76v0KXiaibibdH9bfyDfqPrYWQibxej8Zzu0vKAC2JDuEkRHibZXWWfv0FzdCgYL0NZuQG7Q/0?wx_fmt=gif" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 240px !important; height: 240px !important;"></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br></p><p><br></p><section label="Copyright Reserved by PLAYHUDONG." style="margin-top: 1em; margin-bottom: 1em; max-width: 100%; border-width: 0px; border-style: none; border-color: currentcolor; box-sizing: border-box !important; overflow-wrap: break-word !important;"><section style="margin-left: 1em; max-width: 100%; line-height: 1.4; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="padding: 0.2em 0.5em; max-width: 100%; border-radius: 0.3em; color: white; background-color: rgb(102, 102, 102); font-size: 1em; font-family: inherit; font-weight: inherit; text-align: inherit; text-decoration: inherit; box-sizing: border-box !important; overflow-wrap: break-word !important;">赞助商</span></section><section class="" style="margin-top: -0.7em; max-width: 100%; border-width: 1px; border-style: solid; border-color: rgb(192, 200, 209); border-radius: 0.4em; color: rgb(51, 51, 51); font-size: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><section style="padding: 1.4em 1em 1em; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><section style="max-width: 100%; font-size: 1em; font-family: inherit; font-weight: inherit; text-align: inherit; text-decoration: inherit; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">上海连尚网络科技有限公司成立于
 2013 年，是一家专注于提供免费上网和内容服务的移动互联网企业。连尚网络自主研发的核心产品 WiFi 
万能钥匙，以分享经济的模式，通过云计算和大数据技术，利用热点主人分享的闲置WiFi资源，为用户提供免费、稳定、安全的上网服务，以帮助更多的人上网，找到属于他们的机会，改变自己的命运。</span></p></section></section></section></section><p><br></p><p><br></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><hr style="max-width: 100%; line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282630&amp;idx=1&amp;sn=61fcbc708235dec5d7897a0d7c315756&amp;chksm=b1815a0c86f6d31a50ba1f9a39d876e28f2c71096100b28e961df185f7be94ec77b9199efd51&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">等你来挑战！| 看雪 CTF 2017 攻击篇</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283714&amp;idx=2&amp;sn=6860ed543d45ce46c143d62479275880&amp;chksm=b1815e4886f6d75e9c39979e6d6d5cf956fd83d00cfca6e176ca33a6b3c795d711efe4d288df&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第十题 点评及解题思路</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283658&amp;idx=1&amp;sn=92d4cc9ae762907ade2609c59363ee7b&amp;chksm=b1815e0086f6d7166d68770b5bb3ec7efe248d1770776bb68c01770afef6ff6d453a36d472cf&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第九题 点评及解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283635&amp;idx=1&amp;sn=def939676120de30c65d44898160901e&amp;chksm=b1815ef986f6d7efd9d86a62eb3bfe062773edef30c226ae13afd2cf36ed7a49a07c9c3db914&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第八题 点评及解题思路</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283585&amp;idx=1&amp;sn=b42facf25a1a1e741f7aaaed109aa0d7&amp;chksm=b1815ecb86f6d7dd5450caae1483431e6f0853aaeb23ba3c9e392790173b1434d3faf43b732c&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第七题 点评及解题思路</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283466&amp;idx=1&amp;sn=0cbd1b491a917f860d9eeaa86e38ffdd&amp;chksm=b1815d4086f6d456026df9efc766abea7dfc2fa0940e6264200c15672d94976b697f331ff0a7&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第六题 点评及解题思路</a></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">更多比赛详情，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8F7ckRiaZtp76v0KXiaibibdH9bCfZtDdhqeqbk5LToic1TlqZZJ05wLxqexpbloufvSCKbUEPbEtFUzzQ/640?wx_fmt=jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 640px !important; height: 427px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪论坛：http://bbs.pediy.com/</span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">商务合作<span style="max-width: 100%;"></span>：<span style="max-width: 100%;">wsc@kanxue.com</span></span></p><p><br></p><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; width: 100.5px; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="margin-top: 10px; max-width: 100%; box-sizing: border-box; text-align: center; transform: translate3d(0px, 0px, 0px); font-size: 11.2px; overflow-wrap: break-word !important;"><section class="" style="padding: 4px; max-width: 100%; box-sizing: border-box; display: inline-block; background-color: rgb(211, 0, 0); font-size: 11.2px; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; border-color: white; width: 1.6em; height: 1.6em; border-style: solid; border-width: 1px; font-size: 16.8px; line-height: 1.5em; color: rgb(255, 255, 255); overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; font-size: 16.8px; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">点</span></p></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; text-align: center; line-height: 0; overflow: hidden; transform: translate3d(0px, 0px, 0px); overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="margin: auto; max-width: 100%; box-sizing: border-box; width: 2px; height: 1em; background-color: rgb(211, 0, 0); overflow-wrap: break-word !important;"></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; width: 0px; border-top: 1em solid rgb(211, 0, 0); overflow-wrap: break-word !important; border-left: 0.5em solid transparent !important; border-right: 0.5em solid transparent !important;"><br></section></section></section></section></section></section></section><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1499131012&src=3&ver=1&signature=iU4hCwtQzyv2pey6SDTnZ62YXf1MWi8Zh8usUjq2T6Tp8olMm-6I1I4qsl-rYUzkEslKlH6cxolxoLxftDKuPkLyq5jzpH2tN2ZnjmxRooO5VLzrRdhnja7vgmXXSm-Oyqleaoa-WR06nBN3ltSZYNWGHC4TPP5MrMTv-58MwNw=">微信地址</a> | <a href="http://ctf.pediy.com/game-fight-43.htm">阅读原文</a>
{% endraw  %}

