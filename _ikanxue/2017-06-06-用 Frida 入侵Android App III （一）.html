---
title: 用 Frida 入侵Android App III （一）
author: lumou
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1496829841&src=3&ver=1&signature=IbkGB-IUv3NGRNGRf6IuJDEcuRy1*zESqpfOL5NuObERGQ*gbLaFfQ8X2IuMqNyfrhAtNGHPvT-wKPXl9IJKjHS23E7UkasmaX2*RXDP5NEP179klBYAKR0LcC-*3NnuQz7TChqzJf25kmFwwJXYPyPOWF119GC8PUU4vb5rFgc=
date: '2017-06-06 00:00:00 +0000'

---

{% raw  %}
<p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">在我发完第二篇关于 Frida 的博文之后，</span><span style="font-size: 15px;">@muellerberndt</span> &nbsp;<span style="font-size: 15px;">立即就决定公布另一个OWASP Android crackme。我想试试看我是否依然可以用 Frida 来解决这个问题。如果你也想跟着我一起，那么你需要：</span></p><ul class="list-paddingleft-2"><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">OWASP Uncrackable Level2 APK</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">Android SDK </span><span style="font-size: 15px;">和 模拟器</span><span style="font-size: 15px;"> （我用的是Android 7.1 x64镜像）</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">&nbsp;</span><span style="font-size: 15px;">Frida</span><span style="font-size: 15px;">&nbsp; 的安装包（加上&nbsp;</span><span style="font-size: 15px;">frid服务器</span><span style="font-size: 15px;"> ）</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">字节码查看器</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">radare 2</span> <span style="font-size: 15px;">（或者你自己选择用其他的反编译器）</span></p></li><li><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">apktool</span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">如果你需要 Frida 的安装教程，请查看 Frida 的</span><span style="font-size: 15px;">官方文档。</span><span style="font-size: 15px;">至于 Frida 的使用，请查看这个教程的</span><span style="font-size: 15px;">第一部分</span><span style="font-size: 15px;">&nbsp;。现在我就当你已经准备好所有东西，在继续往前走之前，你还需要稍微熟悉 Frida 的使用，还有，确保 Frida 可以连接你的设备/模拟器。（比如，通过使用 frida-ps -U 命令）。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">说在前面的话：这不仅仅是一篇解决那个 crackme 的攻略。相反的，我打算向你展示几种不同的方法来解决这个具体的问题。如果你只是想看解决方法，可以直接翻到本教程的最后面，那里有 Frida 脚本。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">注意：如果你在使用 Frida 时收到下面的错误</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaicAqe5tQmlUmLD2jSvQpcp4Qx9WUVeAsdGbfUXgm9UWeibGHEfDaqJKg/0?wx_fmt=png" style="width: 419px !important; height: 32px !important; visibility: visible !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">或者其他类似的错误，它可能会清除模拟器上所有的用户数据，所以你要重启然后重新安装 apk。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">做好得多试好几次的思想准备，程序会崩溃，模拟器会需要重启，一切都可能变得很乱七八糟的，但最终，我们会成功。</span></p><section data-id="us499416" class="" style="border-width: 0px; border-style: none; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 0px;"><section style="width: 100%; text-align: center;" data-width="100%"><section style="display: inline-block;"><section style="float: left;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiadlJicOKVwCjniaSyUbqCszYRUicBR8Vkrwic49dQzS8sibfeofFicsxZPINg/0?wx_fmt=png" style="display: block; width: 54px !important; height: 57px !important;"></section><section style="float: left; margin-top: 24px; margin-left: -42px;"><section style="padding-left: 40px; padding-right: 20px; line-height: 20px; font-size: 16px; color: rgb(98, 86, 33);" class="" data-brushtype="text">第一次运行</section><section style="width: 100%;" data-width="100%"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaTUbLTvrs498h3Ze69ciad0xl2kKHVIsLEic5W3epOGPWjsMnGOSj4YLQ/0?wx_fmt=png" style="width: 140px !important; height: 10.2439px !important;"></section></section></section></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">和在 UnCrackable 1 做的一样，我们第一步是运行那个 app。也和它 UnCrackable 1 一样，当我们在模拟器上运行这个 app 时，它会被检测到说是在已经 root 过的设备上运行的。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaIq7cjE4Z8bw92MMfUZfpicjicooWHGvMhicRK6Mxwd5IcSDFefW3RgB5g/0?wx_fmt=png" style="width: 462px !important; height: 853px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我们会像在 UnCrackable 1 那里一样，钩住 OnClickListener 函数。但在这之前，我们得看看我们是否已经连上 Frida 以便我们修改。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaoXZZfpnEQZe5icsAaYVEhQToH3pCkdy87iapuibPouP8G0chwyqYpW4iaQ/0?wx_fmt=png" style="width: 770px !important; height: 179.525px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">这是啥？有两个同名进程。我们可以&nbsp;frida-ps -U 来验证：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6Ouiagjmw9JGsAjOgZzmXyLqibAibz6ichwibVDumiaA7n6BluwlnTiaP0icj2DNfA/0?wx_fmt=png" style="width: 361px !important; height: 44px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">好奇怪，让我们把 Frida 注入到父进程：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6Ouia2YcKhtTAN72Wmub2sGOED9e9UYkTLgAQ1WJcrdj799qeBQzAhQApOA/0?wx_fmt=png" style="width: 736px !important; height: 245px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">没用。因为我们是在以 root 运行 Frida 时得到这样的结果的，所以这个方案没什么效果。这是怎么了？我们得好好研究这个 app。解压 apk，用字节码查看器（例如CFR-Decompiler）反编译 classes.dex</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiapE4aNvTPRsIw2k4Ab58ecrN3OibspQ74vYrK0YiaTGSnevEiaCPn4JS8A/0?wx_fmt=png" style="width: 770px !important; height: 462.514px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiavmohvSTgfpUNGnIsTp1w5AibQAWIWNh7wVVsvcP0q5P3l2nVLujPjTg/0?wx_fmt=png" style="width: 770px !important; height: 417.829px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我们注意到 static 块里调用了 System.load 来加载 foo 库（参看【1】）。这个app还在 OnCreate 函数里的第一行就调用了this.init（），而这个函数被声明为native函数（参看【2】），所以它应该是 foo 的一部分。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">让我们来看看这个 foo 库。在 radare2 中打开这个库（你会在lib文件夹里看到几个不同的架构，我这里用的是 lib/x86_64 ），分析它并列出它的输出。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiawUJZatZlveJPJ5gq3WBcP6N1bYnicmuNuYXAzicFUd82LveUUKNibjbMg/0?wx_fmt=png" style="width: 770px !important; height: 283.189px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我们看到这个库导出了两个很有意思的函数：Java_sg_vantagepoint_uncrackable2_MainActivity_init&nbsp;和&nbsp;Java_sg_vantagepoint_uncrackable2_CodeCheck_bar （关于这些函数的命名，请查看&nbsp;</span><span style="font-size: 15px;">Java nativ interface JNI</span> <span style="font-size: 15px;">），我们要看的是：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">Java_sg_vantagepoint_uncrackable2_MainActivity_init &nbsp;</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaicSdFxBcL1O4jQxulaXUsEzflp15xbAjTWMiaQhvjxy6E9xrZE5XAn2w/0?wx_fmt=png" style="width: 405px !important; height: 42px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">这是一个蛮短的函数：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6Ouia2xkibs10ib6E1wicqul52w5A0IVchuEI43oFT7vQj6C4QGeEOEibm8nRrg/0?wx_fmt=png" style="width: 770px !important; height: 249.219px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">它调用了另一个函数sub.fork_820，这个要做的事就比较多了：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiarcYJykDN5mO7vAia9Nsibjic96kptoT9ggGKpDKJiapiavHaZQxWl6madTg/0?wx_fmt=png" style="width: 770px !important; height: 514.492px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaW79pP0dlvkZQclaJJJk4cZW5hoJgkvY6hgZwNReskRDFsYHw1FL4Fw/0?wx_fmt=png" style="width: 770px !important; height: 482.648px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6Ouiapaa3D4YMxwEEOWmBvD82RGlNicPNc5WdAe6JrVYs5ibLjWyHialsOxHRA/0?wx_fmt=png" style="width: 770px !important; height: 83.1496px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我们看到调用了 fork，pthread_create,getppid,ptrace和waitpid. 无需花太多时间来反编译我们就可以猜到，当调试器用 ptrace 的时候，主进程会 fork 一个子进程来关联它。这是很简单的反调试技术，你可以从</span><span style="font-size: 15px;">这里</span><span style="font-size: 15px;">了解到更多细节。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">因为 Frida 用 ptrace 来初始化注入，所以这就解释了为什么我们不能连接到父进程：因为已经连接了一个进程来作为调试器，再来一个进程关联调试将被阻塞。</span></p><section data-id="us499416" class="" style="border-width: 0px; border-style: none; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 0px;"><section style="width: 100%; text-align: center;" data-width="100%"><section style="display: inline-block;"><section style="float: left;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiadlJicOKVwCjniaSyUbqCszYRUicBR8Vkrwic49dQzS8sibfeofFicsxZPINg/0?wx_fmt=png" style="display: block; width: 54px !important; height: 57px !important;"></section><section style="float: left; margin-top: 24px; margin-left: -42px;"><section style="padding-left: 40px; padding-right: 20px; line-height: 20px; font-size: 16px; color: rgb(98, 86, 33);" class="" data-brushtype="text">&nbsp;反反调试方案一：Frida<br></section><section style="width: 100%;" data-width="100%"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaTUbLTvrs498h3Ze69ciad0xl2kKHVIsLEic5W3epOGPWjsMnGOSj4YLQ/0?wx_fmt=png" style="width: 228.594px !important; height: 16.7264px !important;"></section></section></section></section><section style="clear: both; width: 100%;" data-width="100%"><span style="font-size: 15px;">Frida 救援。相比于注入 Frida 到一个正在运行的进程，我们可以让它自己 spawn 出一个进程来给我们。用 -f 选项，我们告诉 Frida 注入 Zygote 然后启动该应用程序。在我们启动 Frida 后关掉这个应用程序，看看发生什么：</span></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaVLPov0XMOWcibFicw5blKPvMhUbGthTru14C09ZAGagM5wITJnjcQJvA/0?wx_fmt=png" style="width: 452px !important; height: 30px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我们得到：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaF6yoHibicXwFc7065NhJeEpDVhB1TuricrLPiaQzEsicbibhx1f6vNwJ0DGw/0?wx_fmt=png" style="width: 770px !important; height: 182.919px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">呼啦啦！Frida 注入到 Zygote 了，spawn 我们的进程并等待输入。（我承认，有很多教程都告诉你们要在 Frida 加-f选项，但你也被警告过……）</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我们现在已经做好准备了。但是在继续往下走之前，我们再来看另一种针对这个crackme 的反反调试方案。</span></p><section data-id="us499416" class="" style="border-width: 0px; border-style: none; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 0px;"><section style="width: 100%; text-align: center;" data-width="100%"><section style="display: inline-block;"><section style="float: left;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiadlJicOKVwCjniaSyUbqCszYRUicBR8Vkrwic49dQzS8sibfeofFicsxZPINg/0?wx_fmt=png" style="display: block; width: 54px !important; height: 57px !important;"></section><section style="float: left; margin-top: 24px; margin-left: -42px;"><section style="padding-left: 40px; padding-right: 20px; line-height: 20px; font-size: 16px; color: rgb(98, 86, 33);" class="" data-brushtype="text">&nbsp;反反调试方案二：修改<br></section><section style="width: 100%;" data-width="100%"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaTUbLTvrs498h3Ze69ciad0xl2kKHVIsLEic5W3epOGPWjsMnGOSj4YLQ/0?wx_fmt=png" style="width: 224px !important; height: 16.3902px !important;"></section></section></section></section></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">除去让 Frida 来 spawn，我们也可以通过修改这个 app 来解决这个问题。这意味着，我们要反编译这个 app，重新打包和签名修改过的 apk。然而，在这个 crackme 中，这样做会在后面给我们带来麻烦。就算这样，我还是决定告诉你怎样做，后面的问题后面解决。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我们可以用 apktool 来修改：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6Ouia0Rs7pY8BgVaIc4ia88WGiaRw0Zew74jc5dLVvXlx5icmedZcnCK5jgYKA/0?wx_fmt=png" style="width: 770px !important; height: 106.846px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">（我用 -r 来跳过了提取资源，因为这会在重新编译apk时出错。而且，在这里我们也不需要这些资源。）</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">来看看在 smali/sg/vantagepoint/uncrackable2/MainActivity.smali 的 smali 代码。你可以看到调用 inti 的操作是在82行附近，你可以把它注释掉。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiawKv6In6dcUxEwLicRpics5DBfk7WfXcPh69zWaH8QjVFADDZh1k5EXkg/0?wx_fmt=png" style="width: 770px !important; height: 95.58px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">重新打包（忽略叼那个fatal error……）：<br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6Ouia7qK7Ofv2TZKGoWFpUj3OC97B1YpzPwwiaoIVYC34BdibLpicZtHIalUcg/0?wx_fmt=png" style="width: 770px !important; height: 158.529px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">align（优化）：<br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaM8pib8T5j5CsHWylLibPCvXbY6weRNfyAlGX7l0Qe8b0yf9juWNEO1UA/0?wx_fmt=png" style="width: 770px !important; height: 116.435px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">签名（注意：在这一步你要有一个key和keystore，你可以在&nbsp;</span><span style="font-size: 15px;">OWASP 手机安全测试指南</span><span style="font-size: 15px;"> 看到更多介绍。）：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiacAVwNqauV1SpAicwpBicMucooWXSI8GOthiaiaLm0mDCAu92wReYUkPong/0?wx_fmt=png" style="width: 770px !important; height: 191.432px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">卸载原来的apk，安装这个修改过的apk：<br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaoJtEMfE6b8hLXeXr1DlWcULuiad8funPTNt7dnWiaWJ2W5NpVHTCkMqA/0?wx_fmt=png" style="width: 400px !important; height: 44px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">启动这个app，运行frida-ps我们会看到只有一个进程了：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaiaH0y9GGzqgG6ibT8UgRLoT5IiaVmZSPPralMOCnq4yfibNQwyP894IRxw/0?wx_fmt=png" style="width: 346px !important; height: 27px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">然后连接Frida也没有问题：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6OuiaQXRYR5u90tsrtxwADsZ0ATicibOmqAd6sH1m43a7TpBk9micQoYuE7vZA/0?wx_fmt=png" style="width: 770px !important; height: 183.76px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">相比于只是在Frida里加-r选项是比较麻烦啦，但这也更普遍。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">就像前面提过的，如果我们使用这个修改过的版本，那后面要提取那个Secret String就不会那么容易（尽管如此，我还是会告诉你怎样解决的，所以不要放弃哦）。但是现在我们要用的是原来的版本来进行后面的操作。确保你下面安装的是原来的版本。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p style="line-height: normal; margin-top: 15px; margin-bottom: 15px; text-align: center;"><span style="font-size: 14px; color: rgb(136, 136, 136);">本文由 看雪翻译小组 lumou 编译，来源 Michael Helwig@codemetrix.net</span></p><p style="line-height: normal; margin-top: 15px; margin-bottom: 15px; text-align: center;"><span style="font-size: 14px; color: rgb(136, 136, 136);"><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="font-size: 15px; color: rgb(255, 104, 39);">明日第二部分<br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="font-size: 15px; color: rgb(255, 104, 39);">如果你喜欢的话，不要忘记点个赞哦！</span><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">热门阅读文章：<br></strong></span></p><hr style="max-width: 100%; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283127&amp;idx=1&amp;sn=a456b8495b438499ab68d1a2c32e543c&amp;chksm=b1815cfd86f6d5eb01205cf7c3052d428b2e9105d34523a276bdfb774c7adbbcbd197210f286&amp;scene=21#wechat_redirect" target="_blank">看雪 CTF 2017 攻击篇 6月强势来袭！</a><br></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 15px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283184&amp;idx=2&amp;sn=32f3a9e70e3504ed2cd68f1c0a2c8f3d&amp;chksm=b1815c3a86f6d52ca5b25dfb1b6d120712007f74f6d57d062881bcbc3b3b9b0ed31232a1c530&amp;scene=21#wechat_redirect" target="_blank">虚拟机逃逸——QEMU的案例分析（二）</a><br></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283175&amp;idx=2&amp;sn=6e8fb6db8c328707308758a8791029b0&amp;chksm=b1815c2d86f6d53b885885136b9b9c0685c72006ff6fe96150e060a6ba56aa8c63651f0daee5&amp;scene=21#wechat_redirect" target="_blank">虚拟机逃逸——QEMU的案例分析（一）</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282703&amp;idx=3&amp;sn=bfa728ff73cd389cd9258ca32008c6e2&amp;chksm=b1815a4586f6d353468f3adf9545aab3ffdce4f4c3e0e47c967298eca045db0558e37865c3a7&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283005&amp;idx=2&amp;sn=2fc411b70549c789085e517ef6dfc3e9&amp;chksm=b1815b7786f6d261975cd000d4ddf2c4cffe3cf2d8ab06d870e7971e862c29c7278996bdfb6c&amp;scene=21#wechat_redirect" target="_blank" style="font-size: 15px; text-decoration: none;"><span style="font-size: 15px;"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283017&amp;idx=3&amp;sn=745024d678707b6dcf0cdc94ff5472a5&amp;chksm=b1815c8386f6d59538bfeeb8d3837007f07b0b4d3cd77b439f7856edd391127b6b2f36fb105d&amp;scene=21#wechat_redirect" target="_blank" style="font-size: 15px; text-decoration: none;"><span style="font-size: 15px;"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283184&amp;idx=1&amp;sn=fd8246361b0bd21c80717c888e67f55a&amp;chksm=b1815c3a86f6d52cfd48056237427263609a8184b1cea6b28d1bc56f942dd1498dd26764d4bb&amp;scene=21#wechat_redirect" target="_blank">看雪.万能钥匙 CTF 2017第一题 WannaLOL 解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283114&amp;idx=3&amp;sn=fc763099faeb53bb8407bce865b403c1&amp;chksm=b1815ce086f6d5f60970b9c550518d07199c77e380cee90791c91a6ade3f5abd2b4c3f9588cd&amp;scene=21#wechat_redirect" target="_blank">CVE-2012-0158 两种 PoC 分析</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">......<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">更多优秀文章，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8E4ItLe4LX3YbLUffeV86icpcBApdQiakmEMuy4q8mVAaBjA0P1wez6NzO52zvKNlQQQ4siaztZDYhBg/640?wx_fmt=jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 140px !important; height: 140px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 15px;">看雪论坛：http://bbs.pediy.com/</span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">投稿、合作：www.kanxue.com</span></p><p><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br></span></p><p><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><section class="" data-tools="135编辑器" data-id="88571" style="border-width: 0px; border-style: none; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 0px;"><section><section style="display: inline-block; vertical-align: top;"><section style="margin-top: 0.5em; margin-bottom: 0.5em; width: 32px;"><img src="http://mmbiz.qpic.cn/mmbiz_gif/1UG7KPNHN8H81tKo3Fl8E9nBEv5Z6Ouiaibd6AQEj3bpTELEudiaEXFXlMNzy6HI3yibTKdvfpmQiaSibwDlvPZIJqFQ/0?wx_fmt=gif" style="vertical-align: middle; visibility: visible !important; width: 32px !important; height: 64px !important;"></section></section><section style="display: inline-block; vertical-align: top; padding-left: 5px; box-sizing: border-box;"><br>点击“阅读原文”</section></section></section><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1496829841&src=3&ver=1&signature=IbkGB-IUv3NGRNGRf6IuJDEcuRy1*zESqpfOL5NuObERGQ*gbLaFfQ8X2IuMqNyfrhAtNGHPvT-wKPXl9IJKjHS23E7UkasmaX2*RXDP5NEP179klBYAKR0LcC-*3NnuQz7TChqzJf25kmFwwJXYPyPOWF119GC8PUU4vb5rFgc=">微信地址</a> | <a href="http://ctf.pediy.com/?game-list-2.htm">阅读原文</a>
{% endraw  %}

