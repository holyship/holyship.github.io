---
title: 小白的第一次逆向之扫雷分析与辅助制作
author: 八岛
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1512886045&src=3&ver=1&signature=0dsH*cvrb7sDcdE*f0PtKJTfSmWmpGSr1bt6eLQusWUeX1D3PeY-hy0sLVqqzj8ewzefSEoH9llGPntsMnS0FPyDxwp9BBUgOfdh7NBROn7EXZ0-77pbh-Uij042xcUHOMbdf2tjl3nVQ40z49toy-nGghbByXf9yvJFKJrpuUs=
date: '2017-12-09 00:00:00 +0000'

---

{% raw  %}
<p style="text-align: center;"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HB2Btkic1ggs1MBV6Q7ABXtMIribSHuwdeGbdialWGib4FW2PGp9CxxumNJf5GgCnXq8gmDTg6l1Iq3w/0?wx_fmt=jpeg" style="width: 463px !important; height: 308.546px !important; visibility: visible !important;"></p><p><br></p><h2 style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(0, 81, 171);"><strong><span style="letter-spacing: 2px;font-size: 18px;">思路</span></strong></span><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">：</span></h2><hr><h3 style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span><br></h3><h3 style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(0, 81, 171);font-size: 16px;"><strong><span style="color: rgb(0, 81, 171);letter-spacing: 2px;">1、想要实现的功能</span></strong></span></h3><p><br></p><ul style="margin-left: 8px;margin-right: 8px;" class="list-paddingleft-2"><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">鼠标悬停，自动提示是否有雷</span></p></li><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">一键自动扫雷</span></p></li></ul><h3 style="margin-left: 8px;margin-right: 8px;"><br><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span></h3><h3 style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(0, 81, 171);font-size: 16px;"><strong><span style="color: rgb(0, 81, 171);letter-spacing: 2px;">2、如何实现这些功能</span></strong></span></h3><p><br></p><h4 style="margin-left: 8px;margin-right: 8px;"><strong><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">Q：首先要了解如果想要实现想要的功能，需要进行什么操作？</span></strong></h4><h5 style="margin-left: 8px;margin-right: 8px;"><br><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span></h5><h5 style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">A：实现鼠标移动 ，自动识别有没有雷</span></h5><p><br></p><ul style="margin-left: 8px;margin-right: 8px;" class="list-paddingleft-2"><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">需要hook掉回调函数，响应WM_MOUSEMOVE消息</span></p><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span></p></li></ul><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><strong><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">Q：怎么判断鼠标所在的位置是不是有雷？是不是需要把屏幕坐标转换成扫雷区域的数组坐标？</span></strong></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">A：找到雷的</span><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);text-decoration: underline;">分辨类型</span><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">；找到雷的</span><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);text-decoration: underline;">数量</span><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">；找到扫雷区域的</span><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);text-decoration: underline;">大小</span><br></p><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><strong><span style="color: rgb(79, 79, 79);font-size: 15px;">Q：如何实现一键扫雷</span><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">？</span></strong></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">A：遍历扫雷的数组，对所有不是雷的区域；发WM_LBUTTONDOWN的消息，这样应该实现了扫雷的功能。同时，是不是还需要对数组坐标进行向屏幕坐标的转换</span></p><h2 style="margin-left: 8px;margin-right: 8px;"><br></h2><p><br></p><h2 style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(0, 81, 171);font-size: 18px;"><strong><span style="color: rgb(0, 81, 171);letter-spacing: 2px;">具体实现步骤</span></strong></span></h2><hr><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">有了思路之后，进行具体的实现</span></p><h3 style="margin-left: 8px;margin-right: 8px;"><br><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span></h3><h3 style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">找数据</span></h3><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">找界面的区域大小和雷的数量的数据应该是最好找的</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">查看是否有重定位（如果有就关掉），上CE<br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FsQQg9xDV51JYZeKbuMsWjKzdaFPDicexBmRczhyjiaO9zEnhNUFm12w3n7nDURmkcFsAs7ibEXd7pA/0?wx_fmt=png" style="width: 403px !important; height: 315px !important;"></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span><br></p><ul style="margin-left: 8px;margin-right: 8px;" class="list-paddingleft-2"><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">首先先找高度的基址<br>通过几次尝试之后，发现</span><br></p></li></ul><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FsQQg9xDV51JYZeKbuMsWjR83WoHrnSiaicJw0ZgxdZGeaupqtRQAaWNTLicb6RzWPhrHzXVVKVwjKg/0?wx_fmt=png" style="width: 726px !important; height: 199px !important;"></p><ul style="margin-left: 8px;margin-right: 8px;" class="list-paddingleft-2"><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">那么这两地址应该就是高度的基址了，具体为什么有2个先不管，放到窗口中先放一放</span><br></p></li><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">然后找宽度的基址<br>同样的经过几次尝试之后，发现<br></span></p></li></ul><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FsQQg9xDV51JYZeKbuMsWjiaH1gMQKeU8p6y6I3HzN3UM5OI2HWsKAxkzTibjtOLzsSxNiaBDWh5VhA/0?wx_fmt=png" style="width: 716px !important; height: 143px !important;"><br><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">这两个地址就该就是跟宽度相关的地址</span><br></p><ul style="margin-left: 8px;margin-right: 8px;" class="list-paddingleft-2"><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">找雷数的基址<br>步骤一样</span><br></p></li></ul><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FsQQg9xDV51JYZeKbuMsWjBaJFzW7bfgibev6mDZzwia4qqE1uLUtuvDMglha67dlJpknQ3ouTUoFQ/0?wx_fmt=png" style="width: 609px !important; height: 135px !important;"></p><ul style="margin-left: 8px;margin-right: 8px;" class="list-paddingleft-2"><li><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;">但是这里发现了3条数据，上面都是2条，有点不符合规律，所有就测试一下，到底这3个地址是不是全部都跟地雷数量有关（暂且按下不表，具体中od去看到底哪个才是）<br>根据地址的连续性，稍微整理了一下</span></p></li></ul><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FsQQg9xDV51JYZeKbuMsWj4ibdg01KDdBs6fhjWmayYKfic16ndRcPPPibhVQWgTYhY4GxZbib6Kg4icw/0?wx_fmt=png" style="width: 770px !important; height: 236.212px !important;"></p><p><span style="font-size: 15px;color: rgb(79, 79, 79);letter-spacing: 2px;"></span><br></p><ul style="margin-left: 8px;margin-right: 8px;" class="list-paddingleft-2"><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">找初始化地图数据的地址<br>找到了地雷和区域大小的基址，那么只要找到更改这个对区域进行更改的函数，猜想应该可以找到布雷的方法和各种雷等数据的判断类型<br>关键是如何找到这个函数，首先要想明白的一件事是，游戏对初始化的时候，肯定是会对数据进行调用的，那么是不是可以通过游戏初始化的时候，访问或者更改这里面的代码从而找到调用的地址，试一下把</span></p></li></ul><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8FsQQg9xDV51JYZeKbuMsWj5hzs7YfGQGKQicib617KqttQaqEU78JrVBRia8yEkiadTTJEiaC1wurXVWw/0?wx_fmt=png" style="width: 770px !important; height: 283.804px !important;"></p><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">通过故意还原游戏，从而找到了一访问某个数据的地址，或得这个地址的 数据为<br>01003712<br>这个时候，上od去看一下，是不是跟我们猜想的一样</span><br></p><blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002ED5&nbsp; /$&nbsp; B8 60030000&nbsp;&nbsp; MOV EAX,0x360&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax = 0x360 ，不知道要干嘛，接着看</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EDA&nbsp; |&gt;&nbsp; 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /DEC EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax -=1</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EDB&nbsp; |.&nbsp; C680 40530001&gt;|MOV BYTE PTR DS:[EAX+&lt;雷区界面基址&gt;],0xF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 通过流程分析可以知道，0xf是空地的类型值，说明在初始化空地</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EE2&nbsp; |.^ 75 F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \JNZ SHORT winmine.01002EDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 说明数组应该是0x360 这么大</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EE4&nbsp; |.&nbsp; 8B0D 34530001 MOV ECX,DWORD PTR DS:[&lt;宽度0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ecx =宽度的数值，x轴</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EEA&nbsp; |.&nbsp; 8B15 38530001 MOV EDX,DWORD PTR DS:[&lt;高度0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; edx= 高度的数值，y轴</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EF0&nbsp; |.&nbsp; 8D41 02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LEA EAX,DWORD PTR DS:[ECX+0x2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 额，没看懂，把宽度+2 保存到eax中，eax == 宽度+2</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EF3&nbsp; |.&nbsp; 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TEST EAX,EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 判断eax是不是为空</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EF5&nbsp; |.&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 根据函数最后有pop esi，应该是保存环境</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EF6&nbsp; |.&nbsp; 74 19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JE SHORT winmine.01002F11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 如果eax=0，跳转</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EF8&nbsp; |.&nbsp; 8BF2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV ESI,EDX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi&nbsp; =高度的数值，y轴</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EFA&nbsp; |.&nbsp; C1E6 05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHL ESI,0x5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi = 代表y轴的高度*32</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002EFD&nbsp; |.&nbsp; 8DB6 60530001 LEA ESI,DWORD PTR DS:[ESI+0x1005360]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi = [数组基址+0x20 +esi(高度*32)],应该是这个高度下的数组的最下一行</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F03&nbsp; |&gt;&nbsp; 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /DEC EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax = 宽度+2，说明左右的边界各占1，eax-=1</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F04&nbsp; |.&nbsp; C680 40530001&gt;|MOV BYTE PTR DS:[EAX+&lt;雷区界面基址&gt;],0x10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 10应该就是边界的类型了，这个应该是填充数组第一行的边界，从右往左</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F0B&nbsp; |.&nbsp; C60406 10&nbsp;&nbsp;&nbsp;&nbsp; |MOV BYTE PTR DS:[ESI+EAX],0x10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 这个高度下区域最下面的边界，也是从右往左填充的</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F0F&nbsp; |.^ 75 F2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \JNZ SHORT winmine.01002F03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax！=0 循环填充边界，也就是说填充的时候是 数组基址+0x20+高度*32+具体的列数</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F11&nbsp; |&gt;&nbsp; 8D72 02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LEA ESI,DWORD PTR DS:[EDX+0x2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 同样的，esi 保存的是高度的数值+2，从而说明上下边界高度是1，而且不占游戏界面的区域</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F14&nbsp; |.&nbsp; 85F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TEST ESI,ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 判断esi 是不是为空</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F16&nbsp; |.&nbsp; 74 21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JE SHORT winmine.01002F39&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 为空直接跳出了</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F18&nbsp; |.&nbsp; 8BC6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EAX,ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax =高度的值+0x2</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F1A&nbsp; |.&nbsp; C1E0 05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHL EAX,0x5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax =(高度的值+0x2)*32</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F1D&nbsp; |.&nbsp; 8D90 40530001 LEA EDX,DWORD PTR DS:[EAX+&lt;雷区界面基址&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 这两行应该也是要填充边界的为止，具体的就不看了</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F23&nbsp; |.&nbsp; 8D8408 415300&gt;LEA EAX,DWORD PTR DS:[EAX+ECX+0x1005341]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; edx 和eax应该是最下一行，最左边和最右边的值</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F2A&nbsp; |&gt;&nbsp; 83EA 20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /SUB EDX,0x20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 0x20 应该是2行</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F2D&nbsp; |.&nbsp; 83E8 20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |SUB EAX,0x20</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F30&nbsp; |.&nbsp; 4E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |DEC ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi -=1</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F31&nbsp; |.&nbsp; C602 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |MOV BYTE PTR DS:[EDX],0x10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 进行边界填充</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F34&nbsp; |.&nbsp; C600 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |MOV BYTE PTR DS:[EAX],0x10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 边界填充</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F37&nbsp; |.^ 75 F1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \JNZ SHORT winmine.01002F2A</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F39&nbsp; |&gt;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP ESI</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01002F3A&nbsp; \.&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RETN</span></p></blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">通过od可以看到上面的代码，验证是不是真的，下个断点还原下场景，看看是不是回断下来<br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">结果是断下来，说明这个地方很可能就是对界面进行初始化的函数，先来大致的分析一下这个函数到底做了什么</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">第一遍大体流程分析</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100367A&nbsp; /$&nbsp; A1 AC560001&nbsp;&nbsp; MOV EAX,DWORD PTR DS:[&lt;宽度1&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax == 宽度，暂且规定宽度是x轴坐标</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100367F&nbsp; |.&nbsp; 8B0D A8560001 MOV ECX,DWORD PTR DS:[&lt;高度1&gt;]</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003685&nbsp; |.&nbsp; 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBX</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003686&nbsp; |.&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ESI</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003687&nbsp; |.&nbsp; 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 保存寄存器环境</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003688&nbsp; |.&nbsp; 33FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EDI,EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; edi == 0</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100368A&nbsp; |.&nbsp; 3B05 34530001 CMP EAX,DWORD PTR DS:[&lt;宽度0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 宽度1 和宽度0 的数据进行对比</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003690&nbsp; |.&nbsp; 893D 64510001 MOV DWORD PTR DS:[0x1005164],EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 把0 移动到这个地址所在的空间内</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003696&nbsp; |.&nbsp; 75 0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JNZ SHORT winmine.010036A4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 宽度0 和宽度1 不想等，跳转</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003698&nbsp; |.&nbsp; 3B0D 38530001 CMP ECX,DWORD PTR DS:[&lt;高度0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 高度1和高度0进行对比</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100369E&nbsp; |.&nbsp; 75 04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JNZ SHORT winmine.010036A4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 高度0和高度1进行对比，不想等跳转，现在我有点怀疑这两组数据应该是用户设置的数据和实际填充的数据进行对比，下面可能是对数据的填充</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036A0&nbsp; |.&nbsp; 6A 04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH 0x4</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036A2&nbsp; |.&nbsp; EB 02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JMP SHORT winmine.010036A6</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036A4&nbsp; |&gt;&nbsp; 6A 06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH 0x6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; push 04和push 06很有可能判断用户是不是进行了跟更改界面大小的设置，现在的ebx可能就是对这个设置进行保存</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036A6&nbsp; |&gt;&nbsp; 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 猜测是保存是否更改界面的类型的值，ebx ==06 或0x4</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036A7&nbsp; |.&nbsp; A3 34530001&nbsp;&nbsp; MOV DWORD PTR DS:[&lt;宽度0&gt;],EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax == 宽度1 ，把宽度1 赋值给宽度0，说明宽度1才是真正的宽度的基址</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036AC&nbsp; |.&nbsp; 890D 38530001 MOV DWORD PTR DS:[&lt;高度0&gt;],ECX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ecx&nbsp; == 高度0，把高度0赋值给高度1，说明高度0才是真正的高度的基址</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036B2&nbsp; |.&nbsp; E8 1EF8FFFF&nbsp;&nbsp; CALL winmine.01002ED5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; call 的这个函数目测是一个循环，先不搞，把整个大体流程分析完之后再搞</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036B7&nbsp; |.&nbsp; A1 A4560001&nbsp;&nbsp; MOV EAX,DWORD PTR DS:[&lt;地雷1&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax == 地雷1的地址</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036BC&nbsp; |.&nbsp; 893D 60510001 MOV DWORD PTR DS:[0x1005160],EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; edi=0,把0 移动到这个地址，暂时不明白是干嘛的</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036C2&nbsp; |.&nbsp; A3 30530001&nbsp;&nbsp; MOV DWORD PTR DS:[&lt;地雷0&gt;],EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax == 地雷1的地址，把地雷1中的值赋值给地雷0，说明地雷1才是地雷的真正的基址</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036C7&nbsp; |&gt;&nbsp; FF35 34530001 PUSH DWORD PTR DS:[&lt;宽度0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 把宽度0（x轴的坐标）入栈</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036CD&nbsp; |.&nbsp; E8 6E020000&nbsp;&nbsp; CALL &lt;winmine.产生随机数&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ctrl+a 发现这个是rand函数，然后根据入栈的数据就可以说明这个是根据某个值产生随机的值，这个函数可以不用看了</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036D2&nbsp; |.&nbsp; FF35 38530001 PUSH DWORD PTR DS:[&lt;高度0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 高度0入栈</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036D8&nbsp; |.&nbsp; 8BF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV ESI,EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi = eax应该是函数返回值</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036DA&nbsp; |.&nbsp; 46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INC ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi +1 ,根据宽度产生的随机数+1，esi保存根据宽度产生的随机值</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036DB&nbsp; |.&nbsp; E8 60020000&nbsp;&nbsp; CALL &lt;winmine.产生随机数&gt;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036E0&nbsp; |.&nbsp; 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INC EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 根据高度产生的随机值+1</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036E1&nbsp; |.&nbsp; 8BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV ECX,EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ecx = 根据高度产生的随机值</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036E3&nbsp; |.&nbsp; C1E1 05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHL ECX,0x5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ecx&nbsp; =ecx*32，根据高度产生的随机值左移5位</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036E6&nbsp; |.&nbsp; F68431 405300&gt;TEST BYTE PTR DS:[ECX+ESI+&lt;雷区界面基址&gt;],0x80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ecx是随机数，esi也是随机数，+一个地址应该是去锁定其中的数组为止，说明这个值就是数组基址</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036EE&nbsp; |.^ 75 D7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JNZ SHORT winmine.010036C7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 跟80进行比较，可能说明80就是非雷的区域，如果不是非雷的区域，要么是边界要么是雷，所以需要跳转重新计算</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036F0&nbsp; |.&nbsp; C1E0 05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHL EAX,0x5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax左移5位就是ecx中的值</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036F3&nbsp; |.&nbsp; 8D8430 405300&gt;LEA EAX,DWORD PTR DS:[EAX+ESI+&lt;雷区界面基址&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 把区域具体的数组的地址放到eax中</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036FA&nbsp; |.&nbsp; 8008 80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OR BYTE PTR DS:[EAX],0x80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 把eax中第一个字节火上80，哎呦可能是设置雷了，说明80是并不是空地，运行起来发现0f是空地，8f是地雷</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">010036FD&nbsp; |.&nbsp; FF0D 30530001 DEC DWORD PTR DS:[&lt;地雷0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 设置好雷之后对设置的地雷数量进行-1</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003703&nbsp; |.^ 75 C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JNZ SHORT winmine.010036C7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 判断地雷0中保存的值是否为0，不是的化重复设置地雷</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003705&nbsp; |.&nbsp; 8B0D 38530001 MOV ECX,DWORD PTR DS:[&lt;高度0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ecx = 高度0的值</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100370B&nbsp; |.&nbsp; 0FAF0D 345300&gt;IMUL ECX,DWORD PTR DS:[&lt;宽度0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ecx = 用户设置的高度的值* 用户设置的宽度的值</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003712&nbsp; |.&nbsp; A1 A4560001&nbsp;&nbsp; MOV EAX,DWORD PTR DS:[&lt;地雷1&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax = 地雷的值</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003717&nbsp; |.&nbsp; 2BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUB ECX,EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ecx = 高度*宽度 -地雷数，这是干啥的？</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003719&nbsp; |.&nbsp; 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 根据后面有pop edi，应该是保存环境</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100371A&nbsp; |.&nbsp; 893D 9C570001 MOV DWORD PTR DS:[0x100579C],EDI</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003720&nbsp; |.&nbsp; A3 30530001&nbsp;&nbsp; MOV DWORD PTR DS:[&lt;地雷0&gt;],EAX</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003725&nbsp; |.&nbsp; A3 94510001&nbsp;&nbsp; MOV DWORD PTR DS:[0x1005194],EAX</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100372A&nbsp; |.&nbsp; 893D A4570001 MOV DWORD PTR DS:[0x10057A4],EDI</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003730&nbsp; |.&nbsp; 890D A0570001 MOV DWORD PTR DS:[0x10057A0],ECX</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003736&nbsp; |.&nbsp; C705 00500001&gt;MOV DWORD PTR DS:[0x1005000],0x1</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003740&nbsp; |.&nbsp; E8 25FDFFFF&nbsp;&nbsp; CALL winmine.0100346A</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003745&nbsp; |.&nbsp; 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBX</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">01003746&nbsp; |.&nbsp; E8 05E2FFFF&nbsp;&nbsp; CALL winmine.01001950</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100374B&nbsp; |.&nbsp; 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EDI</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100374C&nbsp; |.&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP ESI</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100374D&nbsp; |.&nbsp; 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBX</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">0100374E&nbsp; \.&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RETN</span></p></blockquote><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">接下来对几个关键函数进行分析，比如产生随机雷之前有个有很多循环的函数，估计事初始化界面数组的函数，进去分析一下</span></p><p><br></p><blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002ED5&nbsp; /$&nbsp; B8 60030000&nbsp;&nbsp; MOV EAX,0x360&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax = 0x360 ，不知道要干嘛，接着看</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EDA&nbsp; |&gt;&nbsp; 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /DEC EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax -=1</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EDB&nbsp; |.&nbsp; C680 40530001&gt;|MOV BYTE PTR DS:[EAX+&lt;雷区界面基址&gt;],0xF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 通过流程分析可以知道，0xf是空地的类型值，说明在初始化空地</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EE2&nbsp; |.^ 75 F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \JNZ SHORT winmine.01002EDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 说明数组应该是0x360 这么大</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EE4&nbsp; |.&nbsp; 8B0D 34530001 MOV ECX,DWORD PTR DS:[&lt;宽度0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ecx =宽度的数值，x轴</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EEA&nbsp; |.&nbsp; 8B15 38530001 MOV EDX,DWORD PTR DS:[&lt;高度0&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; edx= 高度的数值，y轴</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EF0&nbsp; |.&nbsp; 8D41 02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LEA EAX,DWORD PTR DS:[ECX+0x2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 额，没看懂，把宽度+2 保存到eax中，eax == 宽度+2</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EF3&nbsp; |.&nbsp; 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TEST EAX,EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 判断eax是不是为空</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EF5&nbsp; |.&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 根据函数最后有pop esi，应该是保存环境</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EF6&nbsp; |.&nbsp; 74 19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JE SHORT winmine.01002F11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 如果eax=0，跳转</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EF8&nbsp; |.&nbsp; 8BF2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV ESI,EDX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi&nbsp; =高度的数值，y轴</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EFA&nbsp; |.&nbsp; C1E6 05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHL ESI,0x5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi = 代表y轴的高度*32</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002EFD&nbsp; |.&nbsp; 8DB6 60530001 LEA ESI,DWORD PTR DS:[ESI+0x1005360]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi = [数组基址+0x20 +esi(高度*32)],应该是这个高度下的数组的最下一行</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F03&nbsp; |&gt;&nbsp; 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /DEC EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax = 宽度+2，说明左右的边界各占1，eax-=1</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F04&nbsp; |.&nbsp; C680 40530001&gt;|MOV BYTE PTR DS:[EAX+&lt;雷区界面基址&gt;],0x10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 10应该就是边界的类型了，这个应该是填充数组第一行的边界，从右往左</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F0B&nbsp; |.&nbsp; C60406 10&nbsp;&nbsp;&nbsp;&nbsp; |MOV BYTE PTR DS:[ESI+EAX],0x10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 这个高度下区域最下面的边界，也是从右往左填充的</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F0F&nbsp; |.^ 75 F2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \JNZ SHORT winmine.01002F03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax！=0 循环填充边界</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F11&nbsp; |&gt;&nbsp; 8D72 02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LEA ESI,DWORD PTR DS:[EDX+0x2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 同样的，esi 保存的是高度的数值+2，从而说明上下边界高度是1，而且不占游戏界面的区域</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F14&nbsp; |.&nbsp; 85F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TEST ESI,ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 判断esi 是不是为空</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F16&nbsp; |.&nbsp; 74 21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JE SHORT winmine.01002F39&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 为空直接跳出了</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F18&nbsp; |.&nbsp; 8BC6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EAX,ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax =高度的值+0x2</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F1A&nbsp; |.&nbsp; C1E0 05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHL EAX,0x5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax =(高度的值+0x2)*32</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F1D&nbsp; |.&nbsp; 8D90 40530001 LEA EDX,DWORD PTR DS:[EAX+&lt;雷区界面基址&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 这两行应该也是要填充边界的为止，具体的就不看了</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F23&nbsp; |.&nbsp; 8D8408 415300&gt;LEA EAX,DWORD PTR DS:[EAX+ECX+0x1005341]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; edx 和eax应该是最下一行，最左边和最右边的值</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F2A&nbsp; |&gt;&nbsp; 83EA 20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /SUB EDX,0x20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 0x20 应该是2行</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F2D&nbsp; |.&nbsp; 83E8 20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |SUB EAX,0x20</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F30&nbsp; |.&nbsp; 4E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |DEC ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi -=1</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F31&nbsp; |.&nbsp; C602 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |MOV BYTE PTR DS:[EDX],0x10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 进行边界填充</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F34&nbsp; |.&nbsp; C600 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |MOV BYTE PTR DS:[EAX],0x10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 边界填充</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F37&nbsp; |.^ 75 F1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \JNZ SHORT winmine.01002F2A</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F39&nbsp; |&gt;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP ESI</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002F3A&nbsp; \.&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RETN</span></p></blockquote><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">通过分析可以看出，这个函数只是对空地和边界进行填充</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">通过上述的分析，大体知道了初始化雷区的的公式</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">划重点:数组基址+0x20 +esi(高度*32)，如果这个位置的opcode是0x8f，说明是雷，0xf说明是空地</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">然后去看一下内存图</span></p><p><br></p><blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005340 &lt;&gt;10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005350&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005360&nbsp;&nbsp; 10 8F 8F 8F 0F 0F 0F 0F 8F 0F 0F 8F 0F 0F 8F 10&nbsp; 弿????</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005370&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005380&nbsp;&nbsp; 10 8F 8F 0F 0F 0F 8F 0F 0F 0F 0F 8F 8F 0F 0F 10&nbsp; 弿?弿</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005390&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010053A0&nbsp;&nbsp; 10 0F 8F 0F 0F 0F 8F 8F 0F 8F 0F 0F 8F 8F 8F 10&nbsp; ?弿?弿?</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010053B0&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010053C0&nbsp;&nbsp; 10 0F 8F 8F 0F 0F 8F 8F 0F 0F 8F 0F 8F 0F 0F 10&nbsp; 弿弿??</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010053D0&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010053E0&nbsp;&nbsp; 10 0F 0F 0F 0F 8F 8F 0F 0F 8F 0F 8F 0F 8F 8F 10&nbsp; 弿??弿</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010053F0&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005400&nbsp;&nbsp; 10 8F 8F 8F 0F 0F 8F 8F 8F 8F 8F 8F 0F 8F 0F 10&nbsp; 弿?弿弿弿?</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005410&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005420&nbsp;&nbsp; 10 8F 0F 0F 8F 8F 0F 8F 0F 0F 8F 8F 8F 0F 0F 10&nbsp; ?弿?弿?</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005430&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005440&nbsp;&nbsp; 10 0F 8F 0F 0F 0F 0F 0F 0F 8F 0F 0F 0F 8F 8F 10&nbsp; ??弿</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005450&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005460&nbsp;&nbsp; 10 8F 8F 8F 8F 0F 8F 0F 8F 0F 8F 0F 8F 0F 8F 10&nbsp; 弿弿?????</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005470&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005480&nbsp;&nbsp; 10 8F 8F 8F 0F 0F 0F 8F 0F 0F 8F 0F 0F 8F 8F 10&nbsp; 弿???弿</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005490&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010054A0&nbsp;&nbsp; 10 0F 8F 8F 0F 0F 0F 0F 0F 8F 0F 0F 8F 0F 8F 10&nbsp; 弿???</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010054B0&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010054C0&nbsp;&nbsp; 10 8F 8F 0F 0F 8F 8F 8F 0F 8F 8F 8F 8F 0F 8F 10&nbsp; 弿弿?弿弿?</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010054D0&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010054E0&nbsp;&nbsp; 10 8F 8F 0F 8F 0F 0F 8F 8F 8F 0F 8F 0F 8F 8F 10&nbsp; 弿?弿??弿</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010054F0&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005500&nbsp;&nbsp; 10 8F 8F 8F 0F 8F 0F 0F 0F 8F 8F 0F 8F 8F 0F 10&nbsp; 弿??弿弿</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005510&nbsp;&nbsp; 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F 0F&nbsp; </span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01005520&nbsp;&nbsp; 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10&nbsp; </span><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span></p></blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">从内存图可以看出，是每隔一行进行填充 ，因此可以总结数组的遍历公式</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">具体的某个x,y坐标下的值= 数组基址+ 高&lt;&lt;5(也就是+32，每隔一行进行填充)+x</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">而且通过填充的时候add eax ,2 等类似的消息可以看出，边界应该是0，内容是从1开始的，循环的时候要注意</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">现在去分析一下窗口回调函数(主要是找怎么把鼠标按下的点转换成数组下标的方法)</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">祭出 大微软的 spy ++<br><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">od直接定位到这个回调函数的位置</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">主要是想看看怎么把鼠标点击的屏幕坐标转换成数组下标的</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">定位之后发现 代码真长，可能超过300行了QAQ</span></p><blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BC9&nbsp; /.&nbsp; 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 回调函数</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BCA&nbsp; |.&nbsp; 8BEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EBP,ESP</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BCC&nbsp; |.&nbsp; 83EC 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUB ESP,0x40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 开辟局部空间</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BCF&nbsp; |.&nbsp; 8B55 0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EDX,[ARG.2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; edx&nbsp; =uMsg</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BD2&nbsp; |.&nbsp; 8B4D 14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV ECX,[ARG.4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; edx = lParam</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BD5&nbsp; |.&nbsp; 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 保存寄存器环境</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BD6&nbsp; |.&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 保存寄存器环境</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BD7&nbsp; |.&nbsp; 33DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EBX,EBX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ebx = 0</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BD9&nbsp; |.&nbsp; 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 保存寄存器环境</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BDA&nbsp; |.&nbsp; BE 00020000&nbsp;&nbsp; MOV ESI,0x200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; esi =0x200，通过下面确定esi是wm_mousemove</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BDF&nbsp; |.&nbsp; 43&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INC EBX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ebx =1</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BE0&nbsp; |.&nbsp; 33FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EDI,EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; edi =0</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BE2&nbsp; |.&nbsp; 3BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CMP EDX,ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; edx和esi进行比较，也就是uMsg和0x200进行比较，现在可以确定esi是WM_MOUSEMOVE</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BE4&nbsp; |.&nbsp; 0F87 75030000 JA winmine.01001F5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 大于跳到这个地方去，需要看LBUTTONDOWN或LBUTTONUP的处理</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BEA&nbsp; |.&nbsp; 0F84 95040000 JE winmine.01002085&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 等于mousemove跳转到这个地方，小于的话就继续下面的代码，因为LBUTTONDOWN和LBUTTONUP都大于0x200,暂时先不看下面的了</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BF0&nbsp; |.&nbsp; B8 00010000&nbsp;&nbsp; MOV EAX,0x100</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BF5&nbsp; |.&nbsp; 3BD0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CMP EDX,EAX</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BF7&nbsp; |.&nbsp; 0F87 5C010000 JA winmine.01001D59</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001BFD&nbsp; |.&nbsp; 0F84 97000000 JE winmine.01001C9A</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C03&nbsp; |.&nbsp; 8BC2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EAX,EDX</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C05&nbsp; |.&nbsp; 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DEC EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; Switch (cases 2..47)</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C06&nbsp; |.&nbsp; 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DEC EAX</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C07&nbsp; |.&nbsp; 74 76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JE SHORT winmine.01001C7F</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C09&nbsp; |.&nbsp; 83E8 04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUB EAX,0x4</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C0C&nbsp; |.&nbsp; 74 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JE SHORT winmine.01001C65</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C0E&nbsp; |.&nbsp; 83E8 09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUB EAX,0x9</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C11&nbsp; |.&nbsp; 74 2B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JE SHORT winmine.01001C3E</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C13&nbsp; |.&nbsp; 83E8 38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUB EAX,0x38</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C16&nbsp; |.&nbsp; 0F85 8D050000 JNZ winmine.010021A9</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C1C&nbsp; |.&nbsp; F605 00500001&gt;TEST BYTE PTR DS:[0x1005000],0x8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; Case 47 of switch 01001C05</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01001C23&nbsp; |.&nbsp; 0F85 80050000 JNZ winmine.010021A9</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">....</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">代码省略</span></p></blockquote><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">只贴上回调函数的图了，其实还分析了很多的函数来掌握流程</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">通过</span></p><blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">01002099&nbsp; |.&nbsp; 8B45 14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EAX,[ARG.4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 从这里的代码开始，下面的就是坐标转成数组的公式了eax = lparam</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">0100209C&nbsp; |.&nbsp; C1E8 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHR EAX,0x10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax 右移16位，相当于eax&nbsp; =(HIWORD)lparam</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">0100209F&nbsp; |.&nbsp; 83E8 27&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUB EAX,0x27&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax（HIWORD的lParam）-0x27</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010020A2&nbsp; |.&nbsp; C1F8 04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SAR EAX,0x4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax算数右移4位</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010020A5&nbsp; |.&nbsp; 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; eax 入栈</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010020A6&nbsp; |.&nbsp; 0FB745 14&nbsp;&nbsp;&nbsp;&nbsp; MOVZX EAX,WORD PTR SS:[EBP+0x14]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 入栈的第四个参数，就是lparam，eax = （LOWORD）lparam</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010020AA&nbsp; |.&nbsp; 83C0 04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADD EAX,0x4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; (LOWROD)lparam 加0x4</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010020AD&nbsp; |.&nbsp; C1F8 04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SAR EAX,0x4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 然后右移4为</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);letter-spacing: normal;font-size: 12px;">010020B0&nbsp; |.&nbsp; 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 找到，这个地方就是转换为数组的下标了</span></p></blockquote><p><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">这几行的汇编代码可以看出，再LBUTTONDOWN消息中，通过lParam的高低分分别获得y,x轴坐标<br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">然后通过公式转换为具体的数组下标，转换方式如下</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span></p><blockquote><pre class=""><p><span style="font-size: 12px;letter-spacing: normal;">&nbsp; &nbsp;//首先获取x和y轴的坐标
 &nbsp; &nbsp; &nbsp; &nbsp;WORD xPos = GET_X_LPARAM(lParam);
 &nbsp; &nbsp; &nbsp; &nbsp;WORD yPos = GET_Y_LPARAM(lParam);
 &nbsp; &nbsp; &nbsp; &nbsp;//然后进行转换

 &nbsp; &nbsp; &nbsp; &nbsp;//y轴转换
 &nbsp; &nbsp; &nbsp; &nbsp;yPos -= 0x27;
 &nbsp; &nbsp; &nbsp; &nbsp;yPos /= 16;


 &nbsp; &nbsp; &nbsp; &nbsp;//x轴转换
 &nbsp; &nbsp; &nbsp; &nbsp;xPos += 0x4;
 &nbsp; &nbsp; &nbsp; &nbsp;xPos /= 16;</span></p></pre></blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"></span><br></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">地图填充的公式和屏幕坐标转换为数组下标的方式已经找到了，</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">总结一下找到的数据:</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><ul style="margin-left: 8px;margin-right: 8px;" class="list-paddingleft-2"><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">数组基地址：0x1005340</span></p></li><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">高度基地址：0x10056A8</span></p></li><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">宽度基地址： 0x10056AC</span></p></li><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">地雷数基地址： 0x10056A4</span></p></li><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">查找具体某个数组下标中内容的公式：数组基址+ 高&lt;&lt;5(也就是+32，每隔一行进行填充)+宽</span></p></li><li><p><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">坐标与数组下标转换方法在上面</span></p></li></ul><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">开写</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><h2 style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 18px;"><strong><span style="letter-spacing: 2px;color: rgb(0, 81, 171);">DLL代码</span></strong></span></h2><hr><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><strong><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">MFC dll 静态编译</span></strong></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="color: rgb(79, 79, 79);font-size: 12px;letter-spacing: normal;">// MFCSAOLEI.cpp : 定义 DLL 的初始化例程。<br>//<br><br>#include "stdafx.h"<br>#include "MFCSAOLEI.h"<br>#include &lt;windows.h&gt;<br>#include &lt;minwindef.h&gt;<br>#include &lt;Windef.h&gt;<br><br>#pragma once<br>#ifdef _DEBUG<br>#define new DEBUG_NEW<br>#endif<br><br>//<br>//TODO: &nbsp;如果此 DLL 相对于 MFC DLL 是动态链接的，<br>// &nbsp; &nbsp; &nbsp; &nbsp;则从此 DLL 导出的任何调入<br>// &nbsp; &nbsp; &nbsp; &nbsp;MFC 的函数必须将 AFX_MANAGE_STATE 宏添加到<br>// &nbsp; &nbsp; &nbsp; &nbsp;该函数的最前面。<br>//<br>// &nbsp; &nbsp; &nbsp; &nbsp;例如: <br>//<br>// &nbsp; &nbsp; &nbsp; &nbsp;extern "C" BOOL PASCAL EXPORT ExportedFunction()<br>// &nbsp; &nbsp; &nbsp; &nbsp;{<br>// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AFX_MANAGE_STATE(AfxGetStaticModuleState());<br>// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 此处为普通函数体<br>// &nbsp; &nbsp; &nbsp; &nbsp;}<br>//<br>// &nbsp; &nbsp; &nbsp; &nbsp;此宏先于任何 MFC 调用<br>// &nbsp; &nbsp; &nbsp; &nbsp;出现在每个函数中十分重要。 &nbsp;这意味着<br>// &nbsp; &nbsp; &nbsp; &nbsp;它必须作为函数中的第一个语句<br>// &nbsp; &nbsp; &nbsp; &nbsp;出现，甚至先于所有对象变量声明，<br>// &nbsp; &nbsp; &nbsp; &nbsp;这是因为它们的构造函数可能生成 MFC<br>// &nbsp; &nbsp; &nbsp; &nbsp;DLL 调用。<br>//<br>// &nbsp; &nbsp; &nbsp; &nbsp;有关其他详细信息，<br>// &nbsp; &nbsp; &nbsp; &nbsp;请参阅 MFC 技术说明 33 和 58。<br>//<br><br>// CMFCSAOLEIApp<br>BEGIN_MESSAGE_MAP(CMFCSAOLEIApp, CWinApp)<br>END_MESSAGE_MAP()<br><br><br>// CMFCSAOLEIApp 构造<br><br>CMFCSAOLEIApp::CMFCSAOLEIApp()<br>{<br>&nbsp;&nbsp; &nbsp;// TODO: &nbsp;在此处添加构造代码，<br>&nbsp;&nbsp; &nbsp;// 将所有重要的初始化放置在 InitInstance 中<br>}<br><br><br>// 唯一的一个 CMFCSAOLEIApp 对象<br><br>CMFCSAOLEIApp theApp;<br><br>//扫雷窗口句柄<br>HWND g_hWnd =NULL;<br><br>//旧的回调函数的<br>WNDPROC g_oldProc =NULL;<br><br><br>BYTE *g_BaseOfArray = (BYTE*)0x1005340;<br>DWORD *g_BaseOfHight= (DWORD*)0x10056A8;<br>DWORD *g_BaseOfWidth &nbsp;=(DWORD*)0x10056AC;<br>DWORD *g_BaseOfLandmine =(DWORD*)0x10056A4;<br><br><br>//是不是要写一个函数，用来获取<br><br>//自定义回调函数<br>LRESULT WINAPI CustomWinProc(<br>&nbsp;&nbsp; &nbsp;_In_ &nbsp;HWND hWnd,<br>&nbsp;&nbsp; &nbsp;_In_ &nbsp;UINT Msg,<br>&nbsp;&nbsp; &nbsp;_In_ &nbsp;WPARAM wParam,<br>&nbsp;&nbsp; &nbsp;_In_ &nbsp;LPARAM lParam<br>)<br>{<br>&nbsp;&nbsp; &nbsp;//用来获取地图的信息<br>&nbsp;&nbsp; &nbsp;int * pMapArray = new int[(*g_BaseOfHight)* (*g_BaseOfWidth)]{};<br><br>&nbsp;&nbsp; &nbsp;//进行数组遍历<br>&nbsp;&nbsp; &nbsp;//主要作用，保留<br>&nbsp;&nbsp; &nbsp;for (DWORD y =1;y&lt;*g_BaseOfHight+1;y++)<br>&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;for (DWORD x = 1;x&lt;*g_BaseOfWidth+1;x++)<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BYTE code = *(BYTE*)(g_BaseOfArray + y * 32+x);<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//然后判断是不是地雷<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (code ==0x8F)<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//说明是地雷<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pMapArray[(y - 1)*(*g_BaseOfWidth)+(x-1)] = 0x8f;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pMapArray[(y - 1)*(*g_BaseOfWidth) + (x - 1)] = 0xf;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp;}<br><br>&nbsp;&nbsp; &nbsp;//移动鼠标的设置<br>&nbsp;&nbsp; &nbsp;if (Msg == WM_MOUSEMOVE)<br>&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/*<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;功能实现要求：<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;实现能在窗口</span></p></blockquote><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);"><br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">dll 注入代码就不贴了</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">看一下效果图 ：标题栏显示坐标并提示有无雷，F5 一键扫雷</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8FsQQg9xDV51JYZeKbuMsWj4clzKIjCI3qC95Ayo9SCBoLzicTSrNkhfskqt2gOOwapsaWuOPI0EibA/0?wx_fmt=jpeg" style="max-width: 100%; cursor: pointer; width: 754px !important; height: 543.65px !important;"><br><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">最后：迷之logo<br></span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">&nbsp;</span></p><p style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;letter-spacing: 2px;color: rgb(79, 79, 79);">//不知道图床正常加载了没</span></p><p><br></p><p><br></p><p><br></p><section label="Copyright © 2014 playhudong All Rights Reserved." style="max-width: 100%;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8G9B6YFlthnv1h3cWDDXGAmK9wQfy6pod114tTuOSIFVeVd0vd1PEwicksgBGmxL0iaC0icX7B9EQzNg/640?wx_fmt=png" style="margin-right: auto; margin-left: auto; display: block; box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 160px !important; height: 8.44575px !important;"></section><p><br></p><p><br></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;">本文由看雪论坛<strong style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"> 八岛 </strong><span class=""></span>原创<br></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;">转载请注明来自看雪社区</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></span></p><p style="margin: 15px 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;">热门阅读</span></strong></p><ul class="list-paddingleft-2" style="margin-left: 8px;margin-right: 8px;"><li><p style="max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-top: 10px;margin-bottom: 10px;"><span style="max-width: 100%;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458286878&amp;idx=2&amp;sn=53232580388ef2fe4972101940760706&amp;chksm=b1814b9486f6c282fee0d30c3065f9ab5fc6e5e28624387aa5f832cd7bdbba27065b16ff7534&amp;scene=21#wechat_redirect" target="_blank">Windows Defender漏洞防护：减少针对下一代恶意软件的攻击面</a></span></p></li><li><p style="max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-top: 10px;margin-bottom: 10px;"><span style="max-width: 100%;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458286374&amp;idx=1&amp;sn=2f19441ba2cd62da0673de80fd1e35ab&amp;chksm=b18149ac86f6c0ba96d970d3061b50c40bfaecd5b6c95ca6e8c9a9d73f7adb3483a8fb996188&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">CVE-2016-7202：Overflow in Array.reverse</a></span></p></li><li><p style="max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-top: 10px;margin-bottom: 10px;"><span style="max-width: 100%;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458286339&amp;idx=2&amp;sn=41ec5243a1b0dedddd5d6d50caf338a7&amp;chksm=b181498986f6c09f777920950a12e1fea9d7eabe2c3514990539222d89c9651308cdc19d908a&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">堆溢出-House of orange 学习笔记</a></span></p></li><li><p style="max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-top: 10px;margin-bottom: 10px;"><span style="max-width: 100%;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458286275&amp;idx=1&amp;sn=ea6f6ae5268b16915162efede76e850d&amp;chksm=b181484986f6c15f123019128d5c28cb75c74795486957ba4848c00d9e1c35a44cb65e622b08&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">MSWord-用字段代码混淆</a></span></p></li><li><p style="max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-top: 10px;margin-bottom: 10px;"><span style="max-width: 100%;color: rgb(63, 63, 63);box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458286843&amp;idx=1&amp;sn=15e3d1aa8ae418cc5ed6010b390388b6&amp;chksm=b1814a7186f6c367a24033a297edc3fe2275334f45fd0b944bb606dc449e027beb1b4bc6997d&amp;scene=21#wechat_redirect" target="_blank">htaccess文件的利用技巧</a></span></p></li></ul><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;">点击阅读原文/read，</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;">更多干货等着你~</span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;color: rgb(63, 63, 63);letter-spacing: 1px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"></span></p><p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;color: rgb(62, 62, 62);font-size: 16px;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;"><img src="https://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HTpGlibXdQ4YIynJnSjWwOjSroH8JkP00Cpl0TvGwSCibJpPmSmcartSbQUfodq49ulaLk1Yicrem3A/640?wx_fmt=jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 542px !important; height: 136.065px !important;"></p><p><br></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1512886045&src=3&ver=1&signature=0dsH*cvrb7sDcdE*f0PtKJTfSmWmpGSr1bt6eLQusWUeX1D3PeY-hy0sLVqqzj8ewzefSEoH9llGPntsMnS0FPyDxwp9BBUgOfdh7NBROn7EXZ0-77pbh-Uij042xcUHOMbdf2tjl3nVQ40z49toy-nGghbByXf9yvJFKJrpuUs=">微信地址</a> | <a href="https://bbs.pediy.com/thread-222944.htm">阅读原文</a>
{% endraw  %}

