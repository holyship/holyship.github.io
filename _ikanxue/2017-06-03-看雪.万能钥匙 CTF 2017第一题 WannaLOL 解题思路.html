---
title: 看雪.万能钥匙 CTF 2017第一题 WannaLOL 解题思路
author: 看雪学院
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1496829841&src=3&ver=1&signature=IbkGB-IUv3NGRNGRf6IuJDEcuRy1*zESqpfOL5NuObERGQ*gbLaFfQ8X2IuMqNyfrhAtNGHPvT-wKPXl9IJKjOpnMQNm3fPORJ3kr42g9*cUqSOuL3GsjiC069P11biudG5VTDf6pl1U3FbiKsSHkGWjsH9hV4KdJKKhkjSAke4=
date: '2017-06-03 00:00:00 +0000'

---

{% raw  %}
<section label="小黄人科技" style="margin: 5px 0px 0px; border-width: medium medium medium 10px; border-color: currentcolor currentcolor currentcolor rgb(233, 233, 233); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-style: none none none solid; padding: 10px; font-size: 16px; line-height: 25px; color: rgb(153, 153, 153); background-color: rgb(243, 243, 243); box-shadow: 1px 1px 2px rgb(153, 153, 153);"><span style="font-size: 15px; color: rgb(63, 63, 63);">本次看雪 CTF 2017 比赛共有 15 题，第一题是一个普通的入门级的 CrackMe，主要是降低参与门槛，鼓励更多的人员参与比赛中来，接下来的 14 题，思路都不重复，需要攻击者有较强的知识面。 第一题是个 Windows 32 位程序，无壳、无 VM、无密码学的三无CrackMe，主要是考察浮点运算分析能力。</span></section><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><section label="Copyright Reserved by PLAYHUDONG." style="white-space: normal; border-width: medium medium medium 10px; border-style: none none none solid; border-color: currentcolor currentcolor currentcolor rgb(253, 208, 0); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; margin: 5px 0px 0px; padding: 10px; font-size: 14px; line-height: 25px; font-family: arial,helvetica,sans-serif; text-shadow: 0px 1px 0px rgb(34, 95, 135); color: rgb(255, 255, 255); border-radius: 4px; box-shadow: 2px 2px 4px rgb(153, 153, 153); background-color: rgb(55, 57, 57);"><span style="font-size: 16px;">下面选取一位坛友 <strong>missdiog</strong> 的解题思路，与大家分享！</span></section><p class=""><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">1. 位数固定为 4 位。前面 2 位为 15：</span></p><p><span style="font-size: 15px;"></span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8HeITaKZ4ia1yZqDFpI1U8icdOvYVqgjV1zoFMK2IGvqVCHA62lMVBLBlPfx38tibibOTo1zMjxQLeyeQ/0?wx_fmt=png" style="width: 558px !important; height: 386px !important; visibility: visible !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><hr><p><br></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8HeITaKZ4ia1yZqDFpI1U8icdRTYXCbDQABYf1oddHMPUllSTg4onibretey4xaqEXelGdlq3CJRnliaQ/0?wx_fmt=png" style="width: 625px !important; height: 499px !important;"><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2. Sn 表示第 N 位数：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">KEY 的算法为：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">(S3-0)-((S1-0)/(S2-0))*(S4-0)*16=386</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">S1 S2 为已知，简化为：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">(s3-0.2)*s4=24</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">解之：S3 S4 为 55</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">合并 KEY 为 1555。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="font-size: 15px;"></span></p><hr><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="color: rgb(255, 104, 39); font-size: 15px;">第一道题有 <strong>300</strong> 位朋友都破解了，非常不错哦！</span><br><span style="font-size: 15px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="color:#ff6827"><span style="font-size: 15px;">现在我们来关注一下比赛赛况～，目前攻击方排名如下：</span></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="color:#ff6827"><span style="font-size: 15px;"></span></span></p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8E5r3vibCslj0xWbeTVBWwptnjCgvcMtibtyLhwnAejjkeDZHOkkmfRO5wLUe4kDeibIGeOruTft5O5A/0?wx_fmt=png" style="width: 324px !important; height: 390px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="color:#ff6827"><span style="font-size: 15px;">第二题，难度加大，目前已有一位选手破解成功</span></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="color:#ff6827"><span style="font-size: 15px;"></span></span></p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8E5r3vibCslj0xWbeTVBWwptEYy4rkKU0Kz48Mtj5miaQMLa7ZzFeBng9gSpuF80gice0642to9aRNEA/0?wx_fmt=png" style="width: 334px !important; height: 333px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="font-size: 15px; color: rgb(255, 104, 39);">最后感谢 WiFi 万能钥匙安全应急响应中心的赞助支持，</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="font-size: 15px; color: rgb(255, 104, 39);">接下来的比赛大家要加油啦！↖(^ω^)↗</span><span style="font-size: 15px;"><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="font-size: 15px; color: rgb(255, 104, 39);">丰厚奖金等着你哦！</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_gif/1UG7KPNHN8HeITaKZ4ia1yZqDFpI1U8icdXmt2Bhf2K8rC5m1zORLgt6WyiaKGlffsn6R2r7Y8apXicbG4QToRSflg/0?wx_fmt=gif" style="width: 240px !important; height: 240px !important;"></p><p style="text-align: center;"><br></p><p><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><section class="" style="max-width: 100%; box-sizing: border-box; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; background-color: rgb(255, 255, 255); word-wrap: break-word !important;"><section class="" style="margin-top: 10px; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: middle; width: 589.594px; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; color: rgb(222, 113, 98); word-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important;">赞助商<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></p></section></section></section></section></section></section><p style="max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></p><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; background-color: rgb(255, 255, 255); word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important;">上海连尚网络科技有限公司成立于 2013 年，是一家专注于提供免费上网和内容服务的移动互联网企业。连尚网络自主研发的核心产品 WiFi 万能钥匙，以分享经济的模式，通过云计算和大数据技术，利用热点主人分享的闲置WiFi资源，为用户提供免费、稳定、安全的上网服务，以帮助更多的人上网，找到属于他们的机会，改变自己的命运。</span></span></p><p><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important;"><br></span></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><hr style="max-width: 100%; color: rgb(62, 62, 62); font-size: 16px; line-height: 25.6px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><p style="max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; line-height: 25.6px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282630&amp;idx=1&amp;sn=61fcbc708235dec5d7897a0d7c315756&amp;chksm=b1815a0c86f6d31a50ba1f9a39d876e28f2c71096100b28e961df185f7be94ec77b9199efd51&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">等你来挑战！| 看雪 CTF 2017 攻击篇</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282621&amp;idx=1&amp;sn=15f5bc0fa2b0b34ae241668b23a3939b&amp;chksm=b1815af786f6d3e1fd4bad2c336d725ec600551a6477bbc4c6af93167074ac83873aeba89938&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">【终于等到你！】看雪 CTF 2017</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283156&amp;idx=4&amp;sn=20dda476fe79caf3ee0a9a7d28b74ff4&amp;chksm=b1815c1e86f6d5082fac2309a7e81f33b29c97278bf69614e8aed6a611407695a361c1014e58&amp;scene=21#wechat_redirect" target="_blank">使用outlook留后门并且维持访问</a><br></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282822&amp;idx=1&amp;sn=38aff0b2a56a5a5e592f08c19c7aed15&amp;chksm=b1815bcc86f6d2da2761b4878053b0641a902d7dbd7f8105a431b8769182034ca7c8350f502b&amp;scene=21#wechat_redirect" target="_blank">新手逆向学习--Win7 下 64 位扫雷逆向以及辅助制作</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283114&amp;idx=3&amp;sn=fc763099faeb53bb8407bce865b403c1&amp;chksm=b1815ce086f6d5f60970b9c550518d07199c77e380cee90791c91a6ade3f5abd2b4c3f9588cd&amp;scene=21#wechat_redirect" target="_blank" style="font-size: 15px; text-decoration: none;"><span style="font-size: 15px;">CVE-2012-0158 两种 PoC 分析</span></a></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">......<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">更多优秀文章，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HeITaKZ4ia1yZqDFpI1U8icd14Ea3PO3LYThHvZ887eob5Ka9k3qJD2ialAI7WV6KThEzPoadyNsvtA/0?wx_fmt=jpeg" style="width: 770px !important; height: 513.013px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪论坛：http://bbs.pediy.com/<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">商务合作<span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px;"></span>：<span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px;">wsc@kanxue.com</span></span></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1496829841&src=3&ver=1&signature=IbkGB-IUv3NGRNGRf6IuJDEcuRy1*zESqpfOL5NuObERGQ*gbLaFfQ8X2IuMqNyfrhAtNGHPvT-wKPXl9IJKjOpnMQNm3fPORJ3kr42g9*cUqSOuL3GsjiC069P11biudG5VTDf6pl1U3FbiKsSHkGWjsH9hV4KdJKKhkjSAke4=">微信地址</a> | <a href="http://ctf.pediy.com/">阅读原文</a>
{% endraw  %}

