---
title: 看雪.WiFi万能钥匙 CTF 2017第四题 点评及解题思路
author: 看雪学院
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1497276357&src=3&ver=1&signature=aHg31JU*BGTH2xoiR2ftYl-Za4Tj4F9-ES3676R*Lz9d4Q2l*LGr82CxAl3XSPMV3mvK5fPXVrwmme1QdzvmJc8v3qJRJDVqQwvddLl2da89s5gE1Czy6fVFFLjkHmTT9fIAugY2kO3zrktpwA9dJlmxUgbC61UXv8jQY7x6OpQ=
date: '2017-06-09 00:00:00 +0000'

---

{% raw  %}
<section style="background-color: rgb(255, 255, 255); box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="font-size: 57.6px; text-align: center; margin: 20px 0% 10px; box-sizing: border-box;"><section class="" style="box-sizing: border-box; display: inline-block; vertical-align: bottom; margin: auto; width: 3em; height: 3em; border-radius: 100%; background-image: url(&quot;http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRg1BxVlUDT2UxwH2iaMyEVMic11CNtQf051pjjDJ0kGpxdRn8R2UEsNGA/0?wx_fmt=png&quot;); background-position: center center; background-repeat: no-repeat; background-size: cover; border-style: solid; border-width: 4px; border-color: rgb(255, 239, 183); font-size: 57.6px;"><section class="" style="width: 100%; height: 100%; overflow: hidden; box-sizing: border-box; font-size: 57.6px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRg1BxVlUDT2UxwH2iaMyEVMic11CNtQf051pjjDJ0kGpxdRn8R2UEsNGA/0?wx_fmt=png" style="opacity: 0; box-sizing: border-box; font-size: 57.6px; width: 100% !important; height: auto !important; visibility: visible !important;"></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="transform: translate3d(0px, 0px, 0px); text-align: center; box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; vertical-align: middle; width: 5%; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: right; font-size: 16px; color: rgb(171, 211, 224); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 16px;">-</p></section></section></section></section><section class="" style="display: inline-block; vertical-align: middle; width: 10%; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: left; font-size: 16px; color: rgb(241, 215, 124); box-sizing: border-box;"><p style="text-align: center; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 16px;">看雪 CTF<br style="box-sizing: border-box; font-size: 16px;"></p></section></section></section></section><section class="" style="display: inline-block; vertical-align: middle; width: 5%; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: left; font-size: 16px; color: rgb(171, 211, 224); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 16px;">-<br></p></section></section></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px; text-align: center;"><section class="" style="display: inline-block; width: 90%; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 10px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="font-size: 14px; color: rgb(158, 192, 199); letter-spacing: 2px; line-height: 2; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;"><span style="line-height: 2; box-sizing: border-box; color: rgb(64, 118, 0); font-size: 15px;">今天周五了！看雪CTF 2017 比赛进行至第四题</span></p><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;"><span style="line-height: 2; box-sizing: border-box; color: rgb(64, 118, 0); font-size: 15px;">截止至今天中午12点，第四题破解人数为14人！</span></p><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;"><span style="line-height: 2; box-sizing: border-box; font-size: 14px;"><br></span></p><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;"><span style="line-height: 2; box-sizing: border-box; font-size: 14px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRYiaWrdbgro9FBia7Y5iba9KLNDGdTrxA8iascgCBBNJeru2dgKFf08EMuw/0?wx_fmt=png" style="width: auto !important; height: auto !important; visibility: visible !important;"><br></p><p style="margin-bottom: 10px; margin-top: 10px;"><span style="color: rgb(64, 118, 0); font-size: 15px;">攻击方排名前十名稍有变动，比赛排名有人升、有人降。</span></p><p style="margin-bottom: 10px; margin-top: 10px;"><span style="color: rgb(64, 118, 0); font-size: 15px;">有两位选手表现格外引人关注，<br></span></p><p style="margin-bottom: 10px; margin-top: 10px;"><span style="color: rgb(64, 118, 0); font-size: 15px;">loudy从第9名升至第5名！（鼓掌ing）</span></p><p style="margin-bottom: 10px; margin-top: 10px;"><span style="color: rgb(64, 118, 0); font-size: 15px;">NearJMP进入前十。</span><br></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRucx3q82J6Bs1WPwIBu2nfSiaE49vujqhdkYlkA9E6icEvNLzImIB8evA/0?wx_fmt=png" style="width: auto !important; height: auto !important; visibility: visible !important;"></p><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;"><span style="line-height: 2; box-sizing: border-box; font-size: 14px;"></span><span style="color: rgb(64, 118, 0); font-size: 15px;">六月骄阳似火，也抵不过选手们的热情。</span></p><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;"><span style="color: rgb(64, 118, 0); font-size: 15px;">大家继续加油！</span><span style="color: rgb(63, 63, 63); font-size: 15px;"><br></span></p><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;"><span style="font-size: 15px; color: rgb(64, 118, 0);">接下来我们来回顾一下第四题</span></p><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;"><span style="font-size: 15px; color: rgb(64, 118, 0);">看看看雪评委和出题者是怎么说的ヾ(๑╹◡╹)ﾉ"</span><span style="color: rgb(63, 63, 63); font-size: 15px;">。</span></p></section></section></section></section><p><br></p></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 16px;"><br style="box-sizing: border-box; font-size: 16px;"></p></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; transform: translate3d(0px, 0px, 0px); box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="background-color: rgb(91, 143, 76); color: rgb(247, 247, 247); font-size: 18px; padding-left: 5px; padding-right: 5px; margin-bottom: 4px; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 18px;"><span style="box-sizing: border-box; font-size: 18px;">看雪评委 netwind 点评</span>：</p></section><section style="border-top: 2px dotted rgb(202, 198, 198); width: 100%; box-sizing: border-box; font-size: 16px;"></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: justify; font-size: 15px; color: rgb(74, 96, 101); letter-spacing: 0px; line-height: 1.8; padding: 2px 0px; box-sizing: border-box;"><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;"><br style="box-sizing: border-box; font-size: 15px;"></p><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px; text-align: left;">作者设计了一个存在 double&nbsp;free&nbsp;和 uaf 漏洞的程序，攻击者需要利用 fastbin 的 malloc_consolidate 函数来造成 unlink，最后再布置栈构造 ropchain 即可完成攻击。作为一道漏洞挖掘和利用的题目，引起了大家广泛关注，成功破解该题人数达14人，并且漏洞利用各有千秋，甚至有人通过作者疏忽利用栈溢出破解了此题，攻防双方表现都非常精彩！</p></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="font-size: 15px; line-height: 1.75; letter-spacing: 0.5px; padding: 0px 1px; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;"><br style="box-sizing: border-box; font-size: 15px;"></p></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 10px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; width: 100%; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; transform: translate3d(0px, 0px, 0px); box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="background-color: rgb(91, 143, 76); color: rgb(247, 247, 247); font-size: 18px; padding-left: 5px; padding-right: 5px; margin-bottom: 4px; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 18px;">作者简介：</p></section><section style="border-top: 2px dotted rgb(202, 198, 198); width: 100%; box-sizing: border-box; font-size: 16px;"></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: justify; font-size: 15px; color: rgb(74, 96, 101); letter-spacing: 0px; line-height: 1.8; padding: 2px 0px; box-sizing: border-box;"><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;"><br style="box-sizing: border-box; font-size: 15px;"></p><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px; text-align: left;">Ree，大二在读，CTF比赛 Pwn 选手，兴趣广泛，热爱漏洞挖掘与利用。目前主要研究方向为二进制自动化分析。</p></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 16px;"><br style="box-sizing: border-box; font-size: 16px;"></p></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 10px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; width: 100%; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; transform: translate3d(0px, 0px, 0px); box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="background-color: rgb(91, 143, 76); color: rgb(247, 247, 247); font-size: 18px; padding-left: 5px; padding-right: 5px; margin-bottom: 4px; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 18px;">看雪 CTF2017 第四题设计思路<br></p></section><section style="border-top: 2px dotted rgb(202, 198, 198); width: 100%; box-sizing: border-box; font-size: 16px;"></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: justify; font-size: 15px; color: rgb(74, 96, 101); letter-spacing: 0px; line-height: 1.8; padding: 2px 0px; box-sizing: border-box;"><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;"><br style="box-sizing: border-box; font-size: 15px;"></p><section label="Copyright © 2016 playhudong All Rights Reserved." style="width: 100%; margin-top: 1em;"><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.7; margin-left: -7px;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.5; margin-left: -7px;"></section><p style="display: inline-block; margin-left: 5px;"><strong><span style="font-size: 16px;">考点</span></strong>：</p></section><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;">malloc_consolidate+unlink+rop</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;"><br></p><section label="Copyright © 2016 playhudong All Rights Reserved." style="width: 100%; margin-top: 1em;"><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.7; margin-left: -7px;"></section><span style="font-size: 16px;"><strong>&nbsp;运行环境</strong></span><strong>：</strong></section><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">1. amd64（作者本地测试为kali，远程测试环境为ubuntu16.04），无libc要求，已经上传远程测试libc</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;">2. 开启aslr</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;"><br></p><section label="Copyright © 2016 playhudong All Rights Reserved." style="width: 100%; margin-top: 1em;"><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.7; margin-left: -7px;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.5; margin-left: -7px;"></section><p style="display: inline-block; margin-left: 5px;"><span style="font-size: 16px;"><strong>编译方式</strong></span></p></section><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;">gcc -no-pie main.c -o main ; strip main</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;"><br></p><section label="Copyright © 2016 playhudong All Rights Reserved." style="width: 100%; margin-top: 1em;"><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.7; margin-left: -7px;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.5; margin-left: -7px;"></section><p style="display: inline-block; margin-left: 5px;"><strong><span style="font-size: 16px;">题目说明</span></strong></p></section><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">题目可以给出 bin 与 libc 供下载，也可以仅给出 bin 文件，通过查找 libc-db 的方式找到对应 libc 版本号（作为一只 pwn 狗，建议给出 libc，省去大家查 libc 的浪费的生命）</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;"><br></p><section label="Copyright © 2016 playhudong All Rights Reserved." style="width: 100%; margin-top: 1em;"><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.7; margin-left: -7px;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.5; margin-left: -7px;"></section><p style="display: inline-block; margin-left: 5px;"><span style="font-size: 16px;"><strong>设计思路：</strong></span></p></section><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;">1. 首先给用户输入姓名，此时以 malloc 一个 chunk 的方式存储用户的输入</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;">2. 给了 4 个功能，create、delete、edit、show，其中show功能无效</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRaSnsE4wFhfr37jtVZ3jXS5JBJ2wmZKLsHsALicDDs6Mdsf89KcaIbzg/0?wx_fmt=png" style="width: 446px !important; height: 274px !important;"></p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">3. create 函数可以申请一个小于 4096 字节的 chunk，并往里面写入数据，然后置flag位为1，同时用一个全局变量 number 来记录已申请的 chunk 个数，number不得大于4。</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">4. delete 函数可以 free 一个指针并置 flag 位为 0，但是不检查是否已经 free 这个指针。</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">5. edit 检查 flag 位，只能修改已经 flag 为 1 的 chunk。</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">6. 数据结构如下：</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQR42hRdIIZgFvwWIBz2VsWBCt9Pt38ukUiaic9YOJ9fG1YT59Lp29iaAbZQ/0?wx_fmt=png" style="width: 339px !important; height: 87px !important;"></p><section label="Copyright © 2016 playhudong All Rights Reserved." style="width: 100%; margin-top: 1em;"><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.7; margin-left: -7px;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.5; margin-left: -7px;"></section><p style="display: inline-block; margin-left: 5px;"><span style="font-size: 16px;"><strong>漏洞点</strong></span></p></section><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;">1. uaf，在dele一个指针后没有清零，可以再次 free 这个 freed 的指针。</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;">2. 漏洞什么的。</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;"><br></p><section label="Copyright © 2016 playhudong All Rights Reserved." style="width: 100%; margin-top: 1em;"><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.7; margin-left: -7px;"></section><section class="" style="width: 0px; height: 0px; border-top: 7px solid transparent; border-left: 12px solid rgb(78, 130, 247); border-bottom: 7px solid transparent; display: inline-block; opacity: 0.5; margin-left: -7px;"></section><p style="display: inline-block; margin-left: 5px;"><span style="font-size: 16px;"><strong>漏洞利用</strong></span></p></section><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">1. 主要利用 fastbin 的 malloc_consolidate 这个函数来造成 unlink，后面再布置栈构造 ropchain 即可。</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">2. 在申请 large bin 的时候，会将 freed fastbin 的 inuse 位清零，同时进行合并，将合并后的堆块放入 unsortbins 中。然后遍历 unsortbins，按照大小分别放入 smallbins 和 largebins 中。</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQR5GIkcw0BibUN1lyHNQVeX7XtiaiarkvPMUSibJ4gP0zy2hQU8IYE7nk36A/0?wx_fmt=png" style="width: 518px !important; height: 183px !important;"></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRC4ZjaATSibaf50yHYMtGuWMHBVQxMZ86C50ZdsMgRqLmDy9VibDBEfcQ/0?wx_fmt=png" style="width: 404px !important; height: 269px !important;"></p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">3. 这时利用 uaf，free 一个 fastbin，也就是我们刚才申请的 0x30 大小的块，将它链入 fastbins 的单向链表中。因为当我们从fastbins中分配不会置后一个 chunk 的 inuse位为1，但是由于之前的 malloc_consolidate 已经使得该 fastbin 的后一个 chunk 的 inuse 位为 0，所以造成一个矛盾，是的我们能够 unlink。</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRXfYG3bXtViaDSKQproAOgjthxBB1RibVm5nE5AbOzQfB3tCKjQ2TCl9Q/0?wx_fmt=png" style="width: 367px !important; height: 267px !important;"></p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">4. 分配一个 0x20 大小的 chunk，置后一个 chunk 的 presize 位为我们刚才分配的fastbin 的大小，为 unlink 做准备，0x20 会从之前合并的 smallbins 中切割，然后该 smallbins 移到 unsortbins 中，并成为 last_remainder。</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQR9Z6aicDmdWDbscggLT9owky030kcIKn4oGwNojuiaFsUx9XZyPe3D9RA/0?wx_fmt=png" style="width: 506px !important; height: 480px !important;"></p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">5. 修改 0x30 的 fastbin，并填充 unlink 的 payload，再在之后分配一个 smallbin 大小的 chunk，使得 unsortbin 中的 chunk 移到smallbins（因为 unsortbins 有一个 check，会检查第一个 chunk 的 bk 是否指向 unsortbin 的头），最后 delete 触发 unlink。</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQR7sRuHz4nWVS6MZK8EFU6f8UonrHOuvic1KIA0bE7q2mNHBXavuAecTg/0?wx_fmt=png" style="width: 743px !important; height: 409px !important;"></p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;">6. 接下来的事情就简单了，修改 fflush 的 got 表为 add rsp 8; ret 的 gadget，然后用rop 泄露 libc 基址，最后修改 free_got 为 system 即可。</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRksRrW6OetgVXPs12ibbX3sSjxFRvto6jAQ82QVDQnIqA3yMqG3z2jCA/0?wx_fmt=png" style="width: 733px !important; height: 174px !important;"></p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em;">7. free 一个事先写好 /bin/sh\0 的 chunk 拿 shell 即可。</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRJeDCFccAicW7NPapgpSc76rvmvUAic9pIJCo6DYkU6RQCybv8KO3YdRA/0?wx_fmt=png" style="width: 465px !important; height: 236px !important;"></p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">PS:<br style="box-sizing: border-box; font-size: 15px;"></p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">因为可以 malloc 任意大小，还有 uaf，漏洞略大，但已经尽力避免未预料解法了。</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">PPS：</p><p style="white-space: normal; margin: 15px 0px; padding: 0px; box-sizing: border-box; font-size: 15px; line-height: 1.75em; text-align: left;">好像国内的 CTF 还没见过考 malloc_consolidate的，也可能我比赛打的少了XD...</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRVkiaDdZ61iaIBjlWOJX56Wgg2E6icdGIicM2xnrmsrYRhibDq47kUD47ibfw/0?wx_fmt=png" style="width: 770px !important; height: 868.327px !important;"></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRFr14a84GSIeSTk0IiaRj0f8iagAxqbVOSCOwdfJzm0cxxqOnEakz2D3A/0?wx_fmt=png" style="width: 640px !important; height: 572px !important;"></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRm0U5LM95kBk81CzgEhLAHPh4PrLj9Q1G6kIlNsoYXricib7QQly3sp4g/0?wx_fmt=png" style="width: 585px !important; height: 119px !important;"></p><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;"><br></p></section></section></section></section></section></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 10px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; width: 100%; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; transform: translate3d(0px, 0px, 0px); box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; vertical-align: top; box-sizing: border-box; font-size: 16px;"><section class="" style="background-color: rgb(91, 143, 76); color: rgb(247, 247, 247); font-size: 18px; padding-left: 5px; padding-right: 5px; margin-bottom: 4px; box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 18px;">下面选取攻击者 BPG 的破解分析</p></section><section style="border-top: 2px dotted rgb(202, 198, 198); width: 100%; box-sizing: border-box; font-size: 16px;"></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 0px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: justify; font-size: 15px; color: rgb(74, 96, 101); letter-spacing: 0px; line-height: 1.8; padding: 2px 0px; box-sizing: border-box;"><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;"><span style="letter-spacing: 0px; box-sizing: border-box; font-size: 15px;"><br></span></p><p style="white-space: normal; margin: 0px; padding: 0px; box-sizing: border-box; font-size: 15px;"><span style="font-size: 18px; color: rgb(64, 118, 0);"><strong><span style="font-size: 18px; letter-spacing: 0px; box-sizing: border-box;">一、ALL</span></strong></span><span style="letter-spacing: 0px; box-sizing: border-box; font-size: 15px;"><br></span></p></section></section></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">这题也是一般堆溢出的流程，主要有下面几个操作：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">1. 创建</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRfgTBjUGFNiaEx1SP2jnX1AWOb3Rj0goTa3E0w1KtoprqjD2SC3OPOtw/0?wx_fmt=png" style="width: 520px !important; height: 543px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">这一段代码比较多，但可以看到问题还是存在的，size和cun都是可以通过输入负数，接着通过强类型转换`unsigned int`来转换成很大的整数来整形溢出。<br style="box-sizing: border-box; font-size: 16px;"><br style="box-sizing: border-box; font-size: 16px;"><span style="color: rgb(63, 63, 63); font-size: 16px;"><strong>2. 删除</strong></span></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRQ3vxibh6KrxWSXwJicpo7Rdia3IsEcDiaCqql4O5SuCQDK50HusOE9Nb0Q/0?wx_fmt=png" style="width: 600px !important; height: 143px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">可以看到这里也是存在问题的，删除之前没有判断块是否被删除了，所以应该可以构造`double-free`<br style="box-sizing: border-box; font-size: 16px;"><br style="box-sizing: border-box; font-size: 16px;"><span style="color: rgb(63, 63, 63); font-size: 16px;"><strong>3. 编辑</strong></span></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRCxCbsX23U19bCJuqUSMP1st6ZSOAqOmLQTPdU5iaWdh3Ficu9JbekzDg/0?wx_fmt=png" style="width: 607px !important; height: 194px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">这里就是正常的编辑，不过验证了块是否存在。<br style="box-sizing: border-box; font-size: 16px;"><br style="box-sizing: border-box; font-size: 16px;"><span style="font-size: 18px; color: rgb(64, 118, 0);"><strong>二、DOUBLE-FREE</strong></span></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">一年前做过一道`double-free`之后就再也没碰过了，这里正好把相关知识点再温习一下。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">堆结构如下，其中0,1,2,3表示一个单位长度。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQR9WGibpYTFWzvJXOy3fjtCY2pLak9T6UlnMiaCKHxcNPARqYXoNWY9D8Q/0?wx_fmt=png" style="width: 604px !important; height: 261px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">正常`unlink`的函数主要代码如下：</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQR0iaeQoSEHZkxTQ9z7r08fpRrbicjg6XC6voxIRJMfXJK8asiagaDPKpYg/0?wx_fmt=png" style="width: 576px !important; height: 174px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">如果能覆盖一个块的头部来达到控制其`bk`和`fd`的话，就能够成功修改任意地址的值了，但由于存在判断`FD-&gt;bk != P || BK-&gt;fd != P`，所以没法随便修改，这时就需要利用`double-free`了。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">首先判断是需要通过的，所以可以有下面两个等</span></p><blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(63, 63, 63); font-size: 14px;">FD-&gt;bk = P&nbsp;&nbsp; &lt;=&gt; FD+3 = P<br style="box-sizing: border-box; font-size: 16px;">BK-&gt;fd = P&nbsp;&nbsp; &lt;=&gt; BK+2 = </span><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">接着就是构造一个堆头满足这两个等式了</span></p><blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(63, 63, 63); font-size: 14px;">pre_size&nbsp;&nbsp;&nbsp;&nbsp; 0<br style="box-sizing: border-box; font-size: 16px;">size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chunk_size + 1 //这两个条件表示堆仍在使用中<br style="box-sizing: border-box; font-size: 16px;">fd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p_addr - 3<br style="box-sizing: border-box; font-size: 16px;">bk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p_addr - 2</span></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">那么就能得到绕过判断后能实现的效果</span></p><blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(63, 63, 63); font-size: 14px;">FD-&gt;bk = BK =&gt; P = BK = P - 2<br style="box-sizing: border-box; font-size: 16px;">BK-&gt;fd = FD =&gt; P = FD = P - 3</span><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">所以最后实现的效果是`P=P-3`。<br style="box-sizing: border-box; font-size: 16px;"><br style="box-sizing: border-box; font-size: 16px;">接着就是实现`double-free`的流程了，稍微盗一下图...</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1. 新建两个 chunk 分别为 chunk0 和 chunk1</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRSvicTQsdyR7qZESE4eC1sCx7RG3LuKhyt03L4LYhj5iambokHTyTUsAQ/0?wx_fmt=png" style="width: 561px !important; height: 157px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2. free 掉这两个块，第一块作为稍后 unlink 的块，另一块作为 free 的块</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">3. 新建一个块，这个块要能覆盖到 chunk1 的头部，从而伪造两个 chunk 的头，chunk0 的头部之前已经说过了，而 chunk1 需要欺骗操作系统 chunk0 是已经被free 了的，所以其头部应该如下</span></p><blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(63, 63, 63); font-size: 14px;">pre_size&nbsp;&nbsp;&nbsp;&nbsp; chunk0_size<br style="box-sizing: border-box; font-size: 16px;">size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chunk1_size</span></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">然后整体实现如下：</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQR7hVAG2uyiaHRMk9mBolMHiawtPMiabtdfmT0dpBBBSxF6h6eMW2k7wSOQ/0?wx_fmt=png" style="width: 570px !important; height: 174px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">4. 那么新建这个块就相当于是两个块了，然后我们 free chunk1，就能实现 unlink chunk0 从而使得 chunk0 的地址存放的值变成了 P-0x18</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">5. 接下来修改 chunk0 的值，修改的值为 0x18 个 padding，然后就能修改 chunk0 的地址的值了，这时修改成 free 的 GOT 表地址</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">6. 接下来再修改一次chunk0， 这次的值修改成 system 那么就会使得 free 的 GOT 表指向 system，接下来 free 的时候传入 /bin/sh 就能获取 shell 了<br style="box-sizing: border-box; font-size: 16px;"><br style="box-sizing: border-box; font-size: 16px;"><span style="color: rgb(64, 118, 0); font-size: 18px;"><strong>三、 EXP </strong></span><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">在调试 EXP 过程中出现了这样俩个问题，需要注意一下。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">第一个是这里的 P 指的是指向堆地址的指针，也就是`0x6020e0`，不要误以为是堆的地址哦。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">第二个在这里我是把`/bin/sh`写在第0个堆，而用2，3来进行`double-free`，主要原因是由于在调试的过程中发现把`/bin/sh`写后面会被系统发现`double-free`。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">具体EXP：</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRcNhuBkhrhTbaS9x40fqPopueJ4xHJy0GRkWZlsFJ7NZ02QMEGMIpFA/0?wx_fmt=png" style="width: 449px !important; height: 593px !important;"></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRepF8icRArpCBkTYXTZdEjvocIHoSHrCiaw9EXsX5KRFjjyh1Nibf9QqNA/0?wx_fmt=png" style="width: 770px !important; height: 494.354px !important;"></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRngTRR3oToGBJdBHxdfEiaSQN2QMJBO85OMBEicuOiatZJG6tPRUdJT87A/0?wx_fmt=png" style="width: 770px !important; height: 179.048px !important;"></p><p><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p></section></section></section></section><p style="line-height: 1.75em; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;"></span></p><hr><p style="line-height: 1.75em; text-align: center; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px;"></span><span style="font-size: 15px; color: rgb(255, 104, 39);">最后感谢 WiFi 万能钥匙安全应急响应中心的赞助支持，</span></p><p style="line-height: 1.75em; text-align: center; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px; color: rgb(255, 104, 39);">接下来的比赛大家一定要使出洪荒之力哦！↖(^ω^)↗</span><span style="font-size: 15px;"><br></span></p><p style="text-align: center; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px; color: rgb(255, 104, 39);">比心 </span><span style="font-size: 15px; color: rgb(255, 104, 39);">❤</span></p><p style="text-align: center; margin-top: 15px; margin-bottom: 15px;"><span style="font-size: 15px; color: rgb(255, 104, 39);"></span><span style="font-size: 15px;"></span></p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_gif/1UG7KPNHN8EQty9dlGFS4JkAqjOQeqQRibMSwqZjLIyQOpJm2U3X6ghZR2icO6Ok8ozlrcibCibECjkEmGyiaBegZBw/0?wx_fmt=gif" style="width: 240px !important; height: 240px !important;"></p><p><br></p><p><br></p><section label="Copyright Reserved by PLAYHUDONG." style="border-width: 0px; border-style: none; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; margin: 1em 0px; padding: 0px;"><section style="margin-left: 1em; line-height: 1.4;"><span style="padding: 0.2em 0.5em; border-radius: 0.3em; color: white; font-size: 1em; text-align: center; background-color: rgb(102, 102, 102);"><span class="" style="font-size: 1em; font-family: inherit; font-style: normal; font-weight: inherit; text-align: inherit; text-decoration: inherit; color: rgb(255, 255, 255);">赞助商</span></span></section><section class="" style="margin-top: -0.7em; border-width: 1px; border-style: solid; border-color: rgb(192, 200, 209); -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-radius: 0.4em; color: rgb(51, 51, 51); font-size: 1em;"><section style="padding: 1.4em 1em 1em;"><section style="font-size: 1em; font-family: inherit; font-style: normal; font-weight: inherit; text-align: inherit; text-decoration: inherit; color: rgb(51, 51, 51);"><p><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">上海连尚网络科技有限公司成立于
 2013 年，是一家专注于提供免费上网和内容服务的移动互联网企业。连尚网络自主研发的核心产品 WiFi 
万能钥匙，以分享经济的模式，通过云计算和大数据技术，利用热点主人分享的闲置WiFi资源，为用户提供免费、稳定、安全的上网服务，以帮助更多的人上网，找到属于他们的机会，改变自己的命运。</span></span></p></section></section></section></section><p><br></p><p><br></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><hr style="max-width: 100%; color: rgb(62, 62, 62); font-size: 16px; line-height: 25.6px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><p style="max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; line-height: 25.6px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282630&amp;idx=1&amp;sn=61fcbc708235dec5d7897a0d7c315756&amp;chksm=b1815a0c86f6d31a50ba1f9a39d876e28f2c71096100b28e961df185f7be94ec77b9199efd51&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">等你来挑战！| 看雪 CTF 2017 攻击篇</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283303&amp;idx=1&amp;sn=9e39d732ef0a0615971b1f0814498b1a&amp;chksm=b1815dad86f6d4bbcbfe01f630a656c4975e709ef944c21d364f185ffb33aae80e677ddc23f4&amp;scene=21#wechat_redirect" target="_blank">看雪.WiFi万能钥匙 CTF 2017第三题 点评及解题思路</a><br></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283236&amp;idx=1&amp;sn=26f6fdd0f3d1d43eba75b9c8f2486e0e&amp;chksm=b1815c6e86f6d5786aab09dd4b1aae94e69d5f033621fda60550c42f9aa9d180be55eb49cc0c&amp;scene=21#wechat_redirect" target="_blank">看雪.万能钥匙 CTF 2017 第二题点评及解题思路</a><br></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283184&amp;idx=1&amp;sn=fd8246361b0bd21c80717c888e67f55a&amp;chksm=b1815c3a86f6d52cfd48056237427263609a8184b1cea6b28d1bc56f942dd1498dd26764d4bb&amp;scene=21#wechat_redirect" target="_blank">看雪.万能钥匙 CTF 2017第一题 WannaLOL 解题思路</a><br></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">更多比赛详情，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HeITaKZ4ia1yZqDFpI1U8icd14Ea3PO3LYThHvZ887eob5Ka9k3qJD2ialAI7WV6KThEzPoadyNsvtA/640?wx_fmt=jpeg" style="visibility: visible !important; width: 640px !important; height: 426px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪论坛：http://bbs.pediy.com/<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important; background-color: rgb(255, 255, 255);"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">商务合作<span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px;"></span>：<span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px;">wsc@kanxue.com</span></span></p><p><br></p><p><br></p><section class="" style="display: inline-block; vertical-align: top; width: 15%; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 10px 0% 0px; text-align: center; transform: translate3d(0px, 0px, 0px); font-size: 11.2px; box-sizing: border-box;"><section class="" style="padding: 4px; display: inline-block; background-color: rgb(211, 0, 0); box-sizing: border-box; font-size: 11.2px;"><section class="" style="border-color: white; width: 1.6em; height: 1.6em; border-style: solid; border-width: 1px; font-size: 16.8px; line-height: 1.5em; color: rgb(255, 255, 255); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 16.8px;"><span style="font-size: 15px;">点</span></p></section></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="text-align: center; line-height: 0; overflow: hidden; transform: translate3d(0px, 0px, 0px); margin: 0px 0%; box-sizing: border-box; font-size: 16px;"><section class="" style="display: inline-block; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="width: 2px; height: 1em; margin: auto; background-color: rgb(211, 0, 0); box-sizing: border-box; font-size: 16px;"></section></section></section><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="width: 0px; border-left: 0.5em solid transparent !important; border-right: 0.5em solid transparent !important; border-top: 1em solid rgb(211, 0, 0); box-sizing: border-box; font-size: 16px;"></section></section></section></section></section></section></section><section class="" style="display: inline-block; vertical-align: top; width: 85%; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><section class="" style="margin: 15px 0% 0px; box-sizing: border-box; font-size: 16px;"><section class="" style="box-sizing: border-box; font-size: 16px;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; font-size: 16px;"><span style="font-size: 15px;">阅读原文了解更多</span></p></section></section></section></section><p><br></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1497276357&src=3&ver=1&signature=aHg31JU*BGTH2xoiR2ftYl-Za4Tj4F9-ES3676R*Lz9d4Q2l*LGr82CxAl3XSPMV3mvK5fPXVrwmme1QdzvmJc8v3qJRJDVqQwvddLl2da89s5gE1Czy6fVFFLjkHmTT9fIAugY2kO3zrktpwA9dJlmxUgbC61UXv8jQY7x6OpQ=">微信地址</a> | <a href="http://ctf.pediy.com/game-fight-34.htm">阅读原文</a>
{% endraw  %}

