---
title: 蠕虫勒索软件WannaCrypt0r的行为分析
author: 白小菜
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1494849877&src=3&ver=1&signature=FqhZ2eqkNX-xbZfPTDWJFyyUKemv954mf5Q*MuC9JH720SqIESAnz8-uzXmDzovZMdiRZ8GMhE0ZmV0qTfay6V1G4Gm9t-l9NnK8TQYI7dsR-uoQjpQNTqWMBkR3fqnxFBzsQCQioXUO8qcjd1y6zlqpoMb6iIK-ExNAKDgAOx4=
date: '2017-05-15 00:00:00 +0000'

---

{% raw  %}
<p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">来科锐学习一年出头，x86 平台刚好学完，这个周末遇到这个病毒爆发，花了点时间分析了下这个样本，发出来与看雪坛友分享。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 18px; color: rgb(255, 76, 65);"><strong>一) 样本大致行为预览</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">该样本执行后会随机向互联网计算机发送EternalBlue漏洞溢出程序，并释放勒索加密程序，加密计算机上.doc 、.ppt、.jpg、.sqlite3、.mdb、.bat、.der等多种类型的文件，修改文件后缀为.WNCRY类型，弹出窗口勒索用户，要求一定时间内交出赎金，才能恢复文件。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="color: rgb(255, 76, 65);"><strong><span style="font-size: 18px;">二) 样本行为分析</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-indent: 2em;"><span style="color: rgb(255, 76, 65);"><strong><span style="font-size: 16px;"><br></span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left; text-indent: 0em;"><span style="color: rgb(255, 76, 65);"><strong><span style="font-size: 16px;">2.1 原始样本分析</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">定位到WinMain后，可以发现在WinMain入口处发现，原始样本会尝试连接一个非常没有规律的域名：http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/887577ddc678abf36a0d567e1aa7ccb59c32d371.png" style="width: 554px !important; height: 19px !important; visibility: visible !important;"><span style="font-size: 15px;"><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">样本会通过是否能成功连接该域名，来决定是否展开后续行为。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/ee6696977f3234e167c9fcb6adbd8da6114a543e.png" style="width: 363px !important; height: 199px !important; visibility: visible !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">如上图所示，若能够成功链接，则程序不展开相关行为，直接退出。否则，展开相关行为。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">其中的sub_408090函数内部，在一个条件判断中分了两个功能模块：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/52592608a3ae5edf0fbda25c72731b17e40dba57.png" style="width: 454px !important; height: 309px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">其中，条件成立的代码块是启动服务功能等行为展开，程序第一轮并不会进入；当程序第一次启动时，执行的是条件不成立时的模块（上图中的sub_407f20），其功能主要为创建服务、释放并执行勒索的主体程序tasksche.exe /i。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">创建服务过程：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/253a46327d0e103d296fb0537fb74940cfe0369b.png" style="width: 424px !important; height: 159px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">该样本创建一个服务名为"mssecsvc2.0"，服务说明为"Microsoft Security Center (2.0) Service"的服务。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">并在后续的行为中启动自身。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">该服务的功能为：随机扫描互联网IP，利用SMB的内核级漏洞（CVE-2017-0143~CVE-2017-0148)，传播自身。这个漏洞的利用我自己还在分析，分析出来后会放在后续文章中。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">原始样本，会从资源中加载、释放一个名为tasksche.exe的文件，并且以tasksche.exe /i的方式启动。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/49241a0d2e65f473996a6127762bbe38021ba81d.png" style="width: 259px !important; height: 121px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/de3a3fda88a39fbbb42d01ec56aed0a8958a28d9.png" style="width: 554px !important; height: 12px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">接着，我分析了 tasksche.exe，它的行为如下</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">&nbsp;</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-indent: 0em;"><span style="font-size: 16px; color: rgb(255, 76, 65);"><strong>2.2 tasksche.exe 的行为分析</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">tasksche.exe 启动后，首先，会将自身拷贝到 C:\intel\lgxbrzjmuzoytl531。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/4f56cf426d6053628532fe0905bb5b190b0bd7ed.png" style="width: 375px !important; height: 162px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">接着，tasksche.exe 会创建服务，服务名及说明均为"lgxbrzjmuzoyt1531"，然后以服务的方式再启动自身。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/d0fe765b57c94dfe35359cdf629c6807dc925963.png" style="width: 619px !important; height: 244px !important;"><span style="font-size: 15px;"> <br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/4999859119221e899a5137f26086ae1094415e53.png" style="width: 591px !important; height: 220px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">以服务的方式启动后，tasksche.exe 会以创建进程的方式执行命令：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/b97603c5976cc07ef2ae2227301e0fd3fa19ec2d.png" style="width: 445px !important; height: 137px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">attrib.exe +h</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">icacls.exe . /grant Everyone:F /T /C /Q</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">这两个命令用于修改文件属性相关的权限。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">接着，会读取前期释放的一个名为 t.wnry 文件，并对其中的内容进行解密，解密后的内容为一个 Dll 文件，但是该dll文件并不会被写入磁盘中，而是在内存中直接执行。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/4459b8c35e7c5efe84ec3a553cd1d37ae6106a48.png" style="width: 433px !important; height: 19px !important;"><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/ea5bb9b019178e0bd7e357b0d99458489727ae17.png" style="width: 438px !important; height: 247px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">我将该 dll 从内存中 dump 出(取名为 crypt.dll)，发现包含了勒索软件的加密功能。对其进行了分析。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">&nbsp;</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px;"><strong><span style="color: rgb(255, 76, 65);">2.3 crypt.dll 样本分析</span></strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">crypt.dll 只有一个自定义的导出函数 TaskStart，该导出函数是其行为展开的入口。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/4525a386f7a8405992a9dccf2a7728ed27b438d4.png" style="width: 554px !important; height: 31px !important;"><span style="font-size: 15px;"> 进入TaskStart后，该样本会先加载Kernel32，动态获取后续需要的API。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/921749b9953dfd8e32141dff0c8f4d9dce04e61d.png" style="width: 289px !important; height: 334px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">创建互斥体"MsWinZonesCacheCounterMutex"，用于判断自身重入问题。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/26508a2e45b6f773611aaf2906ebb3694bb3e6a0.png" style="width: 251px !important; height: 136px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">接着，该样本连续创建了多个线程，</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/2d3305ab7a10f2f1425e75cbe1e3c025e4c61a54.png" style="width: 590px !important; height: 153px !important;"><span style="font-size: 15px;">他们的功能分别为：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">l&nbsp;将tasksc.exe加入到HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run项，用于开机自启动</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">l&nbsp;遍历驱动器，并检查是否有U盘等移动存储插入</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">l&nbsp;循环调用taskdl.exe，暂未详细分析</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">l&nbsp;写入并执行vbs脚本，暂未详细分析 </span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">&nbsp;</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">遍历磁盘并加密文件。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/7dd0637119242ae659b14dbfa60a5de745d688e0.png" style="width: 395px !important; height: 173px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">该样本不会加密所有的文件或文件夹（否则可能会破坏系统导致系统无法启动，或者有些文件的价值并不大）。其将要感染的文件，以后缀名判断，集中放在程序中，以下是部分截图：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/5fbc23dd71b2e6c169b123c4c3b5fd45a2635635.png" style="width: 554px !important; height: 368px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">过滤掉特定的文件夹及非指定后缀名的文件之后，程序会对文件进行加密。其加密流程如下，它的加密思路并不是直接用长密钥的RSA进行全部加密，可能处于效率的考虑，它的加密思路如下：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">1.&nbsp;被感染用户的文件，被AES加密，AES加密所使用的KEY，是根据每个文件随机生成的。随机生成的KEY，之后会被下一步的RSA 2048加密。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2.&nbsp;样本在针对每一台机器上，会随机生成一对RSA 2048密钥，其中公钥(保存在00000000.pky中)用于加密上一步的AES KEY，私钥将被加密后存在文件(00000000.eky)中，具体加密方式见下一步。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">3.&nbsp;上一步的RSA私钥，会被另一个RSA 2048公钥加密（记作 RSA2），该RSA2的私钥仅勒索者本人知道。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="/ikanxue/images/930701eda2808f4f152d116852e2c27f89943240.png" style="width: 304px !important; height: 200px !important;"><span style="font-size: 15px;">&nbsp;</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">知道以上思路后，就比较容易理解该样本的加密流程了：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">1.&nbsp;新建文件，新文件名为原始文件名.WANACRYT（T表示临时文件，用于临时处理文件加密）</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2.&nbsp;在新的文件头部先写入8字节的WANACRY!加密标志</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">3.&nbsp;写入4字节的长度标识，表示后面紧跟的加密后的文件加密密钥的长度</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">4.&nbsp;写入256字节长度的加密后的文件加密密钥(该密钥解密后为16字节长度的字符串，使用该字符串AES加密文件)</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">5.&nbsp;写入4字节长度的 勒索者作者定义的类型，不为4的文件类型记录到f.wnry文件中，用于后期免费解密。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">6.&nbsp;写入8字节长度的原始文件长度</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">7.&nbsp;使用随机生成的16位字节的密钥利用AES加密算法进行加密，并写到上述内容之后。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">8.&nbsp;修改新文件的文件时间为源文件的时间。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">9.&nbsp;删除原文件，并将新文件重命名为WANACRY。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">10.&nbsp;若文件为可免费恢复的文件，则将文件名记录到f.wnry文件中。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">因为涉及到的代码量较多，不方便截图，感兴趣的可以去看我附带的idb文件。我自己也对该样本的算法进行了还原，写成了cpp文件，供大家参考。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><strong><span style="font-size: 15px; color: rgb(255, 76, 65);">点击原文查看哦！</span></strong><span style="font-size: 15px;"><br></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: center;"><span style="font-size: 15px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><hr style="max-width: 100%; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282630&amp;idx=1&amp;sn=61fcbc708235dec5d7897a0d7c315756&amp;chksm=b1815a0c86f6d31a50ba1f9a39d876e28f2c71096100b28e961df185f7be94ec77b9199efd51&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">等你来挑战！| 看雪 CTF 2017 攻击篇</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282621&amp;idx=1&amp;sn=15f5bc0fa2b0b34ae241668b23a3939b&amp;chksm=b1815af786f6d3e1fd4bad2c336d725ec600551a6477bbc4c6af93167074ac83873aeba89938&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">【终于等到你！】看雪 CTF 2017</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282703&amp;idx=1&amp;sn=7ed476d577172ff4b4a93807dae2667c&amp;chksm=b1815a4586f6d35373f6c5d783fa99a7bb7cf2fc35da914761a9cf2d9943a09c1aefb9febfbf&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">春风十里，我在等你</span></a></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282903&amp;idx=1&amp;sn=ba8828786e9717016b399020a2427850&amp;chksm=b1815b1d86f6d20b9a60848ac2165b8ecacc8809f91851f2ffefc2bcd49f2007c07f42620f99&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282903&amp;idx=1&amp;sn=ba8828786e9717016b399020a2427850&amp;chksm=b1815b1d86f6d20b9a60848ac2165b8ecacc8809f91851f2ffefc2bcd49f2007c07f42620f99&amp;scene=21#wechat_redirect">谁动了我的论文？我们来扒一扒勒索软件的前世今生</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282703&amp;idx=3&amp;sn=bfa728ff73cd389cd9258ca32008c6e2&amp;chksm=b1815a4586f6d353468f3adf9545aab3ffdce4f4c3e0e47c967298eca045db0558e37865c3a7&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282909&amp;idx=4&amp;sn=0c061fe75f26ce6047e85b476ba14f74&amp;chksm=b1815b1786f6d2013bd9feb9e28b6e1a896ae9e2096fe150798e6ee7b6c79c2d0574b8c1c126&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282909&amp;idx=4&amp;sn=0c061fe75f26ce6047e85b476ba14f74&amp;chksm=b1815b1786f6d2013bd9feb9e28b6e1a896ae9e2096fe150798e6ee7b6c79c2d0574b8c1c126&amp;scene=21#wechat_redirect" style="font-size: 15px; text-decoration: none;"><span style="font-size: 15px;">Wannacry勒索软件母体主程序逆向分析</span></a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282909&amp;idx=2&amp;sn=d75fa66aa9abddcf8ce202180a7e1f48&amp;chksm=b1815b1786f6d201c354270d8adc3c810261dda11ac4f2a8d6e0b91cccaf491688c78276ae84&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282909&amp;idx=2&amp;sn=d75fa66aa9abddcf8ce202180a7e1f48&amp;chksm=b1815b1786f6d201c354270d8adc3c810261dda11ac4f2a8d6e0b91cccaf491688c78276ae84&amp;scene=21#wechat_redirect">重要通知：周一上班先拔网线再开电脑！</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">......<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">更多优秀文章，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><img src="/ikanxue/images/a0942aca19665d63c4ee222be971a37cd63dc1e4.jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 640px !important; height: 426px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪论坛：http://bbs.pediy.com/<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">投稿、合作：www.kanxue.com</span></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1494849877&src=3&ver=1&signature=FqhZ2eqkNX-xbZfPTDWJFyyUKemv954mf5Q*MuC9JH720SqIESAnz8-uzXmDzovZMdiRZ8GMhE0ZmV0qTfay6V1G4Gm9t-l9NnK8TQYI7dsR-uoQjpQNTqWMBkR3fqnxFBzsQCQioXUO8qcjd1y6zlqpoMb6iIK-ExNAKDgAOx4=">微信地址</a> | <a href="http://bbs.pediy.com/thread-217636.htm">阅读原文</a>
{% endraw  %}

