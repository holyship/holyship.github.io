---
title: 看雪.WiFi万能钥匙 CTF 2017第十二题 点评及解题思路
author: 看雪学院
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1499131012&src=3&ver=1&signature=iU4hCwtQzyv2pey6SDTnZ62YXf1MWi8Zh8usUjq2T6Tp8olMm-6I1I4qsl-rYUzkEslKlH6cxolxoLxftDKuPpeFpTQgtHRcMuA4-MRMtYxZxSfGIQSffnNQefzS6eHx3NihSSSlWXAZEArfcR3zINOZe9HCGsPm5Fci0MhYflU=
date: '2017-06-25 00:00:00 +0000'

---

{% raw  %}
<p><br></p><section style="max-width: 100%; box-sizing: border-box; background-color: rgb(255, 255, 255); word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="margin-top: 30px; margin-bottom: 20px; max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); text-align: center; word-wrap: break-word !important;"><section class="" style="padding: 5px; max-width: 100%; box-sizing: border-box; display: inline-block; width: 603px; vertical-align: top; background-color: rgb(223, 241, 238); border-width: 0px; border-radius: 5px; border-style: none; border-color: rgb(62, 62, 62); word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="padding: 10px; max-width: 100%; box-sizing: border-box; display: inline-block; width: 593px; vertical-align: top; border-style: dashed; border-width: 1px; border-radius: 5px; border-color: rgb(74, 179, 172); word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="margin-top: -35px; max-width: 100%; box-sizing: border-box; text-align: left; transform: translate3d(-30px, 0px, 0px); word-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EbL4Qw95bfyIM3rnNynl14PKicECpSXbJIiaNxIjMAGADPy74OuHSxkuYicb7Gkj5CDs1aL9o9jqA6A/640?wx_fmt=png" style="box-sizing: border-box; vertical-align: middle; word-wrap: break-word !important; visibility: visible !important; width: 85.6406px !important; height: auto !important;"></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="padding-right: 10px; padding-left: 10px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(45, 66, 87); line-height: 1.8; word-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important;">看雪CTF 2017 比赛进行至第十二题</p><section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;">截止至今天中午12点，第十二题破解人数为 5 人！</p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;">防守方 hsadkhk 依然位居首位~，第十二题作者冲进第二位！<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhw4FwsYggq0AZuzIOew3Yy3HTYa71ZEyAuoG5XwWmVnrPjbG2rWpPspw/0?wx_fmt=png" style="width: 336px !important; height: 444px !important; visibility: visible !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;">此题过后，风间仁依然处于第一位，前十名排名基本保持不变。<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwFrFwCNbD0Ep4CkT4zxicVa5yibGcvtYnYBwSicS2TCADodfFIezJEpZUw/0?wx_fmt=png" style="width: 318px !important; height: 391px !important;"></p>比赛进入尾声，仅剩 3 题。<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;">期待ing......<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;">接下来我们来回顾一下第十二题</p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;">看看 看雪评委和出题者是怎么说的ヾ(๑╹◡╹)ﾉ"。</p></section></section></section></section></section></section></section></section></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"></p></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; width: 670px; vertical-align: top; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; word-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; word-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;">看雪评委 netwind 点评</span></p></section><section style="max-width: 100%; box-sizing: border-box; border-top: 2px dotted rgb(202, 198, 198); width: 191.688px; word-wrap: break-word !important;"></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; line-height: 1.8; word-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box; letter-spacing: 0px; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; box-sizing: border-box; min-height: 1em; line-height: 1.75em; word-wrap: break-word !important;"><span style="max-width: 100%; letter-spacing: 0px; box-sizing: border-box !important; word-wrap: break-word !important;">作为一道安卓平台破解题，作者在反调试和加密算法上对apk文件进行了很好的防护。通过对dex文件进行hash校验，隐藏函数名，在so层检查是否被附加调试来进行反调试。在算法上采用了DES和RC6算法，需要暴力枚举来破解此题。</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; box-sizing: border-box; min-height: 1em; line-height: 1.75em; word-wrap: break-word !important;"><span style="max-width: 100%; letter-spacing: 0px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></p></section></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; width: 670px; vertical-align: top; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; word-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; word-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">作者简介</strong></p></section><section style="max-width: 100%; box-sizing: border-box; border-top: 2px dotted rgb(202, 198, 198); width: 82px; word-wrap: break-word !important;"></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; line-height: 1.8; word-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box; letter-spacing: 0px; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></strong></p><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; word-wrap: break-word !important;"><strong><span style="letter-spacing: 0px;">liuluping</span></strong><span style="letter-spacing: 0px;">，四川大学信息电子信息学院在读研究生，目前研究方向为软件安全和漏洞分析，正在进行符号执行和程序自动化分析分析相关的研究，从硕士开始接触软件安全，从事程序分析，恶意代码分析和检测的相关方向的研究。</span></p><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; word-wrap: break-word !important;"><span style="letter-spacing: 0px;">在程序分析上比较擅长协议逆向分析，常见加密算法识别以及恶意代码分析等，在实验室的日常工作中，接触较多各种零散类的工作，在安全研究路上还有待成长。</span></p><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box; letter-spacing: 0px; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></p></section></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; width: 670px; vertical-align: top; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; word-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; word-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important;">看雪 CTF 2017 第十二题设计思路</p></section><section style="max-width: 100%; box-sizing: border-box; border-top: 2px dotted rgb(202, 198, 198); width: 255.703px; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;"><section class="" style="padding-top: 2px; padding-bottom: 2px; max-width: 100%; box-sizing: border-box; text-align: justify; font-size: 15px; color: rgb(51, 59, 108); letter-spacing: 0px; line-height: 1.8; word-wrap: break-word !important;"><p><span style="font-size: 16px; text-decoration: underline;"><strong>题目Flag</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">Flag:kxuectf{D3crypted1sV3rylntere5tin91}</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">题目设置时需要说明flag格式：kxuectf{}，否则后面涉及到暴力破解，可能会出现题目无解。<br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px; text-decoration: underline;"><strong>安全策略</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">1. DEX 修改和反调试检测</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">（1）对DEX文件的SHA-1值进行检测：从/data/dalvik-cache/目录中读出应用安装存储的DEX文件，获取里面DEX文件的SHA-1值，并与应用原始的SHA-1值比较，不相等则退出，隐藏在动态注册中；</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">（2）为了防止解题者直接nop掉exit()函数，在进入so中的check函数后首先再进行一次DEX是否修改和反调试检测，如果检测到任意一个就将DES算法密钥的第5个和第6个值改掉。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">2. 隐藏MainActivity，使得程序不执行配置文件中的MainActivity 。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px; text-decoration: underline;"><strong>安全策略</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">1.采用符号隐藏策略，将函数名隐藏</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">2.动态注册</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">使用动态注册将java层的check函数动态注册为ab函数</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="text-decoration: underline; font-size: 16px;"><strong>Java层算法</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">1. 在配置文件的MainActivity 即Main类中添加了多余的迷惑解题者的签名验证，实际并没有执行。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">2. Java层算法一共三个，ab.a()、ba.a()、ca.a()，但是真正有用的是ab.a()，一个简单的移位加密。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">Main类中的调用顺序是：</p><blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">&nbsp;<em> str=ca.a(input)+ba.a(input)+ab.a(input)</em></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">uv类中的调用顺序是：</p><blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><em>&nbsp; str= ab.a(input)+ba.a(input)+ca.a(input)</em></p></blockquote><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">ab.a()、ba.a()函数密文和输入长度一样，ca.a()函数密文与输入长度有关，所以算法需要对输入位数的判断，来确定输入为多少位。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">3. 真正用于so中验证的只取前36位，也就是真正有用的加密函数只有ab.a()。</p><p><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwUwG9Yu7KbHumQW7hyPyndCaPUPibVdjP85uJfj9MkV0lic71zLZiaia7UQ/0?wx_fmt=png" style="width: 670px !important; height: 357.107px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="text-decoration: underline; font-size: 16px;"><strong>Native 层算法</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">1. Native层算法思路简单，使用两层加密算法，分别是RC6和DES。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">2. 算法基本步骤如下：</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">3. 首先将输入利用DES进行加密，其中DES密钥硬编码在程序中，需要进行5轮。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">4. 将加密后的数据分成两部分，前4轮组成0x20个字节作为第一部分，而后面一轮的前4个字节作为另外一部分。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">5. 将步骤2中得到的最后一轮前4个字节替换掉硬编码的0x10个字节后作为下一步骤进行加密的RC6密钥。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">6. 利用步骤3中得到的RC6密钥对步骤1中加密后得到的前半部分（0x20）进行加密后和硬编码的数据进行比较。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">7. 最后根据比较结果得到True或者False并返回。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">8. Native层的加密算法整个流程见PPT第二页。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwttVWNjW92z4OGqXc4ahKlL1yKo5V1WllWGpzox1IiaOTibzPAINFDjpw/0?wx_fmt=png" style="width: 670px !important; height: 350px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px; text-decoration: underline;"><strong>相关思路</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">1. 在步骤1中使用的DES加密算法为标准的加密算法，使用的Paddting填充模式，填充数据为（8-（加密长度%8））</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">2. 在RC6算法中，对两个固定参数中的一个稍微进行了修改，参数Q由0x9E3779B9变成了0x61c88647。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">3. 为了增加一点难度，这里没有直接将输入经过两次加密后直接和硬编码数据进行比较，而是将第一次加密后的部分作为第二次密钥的一部分。这里不会造成无解。因为在程序中已经进行了提示flag开头为kxuectf{，因此前8个字节固定，经过java层相关变换以及到了native层第一次DES加密时，由于DES也是8字节分组加密，因此DES加密后输出8字节也是固定的，为“\x4c\xd9\xa3\xe6\xed\xfe\xd1\x05”。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">这样在进行解题中，由于知道最后比较结果，知道RC6密钥的前12个字节，以及知道RC6加密前的明文的前8个字节格式，因此这里一般思路是可以暴力枚举4个字节，将比较结果进行解密判断前8个字节是否等于上面的结果，从而得到RC6的密钥，进而逆推还原。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;">4. 但其实只需要破解3个字节就ok，通过分析程序可知，flag为36个字符，最后一个为},经过java层加密后得到固定字符‘{’，在进行DES加密时，采用padding模式，因此最后一组肯定是”xxx{\x04\x04\x04\x04”。</p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em; text-align: left;">从这个地方推过去，由于最后一组进行DES加密后会去前4个字节来替换掉RC6的密钥，因此枚举最后一组前的3个字符即可，这样将最后一组进行枚举并一次进行DES加密然后将结果中的前四个字节取出来替换到硬编码的RC6密钥，然后利用RC6密钥对最后比较的0x20个字节进行解密，如果接的得到的前8个字节为“\x4c\xd9\xa3\xe6\xed\xfe\xd1\x05”则表示最后flag的最后四个字符已经确定，并且RC6的密钥也确定，这样在再对硬编码数据进行解密并依次逆推后即可顺利得到最后的flag:kxuectf{D3crypted1sV3rylntere5tin91}。</p><p><span style="font-size: 18pt; font-family: 宋体;"></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><br></p></section></section></section></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; background-color: rgb(255, 255, 255); word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; transform: translate3d(0px, 0px, 0px); word-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; word-wrap: break-word !important;"><section class="" style="margin-bottom: 4px; padding-right: 5px; padding-left: 5px; max-width: 100%; box-sizing: border-box; background-color: rgb(51, 59, 108); color: rgb(247, 247, 247); font-size: 18px; word-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; word-wrap: break-word !important;">下面选取攻击者&nbsp;<span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">loudy</span>&nbsp;的破解分析</p></section><section style="max-width: 100%; box-sizing: border-box; border-top: 2px dotted rgb(202, 198, 198); width: 309.719px; word-wrap: break-word !important;"></section></section></section></section><p><br></p><p><br></p><p><span style="font-size: 15px;">使用工具：</span><span style="font-size: 15px;">IDA6.8</span><span style="font-size: 15px;">（so修改、反汇编分析、动态调试） notepad（记录） vc6.0（编程解码） android sdk emulator（android4.4虚拟机）、jeb（dex反编译）ApkIDE（修改DEX、重打包）</span><br></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">步&nbsp;&nbsp;&nbsp; 骤：</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px; color: rgb(255, 251, 0); background-color: rgb(0, 0, 0);"><strong>一、反逆向手段绕过</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">（1）dex层</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">直接JEB分析，如下图3处红线标注的地方有MD5校验。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwZJhZZyzBxrONg0mADcHXdcXsWovSrp4O89icOTcU5YAm3eMNFJ4Hw9w/0?wx_fmt=png" style="width: 532px !important; height: 394px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">绕过方法也很简单，ApkIDE反编译，修改下图61行的if-eqz为if-neq，并重新打包，即可直接跳过MD5检测。打包时，也许会提示某个styles.xml的几行有问题，删除那几行即可。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwp9ApDYeDwxnJCicgwBpMWKMibQ3kwPRAV9I2DUq71XXIc7vV9DuqDoDQ/0?wx_fmt=png" style="width: 533px !important; height: 179px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">（2）so层</span><br><span style="font-size: 15px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">用IDA连接，程序直接退出，故肯定有反调试手段。用winrar对apk文件解包后，发现lib目录有3个不同的so文件，如下，其中armeabi-v7a文件夹下的libenjoy.so文件才是我的android4.4系统需要的，分析此文件。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwHXGZz7JScPV3JsGEibjv6ia0zdFnFFM9Zb12sfsufNOmkfibI7ZD0ofLw/0?wx_fmt=png" style="width: 498px !important; height: 112px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">IDA载入，静态分析，没有发现.init表，那么我们重点分析JNI_OnLoad函数。其中sub_24B8和sub_281C是两个主要的反调试函数。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwlL75Tx65h0nwIhkzR0Xo1Biabt7kEdsicruGJIfUX9FzFwufwJicZTFLg/0?wx_fmt=png" style="width: 574px !important; height: 268px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">而sub_2350和sub_2378都是同一种形式的解码函数，即按字节依次与0x16异或，解密结果都是字符串，这种函数后面还有很多，不一一介绍。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwr0fg1Ic890TCdkYWHqMTKLj4FKG4b0dlyW1d8buniadRliaHh1IdIwwg/0?wx_fmt=png" style="width: 365px !important; height: 267px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">JNI_OnLoad中第14行解码结果为“check”，也即dex调用的本地函数，再看17行，跟踪到如下位置，发现check函数的实际地址为sub_3748。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwdnJLbpfTZpibvjT5bzAch3DRaUKY7ia6qNeAjqiaAScFYJsibfibjewDSmA/0?wx_fmt=png" style="width: 568px !important; height: 54px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">而此处作者也用了一个小手段，自己新建了一个名为.mytext的可执行段，sub_3748在其中实现，导致IDA在默认的.text段找不到该函数，有一定的反逆向效果。</span><br><span style="font-size: 15px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwUbcVsouYoRX4pFLYjk3pTNN3E85DPfItMn5riaA6LBe3tdAicTlRcqcg/0?wx_fmt=png" style="width: 572px !important; height: 168px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">再看JNI_OnLoad函数调用的sub_24B8函数，该函数的主要作用是读取/data/dalvik-cache/目录下的data@app@com.game.kxctf-1.apk@classes.dex文件或者data@app@com.game.kxctf-2.apk@classes.dex文件的校验值，结果与“E07784C2A2923354F18952BBDB5D81916D24D2F5”比较，不等于则exit(0)退出程序。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">绕过方法也很简单直接将JNI_OnLoad中对该函数的调用以0x00覆盖即可。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">JNI_OnLoad函数调用的sub_281C函数，实际就是调用sub_1B04如下，该函数创建了一个线程。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwla6yhNRAYvEzASF4lYdPLR7ciajdkWKIdHH6MFpR09JqgB37QRqZfag/0?wx_fmt=png" style="width: 577px !important; height: 135px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">跟进后，发现线程主体如下。其中sub_25A8函数获取/proc/%d/status的State，看其中是否包含“R/S/T”。sub_2628获取/proc/%d/status的TracerPid，看是否为非0值。sub_2688执行cat/proc/%d/wchan，看结果中是否包含sys_epoll或者ptrace_stop。sub_24B8之前已经分析。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwDTsp98Y2EJGL9OZmgbSNSfKSKltVNZ6ibeEbgbLsxKib7mQ2TO7QdJoA/0?wx_fmt=png" style="width: 468px !important; height: 237px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">从分析可以知道，该线程没有影响算法流程，因此也可以直接在JNI_OnLoad中将对sub_281C的调用以0x00覆盖，实现绕过。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">最后在check函数sub_3748开头还有一处反调试，如下，分析发现sub_27B4功能和sub_24B8一模一样，不再累述，直接将调用处用0x00覆盖实现绕过。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwR2h7gwVDPBiaOAyWdibfXsiaePEMevzwLW3badL0Y7NkiaEf6KqYUtqKwQ/0?wx_fmt=png" style="width: 553px !important; height: 238px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px; background-color: rgb(0, 0, 0); color: rgb(255, 251, 0);"><strong>二、算法流程分析</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">反逆向手段清除后就可以大胆调试，跟踪算法流程了。流程分dex层和so层两个方面讲。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">（1）dex层</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">JEB分析结果很直观，将三个函数分别对输入字符串的处理结果连接起来，送入so层处理，如果so层处理结果为1，则正确。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwOzxEes4htGLQHCfAG6DgH3RibpWSsJGwsNMJer05kBzwXT32bUKQEDw/0?wx_fmt=png" style="width: 526px !important; height: 191px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">ca.a是base64编码，ba.a、ab.a也分别是一种编码，虽然有三种编码，但实际分析后发现，ca.a和ba.a都不起作用，实际只有ab.a参与了算法流程，该函数如下。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwzMqiaKibw4tNpy5iaXiceZvU0xwTxdA27uja9tg3ibIzBTOiavvfA2csZVNQ/0?wx_fmt=png" style="width: 770px !important; height: 456.388px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">此时无需更加深入分析，可以等so反推之后再爆破。</span><br><span style="font-size: 15px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">（2）so层</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">so层流程其实很简单。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">1、&nbsp;&nbsp; 判断dex层传来的数据是否大于0x78（其实此时就是0x78），大于则over。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">2、&nbsp;&nbsp; 截取前0x24位（即dex层ab.a函数处理结果），并在结尾补4个4成0x28位。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">3、&nbsp;&nbsp; 用密钥{0xFD, 0xB4, 0x68, 0x54, 0x08, 0xCD, 0x56, 0x4E}对此0x28位进行DES加密（非标准）(实际操作时，密钥转换为子密钥总有一两位不同，故直接在内存提取子密钥表，取消密钥生成过程)</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">4、&nbsp;&nbsp; DES结果第0x20、0x21、0x22，0x23位替换密钥{0x65, 0x48, 0x32, 0xEF, 0xBA, 0xCD, 0x56, 0x4E, 0x0F, 0x9B, 0x1D,0x27, 0x0, 0x0, 0x0, 0x0}的最后四位。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">5、&nbsp;&nbsp; 用上一步的密钥对DES结果前0x20位进行RC6加密。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">6、&nbsp;&nbsp; RC6加密（非标准）结果与0x42D3C3C2, 0xF12AE92D, 0x66C92822, 0x2CEB540E，0x9407E577, 0x4A92B792, 0x2E5DFDF0, 0xF3549FC6比较，全部相等则注册成功。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 16px;"><strong>三、破解过程</strong></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">流程梳理清楚就好了，首先通过调试修改标准DES和RC6与程序所用一致。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">其中DES修改较小，RC6修改较大，分别如下。一般RC6加密Q值为0x9E3779B9，而静态分析可知此程序为0x61C88647（即-0x9E3779B9）。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwyb5Pzk5U1JI3fB5cRa9lq0MuCgHyDESahq1N9mSW07tSIg6vHXaCVw/0?wx_fmt=png" style="width: 533px !important; height: 52px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">另外RC6的密钥会有个反馈，不是每次块（0x10字节）加密都用同一个密钥，对照IDA将C代码做如下修改，其中kerr为下一次加解密的密钥。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwgzc3QfuYMwMxCRicrE2acCwxDDaCCAPE5IsiaCzzJlAeEo2xica6XOThQ/0?wx_fmt=png" style="width: 501px !important; height: 268px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwdYVibfg7R0jesYSL1tQmAlzibgWW3fvKVmuCVLUj5RT0LuSqwrGwhxgg/0?wx_fmt=png" style="width: 511px !important; height: 253px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">这两个函数调整好后（这是一个漫长的跟踪过程），事情就好办了。</span><br><span style="font-size: 15px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">由于DES为ECB模式，8字节独立加密。根据已知条件前8字节为“kxuectf{”得到加密结果0x4C，0xD9, 0xA3, 0xE6, 0xED, 0xFE, 0xD1,0x05。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">由最后一个字节为“}”， ab.a函数处理后为“{”，所以DES加密的最后8字节为x,x,x,{,4,4,4,4,其中x为未知数。编写如下代码爆破，得到结果“a&gt;6”。 </span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhw0VdWUxeLVNnfJUicGGOzBY4Qd7qJiabw7PoCXEUlwCtt6AahjTx5rH1Q/0?wx_fmt=png" style="width: 770px !important; height: 269.167px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">由此得到正确RC6密钥{0x65, 0x48, 0x32,0xEF, 0xBA, 0xCD, 0x56, 0x4E, 0x0F, 0x9B, 0x1D, 0x27, 0x13, 0x6a, 0x7e, 0x1F}。</span><br><span style="font-size: 15px;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">利用此密钥对0x42D3C3C2, 0xF12AE92D, 0x66C92822, 0x2CEB540E，0x9407E577, 0x4A92B792, 0x2E5DFDF0, 0xF3549FC6解密，得到结果“xkhrpgs}Q4pelcgrq6fI4elyagrer2gv”，加上“a&gt;6{”，即“xkhrpgs}Q4pelcgrq6fI4elyagrer2gv a&gt;6{”为正确的进入so的字符串。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">通过如下函数爆破。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwT3hCtsMhHsO3sJ7BJxmVCRT9IAB7SdjWl0iakQtia0GvmQAm8KCK8jAA/0?wx_fmt=png" style="width: 770px !important; height: 507.837px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">得到结果如下。</span><br><span style="font-size: 15px;"></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwHicXIXKNClOVNqbonPuibgLrFPLunEFAh8CwiaOibjcV3tHXFq3x60vRPw/0?wx_fmt=png" style="width: 443px !important; height: 418px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">如果剔除掉特殊字符，得到注册码为</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;">“kxuectf{D3crypted1sV3rylntere5tin91}”输入模拟器，正确。</span></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p style="text-align: center;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8EY79yXwSKCKIzwFiakYnLhwBPmk3GeooJ8gaDMTphq1iadzBpCia2gwvicZ5aDl56XWlzZheXicxIwSAQ/0?wx_fmt=png" style="width: 222px !important; height: 419px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; line-height: 1.75em;"><span style="font-size: 15px;"></span></p><p style="text-indent:28px"><br></p><hr style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></p><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">最后感谢 WiFi 万能钥匙安全应急响应中心的赞助支持，</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; text-align: center; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">接下来的比赛大家一定要使出洪荒之力哦！↖(^ω^)↗</span><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; color: rgb(255, 104, 39); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">比心&nbsp;❤</span></p><p style="max-width: 100%; min-height: 1em; text-align: center; box-sizing: border-box !important; word-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_gif/1UG7KPNHN8F7ckRiaZtp76v0KXiaibibdH9bfyDfqPrYWQibxej8Zzu0vKAC2JDuEkRHibZXWWfv0FzdCgYL0NZuQG7Q/0?wx_fmt=gif" style="box-sizing: border-box !important; word-wrap: break-word !important; visibility: visible !important; width: 240px !important; height: 240px !important;"></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><br></p><section label="Copyright Reserved by PLAYHUDONG." style="margin-top: 1em; margin-bottom: 1em; max-width: 100%; border-width: 0px; border-style: none; border-color: currentcolor; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section style="margin-left: 1em; max-width: 100%; line-height: 1.4; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="padding: 0.2em 0.5em; max-width: 100%; border-radius: 0.3em; color: white; background-color: rgb(102, 102, 102); font-size: 1em; font-family: inherit; font-weight: inherit; text-align: inherit; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">赞助商</span></section><section class="" style="margin-top: -0.7em; max-width: 100%; border-width: 1px; border-style: solid; border-color: rgb(192, 200, 209); border-radius: 0.4em; color: rgb(51, 51, 51); font-size: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section style="padding: 1.4em 1em 1em; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section style="max-width: 100%; font-size: 1em; font-family: inherit; font-weight: inherit; text-align: inherit; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">上海连尚网络科技有限公司成立于 2013 年，是一家专注于提供免费上网和内容服务的移动互联网企业。连尚网络自主研发的核心产品 WiFi 万能钥匙，以分享经济的模式，通过云计算和大数据技术，利用热点主人分享的闲置WiFi资源，为用户提供免费、稳定、安全的上网服务，以帮助更多的人上网，找到属于他们的机会，改变自己的命运。</span></p></section></section></section></section><p><br></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><br></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">往期热门内容推荐</strong></span></p><hr style="max-width: 100%; line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282630&amp;idx=1&amp;sn=61fcbc708235dec5d7897a0d7c315756&amp;chksm=b1815a0c86f6d31a50ba1f9a39d876e28f2c71096100b28e961df185f7be94ec77b9199efd51&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">等你来挑战！| 看雪 CTF 2017 攻击篇</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283714&amp;idx=2&amp;sn=6860ed543d45ce46c143d62479275880&amp;chksm=b1815e4886f6d75e9c39979e6d6d5cf956fd83d00cfca6e176ca33a6b3c795d711efe4d288df&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第十题 点评及解题思路</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283658&amp;idx=1&amp;sn=92d4cc9ae762907ade2609c59363ee7b&amp;chksm=b1815e0086f6d7166d68770b5bb3ec7efe248d1770776bb68c01770afef6ff6d453a36d472cf&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第九题 点评及解题思路</a><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283635&amp;idx=1&amp;sn=def939676120de30c65d44898160901e&amp;chksm=b1815ef986f6d7efd9d86a62eb3bfe062773edef30c226ae13afd2cf36ed7a49a07c9c3db914&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第八题 点评及解题思路</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283585&amp;idx=1&amp;sn=b42facf25a1a1e741f7aaaed109aa0d7&amp;chksm=b1815ecb86f6d7dd5450caae1483431e6f0853aaeb23ba3c9e392790173b1434d3faf43b732c&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第七题 点评及解题思路</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283466&amp;idx=1&amp;sn=0cbd1b491a917f860d9eeaa86e38ffdd&amp;chksm=b1815d4086f6d456026df9efc766abea7dfc2fa0940e6264200c15672d94976b697f331ff0a7&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">看雪.WiFi万能钥匙 CTF 2017第六题 点评及解题思路</a></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">更多比赛详情，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8F7ckRiaZtp76v0KXiaibibdH9bCfZtDdhqeqbk5LToic1TlqZZJ05wLxqexpbloufvSCKbUEPbEtFUzzQ/640?wx_fmt=jpeg" style="box-sizing: border-box !important; word-wrap: break-word !important; visibility: visible !important; width: 640px !important; height: 427px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">看雪论坛：http://bbs.pediy.com/</span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">商务合作<span style="max-width: 100%;"></span>：<span style="max-width: 100%;">wsc@kanxue.com</span></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;"><br></p><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; vertical-align: top; width: 100.5px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin-top: 10px; max-width: 100%; box-sizing: border-box; text-align: center; transform: translate3d(0px, 0px, 0px); font-size: 11.2px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="padding: 4px; max-width: 100%; box-sizing: border-box; display: inline-block; background-color: rgb(211, 0, 0); font-size: 11.2px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; border-color: white; width: 1.6em; height: 1.6em; border-style: solid; border-width: 1px; font-size: 16.8px; line-height: 1.5em; color: rgb(255, 255, 255); word-wrap: break-word !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; box-sizing: border-box; min-height: 1em; font-size: 16.8px; word-wrap: break-word !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important; overflow-wrap: break-word !important;">点</span></p></section></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; text-align: center; line-height: 0; overflow: hidden; transform: translate3d(0px, 0px, 0px); word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; display: inline-block; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="margin: auto; max-width: 100%; box-sizing: border-box; width: 2px; height: 1em; background-color: rgb(211, 0, 0); word-wrap: break-word !important; overflow-wrap: break-word !important;"></section></section></section><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; overflow-wrap: break-word !important;"><section class="" style="max-width: 100%; box-sizing: border-box; width: 0px; border-top: 1em solid rgb(211, 0, 0); word-wrap: break-word !important; overflow-wrap: break-word !important; border-left: 0.5em solid transparent !important; border-right: 0.5em solid transparent !important;"><br></section></section></section></section></section></section></section><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1499131012&src=3&ver=1&signature=iU4hCwtQzyv2pey6SDTnZ62YXf1MWi8Zh8usUjq2T6Tp8olMm-6I1I4qsl-rYUzkEslKlH6cxolxoLxftDKuPpeFpTQgtHRcMuA4-MRMtYxZxSfGIQSffnNQefzS6eHx3NihSSSlWXAZEArfcR3zINOZe9HCGsPm5Fci0MhYflU=">微信地址</a> | <a href="http://ctf.pediy.com/game-fight-42.htm">阅读原文</a>
{% endraw  %}

