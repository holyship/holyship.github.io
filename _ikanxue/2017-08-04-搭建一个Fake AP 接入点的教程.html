---
title: 搭建一个Fake AP 接入点的教程
author: 南极小虾
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1502116456&src=3&ver=1&signature=fMd4ZeYncDjRuvdiU8EiAqzwJV-51HguOx4pnyGlqXjJ10eFEeoZU*4ykBfJ5DfCcbB*9QgBsAKzwmoYzWJII-hlayPXydyD7jIiQJmiI8B1qG2RCMl8bYxxAUBel1-LpQI*pPRH*-KSOajqGqvMfC9cjYPJ1smClRbVKGbLo0M=
date: '2017-08-04 00:00:00 +0000'

---

{% raw  %}
<section style="background-color: rgb(255, 255, 255); box-sizing: border-box; text-align: center;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); text-align: center;"><strong><span style="letter-spacing: 2px;">简介</span></strong></p></section><p><br></p><p><br></p></section><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">假设你可以搭建一个假的无线WiFi接入点，并相应地进行Apache配置以愚弄受害者，这就是我们接下来要做的事。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">在这个案例中，我们使用的是一个Alfa无线网卡和一个以太网连接（在虚拟机下进行），用于可选的Internet访问。你还可以使用虚拟接口完美地运行此攻击，无需任何麻烦。确保您正确地使用接口名称。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: center;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><strong><span style="letter-spacing: 2px;">使用到的工具</span></strong><br></p></section><p><br></p><p><br></p></section></section><ul style="list-style-type: square;" class=" list-paddingleft-2"><li><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><em><span style="font-size: 15px; letter-spacing: normal;">hostapd (or airbase-ng)</span></em></p></li><li><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><em><span style="font-size: 15px; letter-spacing: normal;">dnsmasq (or isc-dhcp-server)</span></em></p></li><li><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><em><span style="font-size: 15px; letter-spacing: normal;">apache2</span></em></p></li><li><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><em><span style="font-size: 15px; letter-spacing: normal;">nano or vi Text Editor</span></em></p></li><li><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><em><span style="font-size: 15px; letter-spacing: normal;">grep</span></em></p></li><li><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><em><span style="font-size: 15px; letter-spacing: normal;">Secret Sauce</span></em><span style="font-size: 15px;"></span></p></li></ul><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">针对上面的所有选择，我选择前者—搭建一个简易的攻击场景。你也可以选择后者，这主要是根据你工具的使用情况</span></p><p style="margin: 20px 1em 15px; text-align: left; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: center;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><strong><span style="font-size: 16px; letter-spacing: 2px;">搭建一个AP</span></strong></p></section><p><br></p><p><br></p></section></section><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">介绍</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><strong><span style="font-size: 15px;">▶ Hostapd</span></strong></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">用来创建一个特定类型的接入点，它是开放的，主要用在WPA2加密机制的个人、企业网络攻击。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">把所有的东西都放在你的工具里，以便以后使用。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><strong><span style="font-size: 15px;">▶ Dnsmasq</span></strong></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">适用于配置DNS和DHCP的工具。它可以用于解决设备对DNS请求接收和应答，它也可以用作DHCP服务器给用户分配IP地址。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><strong><span style="font-size: 15px;">▶ Apache</span></strong></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">基本上，它对于用户就是一个web服务器。但是你可以使用这个功能强大的工具Apache来拓展你的we:b服务器和创建一个虚假WiFi接入点。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">虽然在渗透进程中没有必要用到apache 和mysql。hostapd&nbsp;和&nbsp;dnsmasq是在你搭建虚假AP必不可少的两个工具。虽然现在可能会有更先进的技术，根据你攻击的具体案例也可能会用到不同工具。但更先进的技术一般都会用到apache的灵活性和特点。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">例子：</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">假如你要强迫受害设备连接到你的AP，只是进行简单的嗅探和劫持，那你就没必要用到apache。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">但是万一你想向web响应基于用户发送的请求，你可以利用apache通过多种方法获取到大量的敏感信息。有点迷糊？别担心！</span><span style="font-size: 15px;">点这里</span><span style="font-size: 15px;">，会让你更加深入了解每个相关信息。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">我会教你在不同的攻击情景下使用apache, mySQL,在不同角色下渗透不同连接到虚假AP的用户设备像android, iPhone, Macs</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">但这个以后再说。先让我们继续学习和配置基础的工具例如&nbsp;hostapd,&nbsp;dnsmasq。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="color: rgb(127, 127, 127);"><strong><span style="font-size: 15px;">注意</span></strong><span style="font-size: 15px;">：所有的指令都是在root用户下执行。可以使用sudo指令来登入主账户</span></span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><strong><span style="font-size: 15px;">安装</span></strong><span style="font-size: 15px;">：</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">确保系统中安装的是最新版本的工具：</span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0MjZPDicibeoPicmIibmkmQXAZ5bp4L3y53hISgfBzRicPJqjlPbrU0ibP5uKwg/0?wx_fmt=png" style="width: 738px !important; height: 41.5645px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;"></span><span style="font-size: 15px;">现在创建一个路径，以后就可以把所有的配置文件都放在这里。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0Mj7BF80Ibwia46xSflXzDYcJgaA9Oqz5a3uhnoA7z63Iwed1vIqbj4rmA/0?wx_fmt=png" style="width: 738px !important; height: 43.3575px !important;"></p><p style="margin: 15px 1em; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><br></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: center;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><strong><span style="font-size: 16px; letter-spacing: 2px;">配置 </span><span style="font-size: 16px;">hostapd</span></strong></p></section><p><br></p><p><br></p></section></section><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">创建一个路径来保存配置文件。打开指令窗口，创建一个hostapd配置文件。</span></p><ul style="list-style-type: disc;" class=" list-paddingleft-2"><li><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px; letter-spacing: normal;">nano hostapd.conf</span></p></li></ul><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0Mjj48GHpRDV5vsPnH4nCvz0LtFXOBXxCiabjqmZkZlWMRNl0TeGb1xSPQ/0?wx_fmt=png" style="width: 738px !important; height: 125.303px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">点击保存，退出文件。根据每次你执行渗透，要记录你的更改</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">操作频道如果没有选好也会引起问题的。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><strong><span style="font-size: 15px;">配置dnsmasq</span></strong></p><ul style="list-style-type: disc;" class=" list-paddingleft-2"><li><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px; letter-spacing: normal;">nano dnsmasq.conf</span></p></li></ul><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0Mja1iaYyXWuhicia8yKkF8IkwrstITufd1bdgibKPv1CRjTc1xQoNpkxDvibw/0?wx_fmt=png" style="width: 738px !important; height: 127.305px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">确保在dnsmasq.conf&nbsp;文件中定义正确的端口。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">Parameter Breakdown：</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0MjR0byGB752HFVSSDrKVlibxss1vAjBt2UyNpgS0VEGYxQ7m9C7IIyVVA/0?wx_fmt=png" style="width: 738px !important; height: 54.4956px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">这就是所有的配置。很简单，不是吗？</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><strong><span style="font-size: 15px;">现在让我们运行服务器和我们的虚假AP</span></strong><span style="font-size: 15px;">。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: center;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><strong><span style="font-size: 16px;">第一步 启动虚假接入点</span></strong></p></section><p><br></p><p><br></p></section></section><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">首先，关闭一些已经在运行并可能会干扰我们进程的工具。</span></p><p style="margin-left: 8px; margin-right: 8px;">&nbsp;<img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GsSoLEoCcmgHAWrnWlZ3cziaLoY89WoojZodNOKIS3oqwuK5juapowuoNOWOZgOOtrWyIJeECqurA/0?wx_fmt=png" style="width: 375px !important; height: 21px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">启动hostapd并导入你的配置文件</span></p><p style="margin-left: 8px; margin-right: 8px;">&nbsp; <img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GsSoLEoCcmgHAWrnWlZ3czo1om7AMNic5uLoPYiaFibPSjiaz89L1gtianmrcooIv2r9pPALsp9dEr6dg/0?wx_fmt=png" style="width: 370px !important; height: 31px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0MjnIahkEribAM4QR46QuvMBMiaAlDaCEuWemZtjnHl3QuszicOFrXbqIIXQ/0?wx_fmt=png" style="width: 738px !important; height: 42.382px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">现在你已经启动hostapd并且在运行了，我们需要启动DHCP服务器来给接入用户分配IP地址</span></p><p><br></p><p><br></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: center;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><strong><span style="font-size: 16px; letter-spacing: 2px;">第二步 启动DHCP服务</span></strong></p></section><p><br></p><p><br></p></section></section><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">运行dnsmasq，在调试模式下加载配置文件</span></p><blockquote><p style="margin: 20px 1em 15px; text-align: left; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px; letter-spacing: normal;">Syntax: dnsmasq -C /path/to/configuration/file.conf -d</span></p></blockquote><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0MjMFAlLjpgmEDfvVke2gdbUwicpHSFBnZYQqd6YddOtxzPialk7h3JolQw/0?wx_fmt=png" style="width: 203px !important; height: 23px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><strong><span style="font-size: 15px;">可选配置</span></strong></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">你可以给dnsmasq创建一个可选的配置文件如fakehosts.conf，这样它就可以将你指定的IP地址劫持导向目标网站。它会简单地告诉用户设备他们点击的网站的服务器就是在我们的指向的IP地址</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0MjdcM4bauzKAXHVEkLdInC0CBict5HfoibqMQchL08UwpeyX7dPk5Rkkgw/0?wx_fmt=png" style="width: 738px !important; height: 130.995px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">就是这样。只要通过-H指令将文件链接到dnsmasq。然后只要你想攻击的客户设备访问这些网站的流量都会导向我们指定的网站或是一个特殊的用户。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0MjqKrIjYkeIibQV9a9Xl2AqGic2bGzUsWyooxgZxeHPNLoyTKibJIqwywBg/0?wx_fmt=png" style="width: 319px !important; height: 20px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;"></span><br></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: center;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><strong><span style="font-size: 16px; letter-spacing: 2px;">第三步 配置apache2 web服务器</span></strong></p></section><p><br></p><p><br></p></section></section><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">Apache的Rewrite Engine允许我们在进程中可以操作web请求。使用这个技术，我们可以劫持大量的客户设备。不管它是安卓、IOS设备，还是一个windows系统，或是一个Mac。你也可以设定apache web 服务器只攻击某一类型的目标，或者你甚至可以只攻击某一版本的操作系统。很醋！不是吗？</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">也就是说对不同版本的iOS 9.x 用户 和iOS 10用户设定不同的攻击路径，它也可以实现！</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">在这里，我们目标是<span style="font-size: 15px; letter-spacing: normal;">Windows</span>设备，因为它有最多的安装量。所以，相当多的黑客都会window设备作为攻击目标。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">编辑apache的默认配置文件来配置<span style="font-size: 15px; letter-spacing: normal;">rewrite</span>功能。这将会劫持几乎所有的URL包括子目录到我们虚假AP指定的页面</span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0MjYRbHUvkybQuqBrUFOXibrRicvClkPibghnby6ia3pRGBwuCJqmSSlKfxcg/0?wx_fmt=png" style="width: 311px !important; height: 21px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">记录下我们添加的路径： <span style="font-size: 15px; letter-spacing: normal;">/Fixit as an exception. </span>有区分大小写</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0MjNc2861RzyTic90Qk29TzAcIBtk5KkOVEotBqRicibPcMWATq2PdkhicUjw/0?wx_fmt=png" style="width: 738px !important; height: 169.029px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">使用你的社会工程学技巧和设计一个精巧的网页来诱惑用户下载和执行你的post请求。你需要<span style="font-size: 15px;"><span style="font-size: 15px; letter-spacing: normal;">在 /var/www/html/Fixit/</span> 路径下<span style="font-size: 15px;">添加</span></span><span style="font-size: 15px; letter-spacing: normal;">index.html<strong>。</strong></span></span><strong><span style="font-size: 15px;"><br></span></strong></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><strong><span style="font-size: 15px;">开启mod_rewrite模式</span></strong></p><p style="margin-left: 8px; margin-right: 8px;"><span style="font-size: 15px; letter-spacing: normal;"></span><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GsSoLEoCcmgHAWrnWlZ3czF2a0fiafuruKCKro6L9evzulR6xy25lxzH3sspIsicrc3Rc2icl0POHDg/0?wx_fmt=png" style="width: 123px !important; height: 23px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><strong><span style="font-size: 15px;">你必须重启apache2来更新配置</span></strong></p><p style="margin-left: 8px; margin-right: 8px;">&nbsp;<img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GsSoLEoCcmgHAWrnWlZ3czQbNopmTOhQsPLK0nHFam1JIxxmibemdapD2rkCblBPC9VAQK962ZK3w/0?wx_fmt=png" style="width: 168px !important; height: 17px !important;"></p><p style="margin-left: 8px; margin-right: 8px;"><br></p><p><br></p><p><br></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: center;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><strong><span style="font-size: 16px; letter-spacing: 2px;">第四步 欺骗DNS请求重定向到apache</span></strong></p></section><p><br></p><p><br></p></section></section><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">运行 dnsspoof工具 将简单地将所有 http (不是 https) 请求重定向到我们的 apache 服务器, 并且不会让受害者访问 internet (如果 ip 转发被禁用)。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">如果你是攻击目标域与互联网接入，这方法可能会失效,。在这种情况下, 使用 fakehosts 文件与 dnsmasq</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">但现在, 我们没有为被攻击设备提供互联网访问, 只是简单的攻击。所以, 运行</span></p><p style="margin-left: 8px; margin-right: 8px;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GsSoLEoCcmgHAWrnWlZ3czTlVRJMehibE8umUIJGoxXe9zVAfYF8fvUe2P8C7uNS1NicorY3JJFc5Q/0?wx_fmt=png" style="width: 482px !important; height: 22px !important;"></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: center;"><p style="text-align: center; box-sizing: border-box; background-color: rgba(1, 0, 0, 0); margin-top: 20px; margin-bottom: 15px;"><br></p><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><strong><span style="font-size: 16px; letter-spacing: 2px;">第五步 获取密码</span></strong></p></section><p><br></p><p><br></p></section></section><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">在输出附加数据模式下运行apache&nbsp;的access.log，通过grep进行输出。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">regex将解析导入的加密数据长达20字节SSID/名称、AP验证类型,8 - 64字符WLAN的秘钥。</span></p><blockquote><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 12px; letter-spacing: normal;">tail
 -F /var/log/apache2/access.log | grep -E -o 
"&lt;name&gt;.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?&lt;/name&gt;"\|"&lt;keyMaterial&gt;..?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?&lt;/keyMaterial&gt;"\|"&lt;authentication&gt;.?.?.?.?.?.?.?.?.?.?.?&lt;/authentication&gt;"
 | uniq</span><br></p></blockquote><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">Command Breakdown：</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0Mj6Oa23kq14icAIiaKayoW1d1zk3VlQ3g9C2lNFK6ofCicO3IEQGibxUEr5g/0?wx_fmt=png" style="width: 738px !important; height: 249.529px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">休息一下…</span></p><p><br></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: center;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><strong><span style="font-size: 16px; letter-spacing: 2px;">第六步 打包</span></strong></p></section><p><br></p><p><br></p></section></section><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">在 <span style="font-size: 15px; letter-spacing: normal;">/var/www/</span> 路径下创建一个叫做“Fixit”目录，有大小写之分</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0MjWHic7ibOy8ricibU564d0l5bwAQj7mOs8fOh8HQAqqnvjONlicNVqkGKRWg/0?wx_fmt=png" style="width: 150px !important; height: 21px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><br></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="Powered-by-XIUMI V5" style="box-sizing: border-box; text-align: center;"><section class="" style="padding: 3px; display: inline-block; border-bottom: 5px solid rgb(53, 56, 55); box-sizing: border-box;"><p style="margin: 0px; padding: 0px; box-sizing: border-box; background-color: rgba(1, 0, 0, 0);"><strong><span style="font-size: 16px; letter-spacing: 2px;">第七步 <span style="font-size: 16px; letter-spacing: normal;">Secret Sauce</span></span></strong></p></section><p><br></p><p><br></p></section></section><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px; letter-spacing: normal;">index. html</span><span style="font-size: 15px;"> 下载链接指向我的自定义文件，如 <span style="font-size: 15px; letter-spacing: normal;">Microsoft-windows-Hotfix. bat</span>。这个批处理文件不太复杂，它不会触发反病毒软件或受到任何防火墙的影响。如果 web 浏览器正常工作，这将起作用。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0Mj3PKp55C3Fj0AuqTBwAUwRTZD4g6p1GMeReiaIVd00ibicJXEF9Vf8jrbg/0?wx_fmt=png" style="width: 738px !important; height: 291.875px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">一旦受害者执行恶意的 wi-fi 密钥嗅探器，它将提取和解密 wlan 配置文件，打开受害者设备上的 ie 浏览器，url 指向 <span style="font-size: 15px; letter-spacing: normal;">microsoftfix.com</span> (我们的服务器)，并在 url 中捕获 wi-fi 密钥。所有的东西都存储在我们的 apache 日志中 (/var/日志/apache2/访问. log)</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">我选择了 url，因为它是发送数据到服务器的最安全的方式。ftp在少数计算机上会被防火墙阻止，但当受害者下载了文件时，它意味着浏览器可以在不触发反病毒的情况下用于信息传输。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">所有您需要做的是过滤数据的认证类型和秘钥材料 (wi-fi 密码)。我们在步骤5中过滤了，使用尾部和 grep 命令。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8GRy4lzB9EaoiaYBhIrqh0MjbUhiaMJyw2CvlibMprJhSyR6atf3DEAmib7Xv3kN8ibdLVnpteTxicbrgicw/0?wx_fmt=png" style="width: 738px !important; height: 56.4135px !important;"></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">不需要做任何额外的事情。一切都准备好了，看着证书的到来。</span></p><p style="margin: 20px 1em 15px; text-align: justify; letter-spacing: 2px; line-height: 1.75em;"><span style="font-size: 15px;">老实说，在这个阶段，这次攻击根本就不是隐形的，很粗略。</span></p><p><br></p><section label="Copyright © 2014 playhudong All Rights Reserved." style="border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; border-style: none; margin: 5px 0px 0px; padding: 10px 0px; background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%;"><img src="http://mmbiz.qpic.cn/mmbiz_png/1UG7KPNHN8G9B6YFlthnv1h3cWDDXGAmK9wQfy6pod114tTuOSIFVeVd0vd1PEwicksgBGmxL0iaC0icX7B9EQzNg/640?wx_fmt=png" style="margin: 0px auto; display: block; visibility: visible !important; width: 160px !important; height: 8.44575px !important;"></section><p><br></p><p style="letter-spacing: 1px; margin: 20px 1em 15px; text-align: center; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">本文由看雪翻译小组 南极小虾 编译，来源rootsh3ll@Harry</span></p><p style="letter-spacing: 1px; margin: 20px 1em 15px; text-align: center; line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">转载请注明来自看雪社区</span></p><p style="text-align: center;"><br></p><p style="text-align: center; margin-top: 20px; margin-bottom: 15px;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/1UG7KPNHN8HFWP586ic3Pf4F6hD1rnmHpScQgCs4x9dJWoHHNnoiamW5RMTq8alBq5UiahM3G1W9TK3RPXQHXWZUQ/640?wx_fmt=jpeg" style="visibility: visible !important; width: 770px !important; height: 381.992px !important;"></p><p style="text-align: center;"><br></p><p style="letter-spacing: 1px; margin: 20px 1em 15px; text-align: left; line-height: 1.75em;"><span style="font-size: 16px; color: rgb(63, 63, 63);">热门阅读</span></p><ul style="list-style-type: disc;" class=" list-paddingleft-2"><li><p style="letter-spacing: 1px; margin: 20px 1em 15px; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284266&amp;idx=1&amp;sn=4e3714835ada031a3ae3c86e44753194&amp;chksm=b181406086f6c97636d7e05ef95256655b529267c0e9702d6e6f8848c2357ad5626d079a9ad1&amp;scene=21#wechat_redirect" target="_blank">使用x64dbg+VS2015 Spy++去除广告弹框</a><br></span></p></li><li><p style="letter-spacing: 1px; margin: 20px 1em 15px; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284236&amp;idx=1&amp;sn=2b9e3b3cc4de69e91d5572a8961f572b&amp;chksm=b181404686f6c95030550e3e20f16a3923c719671b14d00391cc8879b944f9840bfac6c8139d&amp;scene=21#wechat_redirect" target="_blank">从 Android 源码看 SO 的加载</a></span></p></li><li><p style="letter-spacing: 1px; margin: 20px 1em 15px; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284229&amp;idx=2&amp;sn=61720f3a096b2e759adbdea8a96a189a&amp;chksm=b181404f86f6c959c89c32d3cc35be7546e0619e6f5ee61aec9dd1472daec95fb997d5c5e332&amp;scene=21#wechat_redirect" target="_blank">一个lpk.dll病毒的分析报告</a></span></p></li><li><p style="letter-spacing: 1px; margin: 20px 1em 15px; text-align: left; line-height: 1.75em;"><span style="font-size: 15px; text-decoration: none; color: rgb(63, 63, 63);"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458284255&amp;idx=1&amp;sn=a07808a74f61d543163a309214775b46&amp;chksm=b181405586f6c9438606b0c36e56e0c41b5b089e587b9dd991f59fffe72558259a752ddf981d&amp;scene=21#wechat_redirect" target="_blank">虚拟机保护技术浅谈</a><br></span></p></li></ul><p style="text-align: center;"><br></p><p style="text-align: center;"><br></p><p style="text-align: center; margin-top: 20px; margin-bottom: 15px;"><span style="font-size: 15px; background-color: rgb(178, 178, 178); color: rgb(63, 63, 63);">点击阅读原文/read，还有更多干货等着你~</span></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1502116456&src=3&ver=1&signature=fMd4ZeYncDjRuvdiU8EiAqzwJV-51HguOx4pnyGlqXjJ10eFEeoZU*4ykBfJ5DfCcbB*9QgBsAKzwmoYzWJII-hlayPXydyD7jIiQJmiI8B1qG2RCMl8bYxxAUBel1-LpQI*pPRH*-KSOajqGqvMfC9cjYPJ1smClRbVKGbLo0M=">微信地址</a> | <a href="http://bbs.pediy.com/thread-220074.htm">阅读原文</a>
{% endraw  %}

