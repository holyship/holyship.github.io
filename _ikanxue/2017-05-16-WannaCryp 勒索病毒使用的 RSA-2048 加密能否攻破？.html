---
title: WannaCryp 勒索病毒使用的 RSA-2048 加密能否攻破？
author: readyu
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1495451790&src=3&ver=1&signature=l12Tij*JEXuplVxFRWdZeeBDuFUhCzsMu*BB0SOQM33MAgARkNLSZo0jyCA7SaUudhiQ0fHPlvS7dX48MRKYXUlUswPIMKtuh7*nBAzOup8ifSqywIgFp4quTHk7T5If8eeVg4wvHNT4MhFgWHLkD14MjBohmcx8R9rGWajfJlo=
date: '2017-05-16 00:00:00 +0000'

---

{% raw  %}
<p style="line-height: 1.75em;"><span style="color: rgb(63, 63, 63); font-size: 16px;"><strong><span style="color: rgb(63, 63, 63);">看雪专家点评：</span></strong></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">WannaCryp 勒索病毒，采用 AES 算法加密文件，并使用非对称加密算法 RSA 2048 加密 AES 的密钥，每个文件使用一个随机密钥。<br><br>RSA 公钥算法的安全性，建立在一个数学难题之上：<strong>大整数的因子分解</strong>。目前公开的已做到 RSA Number 的分解规模是 768 bits。</span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">分解1024 bit 以上的RSA Number， 目前属于一个巨大的工程学难题，要有大规模的计算能力才能够进行下去。</span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">小规模的 team， 限于财力也就只能分解 768 bits 这个量级的，分解 RSA-768，采用了数百个 CPU Cores，运行约 2 年时间。<br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">分解 RSA-512，对个人用户相对简单。用 GNFS， 这里面主要的筛法时间按 3000&nbsp; cpu-hours 计算，30 个 CPU Cores，在一个星期之内可以完成。<br><br>根据 Wiki 公开的论文，已完成的几个标志性 RSA Number 分解如下：</span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1999 年分解 RSA-512 (155 decimal digits),</span></p></li><li><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2005 年分解 RSA-640 (193 decimal digits),</span></p></li><li><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2009 年分解 RSA-768 (232 decimal digits)。</span></p></li></ul><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">从历史看来，如果计算能力每1年能够翻1倍；差不多每10年，传统计算机的计算能力扩大一千倍（2^10 = 1024），能推进约256 bit(80 digits )。 可以估计，用目前的gnfs 算法，加上足够的人力财力支撑，最乐观的估计,分解RSA 2048，也就是40-50年内的事情。</span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2020 年能分解掉 RSA-1024(309 decimal digits);</span></p></li><li><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2040 年能分解掉 RSA-1536(463 decimal digits);</span></p></li><li><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">2060 年能分解掉 RSA-2048(617 decimal digits)。</span></p></li></ul><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">但是，科学技术上爆发性的突破，往往能超越常规。这里还有一个变数，就是实用型的量子计算机什么时候有突破进展。</span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">1994年，Peter Shor 提出量子计算机的因子分解算法，被称为 Shor 算法。当时人们对于制造出实际可用的量子计算机的预期并不乐观。<br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);"><br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px; color: rgb(63, 63, 63);">目前，实验室里的量子计算机，只能分解很简单的两位整数的因子，比如 21 = 3*7。<br><br>实用量子计算机，按最乐观的估计，至少在十年以后才可能出现。所以，RSA-2048 当前是不可破解的。 <br><br><br>参考文献:<br>https://en.wikipedia.org/wiki/RSA_numbers</span><span style="font-size: 15px;"><br></span></p><p style="line-height: 1.75em;"><span style="font-size: 15px;"><br></span></p><p><br></p><p style="text-align: center;"><img src="/ikanxue/images/bc5a2394ecea3db09f04aab04177227b2f8c5ab3.png" style="width: 361px !important; height: 296px !important;"></p><p style="text-align: center;"><br></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">你可能对以下内容感兴趣：<br></strong></span></p><hr style="max-width: 100%; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282630&amp;idx=1&amp;sn=61fcbc708235dec5d7897a0d7c315756&amp;chksm=b1815a0c86f6d31a50ba1f9a39d876e28f2c71096100b28e961df185f7be94ec77b9199efd51&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">等你来挑战！| 看雪 CTF 2017 攻击篇</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282621&amp;idx=1&amp;sn=15f5bc0fa2b0b34ae241668b23a3939b&amp;chksm=b1815af786f6d3e1fd4bad2c336d725ec600551a6477bbc4c6af93167074ac83873aeba89938&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">【终于等到你！】看雪 CTF 2017</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282703&amp;idx=1&amp;sn=7ed476d577172ff4b4a93807dae2667c&amp;chksm=b1815a4586f6d35373f6c5d783fa99a7bb7cf2fc35da914761a9cf2d9943a09c1aefb9febfbf&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">春风十里，我在等你</span></a></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282923&amp;idx=1&amp;sn=be6293777eace8c4579dfa2688d014bf&amp;chksm=b1815b2186f6d237a72ae3dee7e29c4c2ec7a140b110daa7eb808723f58bf852e191eebcbdfc&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282923&amp;idx=1&amp;sn=be6293777eace8c4579dfa2688d014bf&amp;chksm=b1815b2186f6d237a72ae3dee7e29c4c2ec7a140b110daa7eb808723f58bf852e191eebcbdfc&amp;scene=21#wechat_redirect">蠕虫勒索软件WannaCrypt0r的行为分析</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282703&amp;idx=3&amp;sn=bfa728ff73cd389cd9258ca32008c6e2&amp;chksm=b1815a4586f6d353468f3adf9545aab3ffdce4f4c3e0e47c967298eca045db0558e37865c3a7&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282923&amp;idx=2&amp;sn=97b766ca3c3ed53d3135be937135e789&amp;chksm=b1815b2186f6d237e580205d6de5dae235d77732aa6eed5a4f124c042b59da07abcfe1c61081&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282923&amp;idx=2&amp;sn=97b766ca3c3ed53d3135be937135e789&amp;chksm=b1815b2186f6d237e580205d6de5dae235d77732aa6eed5a4f124c042b59da07abcfe1c61081&amp;scene=21#wechat_redirect" style="font-size: 15px; text-decoration: none;"><span style="font-size: 15px;">还能和wannacry的黑客讨价还价？</span></a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282903&amp;idx=1&amp;sn=ba8828786e9717016b399020a2427850&amp;chksm=b1815b1d86f6d20b9a60848ac2165b8ecacc8809f91851f2ffefc2bcd49f2007c07f42620f99&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282903&amp;idx=1&amp;sn=ba8828786e9717016b399020a2427850&amp;chksm=b1815b1d86f6d20b9a60848ac2165b8ecacc8809f91851f2ffefc2bcd49f2007c07f42620f99&amp;scene=21#wechat_redirect">谁动了我的论文？我们来扒一扒勒索软件的前世今生</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">......<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">更多优秀文章，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><img src="/ikanxue/images/a0942aca19665d63c4ee222be971a37cd63dc1e4.jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 640px !important; height: 426px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;">看雪论坛：http://bbs.pediy.com/<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">投稿、合作：www.kanxue.com</span></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1495451790&src=3&ver=1&signature=l12Tij*JEXuplVxFRWdZeeBDuFUhCzsMu*BB0SOQM33MAgARkNLSZo0jyCA7SaUudhiQ0fHPlvS7dX48MRKYXUlUswPIMKtuh7*nBAzOup8ifSqywIgFp4quTHk7T5If8eeVg4wvHNT4MhFgWHLkD14MjBohmcx8R9rGWajfJlo=">微信地址</a> | <a href="http://bbs.pediy.com">阅读原文</a>
{% endraw  %}

