---
title: 【OSG】macOS 10.12.2本地提权和XNU port 堆风水
author: 看雪学院
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1496307545&src=3&ver=1&signature=93SzgWWUmeel8Ref4eZJuIODr9gzme7fJtytKfz*8Te*huPLcrDR7zVn0cJjpY*sniFCQ4qoj4lMopJTTObiD58jTIcDUjLeeNRUJ-oVq9*6OORnuZ2kCrmkQXwyXPOYu4g31yzK*Dxb*ahdFCEAU2nrBg-n18l3c0UnNzU8GQY=
date: '2017-05-29 00:00:00 +0000'

---

{% raw  %}
<section label="Copyright Reserved by ipaiban.com." style="text-align: left; margin: 5px 0px 0px; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; border-style: none;"><section style="display: inline-block; padding: 0.5em; border-radius: 3px; color: white; font-size: 1em; box-shadow: 0.1em 0.1em 0.2em rgb(165, 165, 165); background-color: rgb(0, 0, 0);"><p class="" style="color: rgb(255, 255, 255); line-height: 22px; font-size: 18px;">0×00 简介<br></p></section></section><h2 style="margin-top: 5px; margin-bottom: 5px; line-height: normal;"><span style="font-size: 15px;"></span><br></h2><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">从yalu 10.2 中，我们可以学到很多新的漏洞利用技术，特别是XNU堆风水和绕过内核保护。 在本文中，我们将讨论XNU堆风水的一些技术细节，并使用该技术在macOS中获得root权限。最后但同样重要的是，漏洞源码可以从以下网址下载：</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><a style="font-size: 15px; text-decoration: underline;"><span style="font-size: 15px;">https://github.com/zhengmin1989/macOS-10.12.2-Exp-via-mach_voucher</span></a></p><p style="margin-top: 5px; margin-bottom: 5px; line-height: normal;"><span style="font-size: 15px;">&nbsp;</span></p><section label="Copyright Reserved by ipaiban.com." style="text-align: left; margin: 5px 0px 0px; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; border-style: none;"><section style="display: inline-block; padding: 0.5em; border-radius: 3px; color: white; font-size: 1em; box-shadow: 0.1em 0.1em 0.2em rgb(165, 165, 165); background-color: rgb(0, 0, 0);"><p class="" style="color: rgb(255, 255, 255); line-height: 22px; font-size: 18px;"><span style="font-size: 18px;">0x01 内核堆栈溢出</span></p></section></section><h2 style="margin-top: 5px; margin-bottom: 5px; line-height: normal;"><span style="font-size: 15px;"></span><br></h2><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">为了使用XNU堆风水在macOS 10.12中获得root权限，我们需要一个内核漏洞。在本文中，我们选择mach_voucher堆溢出为例，Mach_voucher_extract_attr_recipe_trap() 是可以在沙箱内被调用的Mach陷阱。这是在iOS 10和macOS 10.12中新添加的功能，但是它含有一个严重的缓冲区溢出漏洞。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/883630b4e1dcb3867895b8129aebf1a1a1618ce0.png" style="width: 602px !important; height: 118px !important; visibility: visible !important;"></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">在这个函数中，args-&gt;recipe_size是一个指向整数的用户态指针，所以mach_voucher_extract_attr_recipe_trap() 将通过copyin() 从用户态拷贝size的值。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/d6522fba71d8a1f30be05424494ef3e37ca6e3ce.png" style="width: 561px !important; height: 181px !important;"></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">然后该函数使用sz值在内核堆上分配一个内存块。但是，开发人员忘记了args-&gt; recipe_size是一个用户态指针，然后将其用做copyin() 中的 size 值。 我们知道用户态指针可能大于sz值，这将导致内核堆中的缓冲区溢出。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">请注意，如果我们要在该地址上分配一个内存块，我们可能无法控制用户态指针的地址。不过这不是问题。如果遇到未映射的内存，copyin() 函数会自动停止。 所以，我们可以在高地址上分配一个内存块，然后通过取消映射其余的内存块来控制溢出数据。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/b416ab93c60fd6e743dc64d2f4995d8cb6da877f.png" style="width: 603px !important; height: 89px !important;"></p><p style="margin-top: 5px; margin-bottom: 5px; line-height: normal;"><br></p><section label="Copyright Reserved by ipaiban.com." style="text-align: left; margin: 5px 0px 0px; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; border-style: none;"><section style="display: inline-block; padding: 0.5em; border-radius: 3px; color: white; font-size: 1em; box-shadow: 0.1em 0.1em 0.2em rgb(165, 165, 165); background-color: rgb(0, 0, 0);"><p class="" style="color: rgb(255, 255, 255); line-height: 22px; font-size: 18px;"><span style="font-size: 18px;">0x02 通过 port 进行堆风水</span></p></section></section><h2 style="margin-top: 5px; margin-bottom: 5px; line-height: normal;"><span style="font-size: 15px;"></span><br></h2><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">在iOS 10和macOS 10.12中，苹果添加了一个新的防护机制，用以检查在错误区域释放的攻击，因此我们无法使用经典的vm_map_copy（修改vm_map_size）技术来执行堆风水。另外，苹果在iOS 9.2和macOS 10.11中添加了一个空闲列表（freelist）随机化的机制，所以我们不能较容易地预测再分配的内存块的位置。 为了解决这些问题，我们需要一个新的堆风水技术。在Yalu 10.2中，qwertyoruiop使用OOL_PORTS来获取可用于执行任意内核内存读写的内核任务端口。 这种技术绕过了XNU堆中的所有防护机制。接下来，我们将讨论这种技术的细节。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">Mach msg是XNU中最常用的IPC机制，大量消息通过 “complicated message” 发送。通过MACH_MSG_OOL_PORTS_DESCRIPTOR msg_type的 ”complicated message”，我们可以向内核发送out-of-line端口。例如，我们发送了32个MACH_PORT_DEAD ool端口（32 * 8字节=0x100字节）到内核的kalloc.256区域。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/bfc0a17c221bcf6a8420d08fb6cc7f8c88d050b4.png" style="width: 605px !important; height: 241px !important;"></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">保存在mach msg中的ool端口都是ipc_object类型的指针，这类指针可以指向用户态地址。 因此，我们可以使用mach_voucher漏洞来溢出这些指针，并在用户态下修改一个ipc_object指针，使它指向一个伪造的ipc_object。 另外，我们也可以在用户态下为假的端口创建假的任务。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/ad3c129cb377a7aba92529b34c212882513e05ac.png" style="width: 600px !important; height: 287px !important;"></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">为了保证溢出正确的ipc_object指针，我们需要做一些堆风水操作。 首先，为了确保新分配的内存块是连续的，我们向内核发送大量的ool端口消息。 然后使用在中间收到的一些消息戳一些slots。 然后我们再次发送一些消息，使得溢出点在slots的中间部位。 最后，我们使用mach_voucher在溢出点触发堆溢出。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/12375dd528b93c086ae936328aaa58c3889f5181.png" style="width: 612px !important; height: 327px !important;"></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">溢出之后，我们可以接收到剩余得 mach 消息，来找到被破坏的端口（不是MACH_PORT_DEAD 端口）。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/7f127020f26bfe0c0f795843ad58367489b7a7c5.png" style="width: 624px !important; height: 337px !important;"></p><p style="margin-top: 5px; margin-bottom: 5px; line-height: normal;"><br></p><section label="Copyright Reserved by ipaiban.com." style="text-align: left; margin: 5px 0px 0px; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; border-style: none;"><section style="display: inline-block; padding: 0.5em; border-radius: 3px; color: white; font-size: 1em; box-shadow: 0.1em 0.1em 0.2em rgb(165, 165, 165); background-color: rgb(0, 0, 0);"><p class="" style="color: rgb(255, 255, 255); line-height: 22px; font-size: 18px;"><span style="font-size: 18px;">0x03 内核内存任意读写</span></p></section></section><h2 style="margin-top: 5px; margin-bottom: 5px; line-height: normal;"><span style="font-size: 15px;"></span><br></h2><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">首先，我们将伪造的 ipc_object的io_bits 设置为 IKOT_CLOCK。所以我们可以使用clock_sleep_trap() 通过遍历内核来获取内核中计时任务的地址。 这个地址将帮助我们稍后找到内核数据。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/0461806965e7a63ac4179df204184a120942bb1c.png" style="width: 569px !important; height: 303px !important;"></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">然后我们将伪造的ipc_object的io_bits设置为IKOT_TASK，为假的端口制造一个假的任务。 通过将值设置为faketask + 0x380（在arm64中为0x360），我们可以通过pid_for_task() 读取任意32位内核内存。这是因为该函数不检查任务的有效性，只返回（（faketask + 0x380）+ 0x10）的值。 所以我们可以在没使用任何工具和ROP的情况下获得可造性内核读取。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/d47a9ab5564e29af9df146918a63e44a31b77a6a.png" style="width: 649px !important; height: 199px !important;"></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/995dbfc7bce8c85aef1e810901b71d415aa5f57f.png" style="width: 656px !important; height: 142px !important;"></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">通过计时任务泄露内核地址，我们可以在内存中搜索内核镜像的魔数，然后找到kslide。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/cb6291abf72927af58e6e2259bf6cd566794b909.png" style="width: 644px !important; height: 259px !important;"></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">获取内核基地址后，我们可以遍历所有进程来查找内核ipc_object和内核任务。然后我们可以dump出这些信息，给我们的伪造的ipc_object和任务。通过对假的ipc_object和任务使用task_get_special_port() ，我们可以获得内核任务端口。请注意，内核任务端口是非常强大的。它可以通过mach_vm_read（）和mach_vm_write（）进行任意内核内存读写。</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/c0630b4f4e464a5ca320b8cef0667c9301cf0434.png" style="width: 630px !important; height: 219px !important;"></p><section label="Copyright Reserved by ipaiban.com." style="text-align: left; margin: 5px 0px 0px; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; border-style: none;"><section style="display: inline-block; padding: 0.5em; border-radius: 3px; color: white; font-size: 1em; box-shadow: 0.1em 0.1em 0.2em rgb(165, 165, 165); background-color: rgb(0, 0, 0);"><p class="" style="color: rgb(255, 255, 255); line-height: 22px; font-size: 18px;"><span style="font-size: 18px;">0x04 root 提权</span></p></section></section><p style="margin-top: 5px; margin-bottom: 5px; line-height: normal;"><span style="font-size: 15px;"><br></span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">每个进程的凭据信息，posix_cred结构，存储在内核内存中。首先我们需要找到我们的进程信息（通过内核基址+ allproc），然后找到我们的利用程序的posix_cred结构数据。 之后，我们通过kernel_task_port使用mach_vm_write() ,将cr_ruid（实际用户ID）值设置为0（也就是root）。最后，而且非常重要的是，我们可以使用system（“/ bin / bash”）获取root shell！</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><img src="/ikanxue/images/15e229354337699c6ae2cb1e27c091bd26e089d8.png" style="width: 619px !important; height: 221px !important;"></p><section label="Copyright Reserved by ipaiban.com." style="text-align: left; margin: 5px 0px 0px; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; border-style: none;"><section style="display: inline-block; padding: 0.5em; border-radius: 3px; color: white; font-size: 1em; box-shadow: 0.1em 0.1em 0.2em rgb(165, 165, 165); background-color: rgb(0, 0, 0);"><p class="" style="color: rgb(255, 255, 255); line-height: 22px; font-size: 18px;"><span style="font-size: 18px;">0x05 总结</span></p></section></section><h2 style="margin-top: 5px; margin-bottom: 5px; line-height: normal;"><span style="font-size: 15px;"></span><br></h2><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">在本文中，我们介绍了如何使用mach_voucher堆溢出和port堆风水来实现macOS 10.12.2上的本地提权。漏洞源码可以从下面的网址下载：</span></p><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><a style="font-size: 15px; text-decoration: underline;"><span style="font-size: 15px;">https://github.com/zhengmin1989/macOS-10.12.2-Exp-via-mach_voucher</span></a></p><p><br></p><section label="Copyright Reserved by ipaiban.com." style="text-align: left; margin: 5px 0px 0px; border-width: medium; border-color: currentcolor; -moz-border-top-colors: none; -moz-border-right-colors: none; -moz-border-bottom-colors: none; -moz-border-left-colors: none; padding: 10px; border-style: none;"><section style="display: inline-block; padding: 0.5em; border-radius: 3px; color: white; font-size: 1em; box-shadow: 0.1em 0.1em 0.2em rgb(165, 165, 165); background-color: rgb(0, 0, 0);"><p class="" style="color: rgb(255, 255, 255); line-height: 22px; font-size: 18px;"><span style="font-size: 18px;">0x06 参考</span></p></section></section><h2 style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;"></span><br></h2><ol class="list-paddingleft-2" type="1"><li><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><span style="font-size: 15px;">Yalu 102: </span><a style="font-size: 15px; text-decoration: underline;"><span style="font-size: 15px;">https://github.com/kpwn/yalu102</span></a></p></li><li><p style="line-height: 1.75em; margin-top: 10px; margin-bottom: 10px;"><a style="font-size: 15px; text-decoration: underline;"><span style="font-size: 15px;">https://bugs.chromium.org/p/project-zero/issues/detail?id=1004</span></a></p></li></ol><p><br></p><p><span style="font-size: 14px; color: rgb(136, 136, 136);">本文由看雪 iOS 安全小组<span style="color: rgb(136, 136, 136); font-size: 14px; line-height: 1.7;"> 依然范特西 编译， <span style="color: rgb(136, 136, 136); font-size: 14px; line-height: 1.7;">布兜儿</span>校对，来源</span>Min (Spark) Zheng @ Team OverSky</span></p><p><span style="font-size: 15px;"><strong><span style="color: rgb(136, 136, 136);"><br></span></strong></span></p><p style="text-align: center;"><span style="font-size: 15px;"><strong><span style="font-size: 15px; color: rgb(217, 33, 66);">&nbsp;戳下图加入看雪 iOS 安全小组<span style="font-size: 14px;">~</span></span></strong></span><span style="font-size: 14px; color: rgb(136, 136, 136);"><br></span></p><p style="text-align: center;"><span style="font-size: 14px; color: rgb(136, 136, 136);"><br></span></p><p><span style="font-size: 14px; color: rgb(136, 136, 136);"></span></p><p style="text-align: center;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282155&amp;idx=3&amp;sn=268dcf5caba5e3f196a9b8fa36e6922a&amp;chksm=b181582186f6d13775b6c388b02e8bc0c6b4685d03964bbb74ebfb26787425f57c5b7e52a040&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282155&amp;idx=3&amp;sn=268dcf5caba5e3f196a9b8fa36e6922a&amp;chksm=b181582186f6d13775b6c388b02e8bc0c6b4685d03964bbb74ebfb26787425f57c5b7e52a040&amp;scene=21#wechat_redirect"><img src="/ikanxue/images/5250531b9cef9394fdf9f1b4037bf16d7ad4949d.png" style="width: 479px !important; height: 261px !important;"></a></p><p><br></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(79, 138, 187); box-sizing: border-box !important; overflow-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">你可能对以下内容感兴趣：<br></strong></span></p><hr style="max-width: 100%; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; line-height: 25.6px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p><ul class="list-paddingleft-2" style="list-style-type: circle;"><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282630&amp;idx=1&amp;sn=61fcbc708235dec5d7897a0d7c315756&amp;chksm=b1815a0c86f6d31a50ba1f9a39d876e28f2c71096100b28e961df185f7be94ec77b9199efd51&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">等你来挑战！| 看雪 CTF 2017 攻击篇</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282621&amp;idx=1&amp;sn=15f5bc0fa2b0b34ae241668b23a3939b&amp;chksm=b1815af786f6d3e1fd4bad2c336d725ec600551a6477bbc4c6af93167074ac83873aeba89938&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">【终于等到你！】看雪 CTF 2017</a></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 15px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283039&amp;idx=2&amp;sn=7965f942fd1629eb4b0502b01a522998&amp;chksm=b1815c9586f6d583b224490858104e7a5e5affad9542fe33da744c091ec234c3a55016f41690&amp;scene=21#wechat_redirect" target="_blank">MS17-010 SMB 远程命令执行漏洞利用分析</a><br></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283033&amp;idx=2&amp;sn=7a0d3fa2c8c5e2bdcac6379351269330&amp;chksm=b1815c9386f6d585439b2186c5fc7099c74ce5398483563db182f868911a3a2c6c4be7500021&amp;scene=21#wechat_redirect" target="_blank">新手逆向学习--Win7 下 64 位扫雷逆向以及辅助制作</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458282703&amp;idx=3&amp;sn=bfa728ff73cd389cd9258ca32008c6e2&amp;chksm=b1815a4586f6d353468f3adf9545aab3ffdce4f4c3e0e47c967298eca045db0558e37865c3a7&amp;scene=21#wechat_redirect" target="_blank" style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283005&amp;idx=2&amp;sn=2fc411b70549c789085e517ef6dfc3e9&amp;chksm=b1815b7786f6d261975cd000d4ddf2c4cffe3cf2d8ab06d870e7971e862c29c7278996bdfb6c&amp;scene=21#wechat_redirect" target="_blank" style="font-size: 15px; text-decoration: none;"><span style="font-size: 15px;"></span></a><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283075&amp;idx=2&amp;sn=f34b3415519c129a9f829d5fe1673134&amp;chksm=b1815cc986f6d5df43c4d7cdb4be3e16e498f13d4cb60c7e1b41349fee9b4ba5b5d176b0713f&amp;scene=21#wechat_redirect" target="_blank" style="font-size: 15px; text-decoration: none;"><span style="font-size: 15px;">WannaCry深度详细分析报告(偏重策略)</span></a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&amp;mid=2458283003&amp;idx=1&amp;sn=bcfd852aea24f274bf8fda85f9300a85&amp;chksm=b1815b7186f6d26758f7f0f1cb0c7ec9da888ab0d80a7b2e2850453bfc03f05640443839d7bf&amp;scene=21#wechat_redirect" target="_blank">【原创】WannaCry勒索软件中“永恒之蓝”漏洞利用分析</a><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; min-height: 1em; line-height: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">......<br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p></li></ul><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">更多优秀文章，长按下方二维码，“<span style="max-width: 100%; color: rgb(0, 122, 170);">关注看雪学院公众号</span>”查看！</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><img src="/ikanxue/images/a0942aca19665d63c4ee222be971a37cd63dc1e4.jpeg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 640px !important; height: 426px !important;"></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span><span style="max-width: 100%; color: rgb(178, 178, 178); box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 15px;">看雪论坛：http://bbs.pediy.com/</span><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 14px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微信公众号 ID：ikanxue</span></p><p style="margin-top: 15px; margin-bottom: 15px; max-width: 100%; min-height: 1em; line-height: 1.75em; box-sizing: border-box !important; overflow-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">微博：看雪安全</span></p><p><span style="max-width: 100%; color: rgb(178, 178, 178); font-size: 15px; box-sizing: border-box !important; overflow-wrap: break-word !important;">投稿、合作：www.kanxue.com</span></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1496307545&src=3&ver=1&signature=93SzgWWUmeel8Ref4eZJuIODr9gzme7fJtytKfz*8Te*huPLcrDR7zVn0cJjpY*sniFCQ4qoj4lMopJTTObiD58jTIcDUjLeeNRUJ-oVq9*6OORnuZ2kCrmkQXwyXPOYu4g31yzK*Dxb*ahdFCEAU2nrBg-n18l3c0UnNzU8GQY=">微信地址</a> | <a href="http://bbs.pediy.com/thread-217845.htm">阅读原文</a>
{% endraw  %}

