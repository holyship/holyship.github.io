---
title: 一种新型蠕虫：花瓣CORSBOT蠕虫
author: 余弦
date: '2017-01-29 00:00:00 +0000'

---

{% raw  %}
<p>新年新气象，这个蠕虫我做了小范围测试，也提交了官方修复，小圈子里做了分享，这里正式对外公布下，出于研究而非破坏为目的，供大家参考。</p><p><br></p><blockquote><p>IAMANEWBOTNAMEDCORSBOT</p><p>——-BOT PoC——-</p><p><span style="color: rgb(192, 0, 0); max-width: 100%; box-sizing: border-box ! important; overflow-wrap: break-word ! important; font-size: 16px;">http://evilcos.me/lab/IAMANEWBOTNAMEDCORSBOT.TXT</span></p></blockquote><p><br></p><p>完整代码直接见上面这个链接即可。</p><p><br></p><p>里面需要特别注意的两个点：</p><ol style="list-style-type: decimal;" class="list-paddingleft-2"><li><p>Conten-Type是JSON</p></li><li><p>Origin是：huaban.com.al3rt.io，这个小技巧直接绕过花瓣的Origin判断</p></li></ol><p><br></p><p>所以，蠕虫得以传播。</p><p><br></p><p>本质是：CORS(Cross-Origin Resource Sharing)的滥用导致，效果图：</p><p><img src="http://mmbiz.qpic.cn/mmbiz_png/kicMePHlP6TAxD6nuHLmbz3vuibVoZIYOT0gSQR9d8WwWrqOywbogIHgNcOw4FYA7xg7MUicuGdrRiaavuHzexkg4Q/0?wx_fmt=png" style="width: auto !important; height: auto !important; visibility: visible !important;"></p><p><br></p><p>最后，友情提示下：这个问题还是比较普遍的。脑洞怎么开，玩起来才会知道，不玩永远想不到:-)</p><p><br></p><hr><p><br></p><p>这次蠕虫和以往的一次一样，拿 Fenng 做测试突破口，毕竟他粉丝多，哈哈，不过那天他没活跃，逃过一劫...</p><p><br></p><p>这篇技术性还是很强的，看不懂的同学假装看懂吧，大过年的，开心就好...<br></p><p><br></p><p><span style="max-width: 100%; font-size: 14px; box-sizing: border-box ! important; overflow-wrap: break-word ! important;">-----------------</span></p><p style="max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; background-color: rgb(255, 255, 255); box-sizing: border-box ! important; overflow-wrap: break-word ! important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box ! important; overflow-wrap: break-word ! important;">微信公众号「<span style="max-width: 100%; color: rgb(192, 0, 0); box-sizing: border-box ! important; overflow-wrap: break-word ! important;"><strong style="max-width: 100%; box-sizing: border-box ! important; overflow-wrap: break-word ! important;">Lazy-Thought</strong></span>」</span></p><p style="max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; background-color: rgb(255, 255, 255); box-sizing: border-box ! important; overflow-wrap: break-word ! important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box ! important; overflow-wrap: break-word ! important;">几个黑客在维护，都很懒，都想改变点什么</span></p>
{% endraw  %}

