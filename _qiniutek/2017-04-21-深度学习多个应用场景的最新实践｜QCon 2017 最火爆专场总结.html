---
title: 深度学习多个应用场景的最新实践｜QCon 2017 最火爆专场总结
author: 七牛云
date: '2017-04-21 00:00:00 +0000'

---

{% raw  %}
<section><section class="" style="   box-sizing: border-box; " powered-by="xiumi.us"><section class="" style="   box-sizing: border-box; "><section class="" style="line-height: 1.8; text-align: justify; padding-right: 4px; padding-left: 4px; box-sizing: border-box;"><p style="white-space: normal; box-sizing: border-box;">上周末，QCon 2017 在北京隆重召开。作为技术领域内最受关注、口碑最佳的技术大会之一，现场自然是前沿主题和明星讲师云集。在七牛云<strong><span style="font-size: 16px;"><span style="color: rgb(51, 51, 51); font-family: Arial, sans-serif; background-color: rgb(255, 255, 255);">「</span>深度学习最新进展与实践<span style="color: rgb(51, 51, 51); font-family: Arial, sans-serif; background-color: rgb(255, 255, 255);">」</span></span></strong>专场的门前，甚至排起了长队，参会听众对于深度学习知识的渴求和本专场内容的认可可见一斑。</p><p style="white-space: normal; box-sizing: border-box; line-height: normal;"><br></p><p><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ6icXmP3OujrXcNxxuhVAMM1Efy8IzW5jLSicHJb1IKxWl3YyM66qjwI8eP7yGZre3DscK60k4nDqEg/0?wx_fmt=jpeg" style="width: 762px !important; height: 571.5px !important; visibility: visible !important;"></p><p style="white-space: normal; box-sizing: border-box; text-align: center;"><span style="color: rgb(136, 136, 136); font-size: 14px;">水泄不通的场内</span></p><p style="white-space: normal; box-sizing: border-box; text-align: center; line-height: normal;"><br></p><p><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ6icXmP3OujrXcNxxuhVAMM1KNSWe2raxvvXNCbGEWnvQqKtWrgPsibg6zqibecjia0Fyj0nfiarWCAQIA/0?wx_fmt=jpeg" style="width: 762px !important; height: 571.5px !important;"></p><p style="white-space: normal; box-sizing: border-box; text-align: center;"><span style="font-size: 14px; color: rgb(136, 136, 136);">活动进行时场外排队的人群</span></p><p style="white-space: normal; box-sizing: border-box; text-align: center; line-height: normal;"><br></p><p style="white-space: normal; box-sizing: border-box; text-align: center;"><strong>为什么会选择深度学习这一主题?</strong></p><p style="white-space: normal; box-sizing: border-box;"><br></p><p style="white-space: normal; box-sizing: border-box;">在出品人许式伟看来，首先是因为深度学习在近年内有了落地的进展成果。虽然<strong><span style="font-size: 16px;"><span style="color: rgb(51, 51, 51); font-family: Arial, sans-serif; background-color: rgb(255, 255, 255);">「</span>AI（人工智能）<span style="color: rgb(51, 51, 51); font-family: Arial, sans-serif; background-color: rgb(255, 255, 255);">」</span></span></strong>的概念早在 1956 年就于达特茅斯会议（Dartmouth Conferences）被提出，但从去年至今，深度学习的快速发展则真正驱动了 AI 的大爆发。深度学习的出现拓展了人工智能的整体范围，实现了很多实际的应用；并且将任务拆分，使得各种类型的机器辅助也变成可能。再者，作为有大量非结构化数据的七牛，也想利用深度学习帮助客户有更多的玩法，于去年成立了 AI 实验室，并已形成商业化成果。因此，作为活动策划者，我们特意邀请了多位在<strong>图像识别、对话交互、精准广告和深度学习系统部署</strong>等领域的大咖讲师，将最丰富最前沿的进展与实践带给听众，以下是本次活动的精彩内容总结。</p><p style="white-space: normal; box-sizing: border-box;"><br></p><section class="" data-tools="135编辑器" data-id="85551" style=" border-width: 0px; border-style: none; border-color: initial;  "><section style="text-align:center;"><section style="border-width: 0px; border-style: initial; border-color: initial; margin-top: 5px; margin-bottom: -12px; box-sizing: border-box; display: inline-block;"><section style="height: 1.2em; box-sizing: border-box;"><strong style="color: rgb(6, 163, 224); font-size: 20px;"><strong style="font-size: medium; white-space: normal;"><span style="font-size: 18px;">Chatbots对话式交互系统的分析与应用</span></strong></strong><section style="display: inline-block; color: rgb(242, 159, 150); clear: both; box-sizing: border-box;"></section></section></section></section><section style="text-align: center;"><section style="display:inline-block;"><span style="color:#7F7F7F; font-size:14px"><span style="white-space: pre-wrap;">讲师：吴金龙（爱因互动技术合伙人）</span></span></section></section></section></section></section></section><section powered-by="xiumi.us"><section><section><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="1"><section><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="1" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; " data-color="#06A3E0"><section class="" style="border-left: 5px solid rgb(6, 163, 224); font-weight: bold; line-height: 32px; color: rgb(102, 102, 102); padding: 5px 10px; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box;"><p><strong>Chatbots 简史</strong></p></section></section></section></section></section></section><p style="white-space: normal; box-sizing: border-box; text-align: justify;">最早追溯到 1950 年的图灵测试，当时基本是人类对于AI的最朴素理解：让机器人如人类一般交流。经过缓慢的发展，期间出现了 ELIZA 和 ALICE 这两个相对著名的智能机器人，Bots 终于在 2011、2012 年开始了爆发，出现了 API.IR，Bot.IR（现在被谷歌以及 Facebook 收购了）。真正被称为 Chatbots 元年的，是 2016 年，这一年 Facebook 和微软都发布了自己相关的 Chatbots平台，国内也出现了非常多优秀的人工智能创业公司。</p><p style="white-space: normal; box-sizing: border-box;"><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="1"><section><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="1" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; " data-color="#06A3E0"><section class="" style="border-left: 5px solid rgb(6, 163, 224); font-weight: bold; line-height: 32px; color: rgb(102, 102, 102); padding: 5px 10px; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box;"><p><strong>三类Bots框架详解</strong></p></section></section></section></section></section></section><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p style="white-space: normal; box-sizing: border-box;"><strong>IR-Bot:智能检索机器人</strong></p></li></ul><p style="white-space: normal; box-sizing: border-box; text-align: justify;">这里深度学习主要用在两个地方：一个是匹配排序的情况，用在排序更多是 QA 匹配，基于 CNN、RNN 可以把一个问题一个答案变成向量化的表示。通过抽取得到的向量，再用 DN 的东西把它变成相似度的分数计算，最后分数高认为这两个东西比较匹配，这是在排序中用的方法。</p><p style="white-space: normal; box-sizing: border-box;"><br></p><p style="white-space: normal; box-sizing: border-box; text-align: justify;">另一个是检索的情况，也是类似的做法。比如说单针对这里面做的事去检索问题跟问题的相关性，先模拟它们的相似性，再去判断这两个向量之间的距离，以及他们之间的点击。</p><p style="white-space: normal; box-sizing: border-box;"><br></p><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p style="white-space: normal; box-sizing: border-box;"><strong>Task-Bot:任务对话机器人&nbsp;</strong></p></li></ul><p style="white-space: normal; box-sizing: border-box; text-align: justify;">这里是指做多人对话或者是任务型多人对话时的应用场景。常用的技术手段包含语言理解、状态追踪、策略优化和语言生成。在语言理解中，需要用一些语法解析的方法把这个东西变成结构化的信息，最终把自然语言变成结构化信息。状态追踪是比较关键的模块，将用户跟系统历史上交互的信息都记录下来，这样接下来的对话才能比较连贯性进行。状态追踪的结果给策略优化，策略优化根据现在已有的状态，去给出个系统应该怎么样答复用户，这里面常用的方法是增强学习。最后要用 NLG 把结构化信息翻译成用户比较理解、对用户比较友好的自然语言的方式，现在常用的是基于模版。</p><p style="white-space: normal; box-sizing: border-box;"><br></p><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p style="white-space: normal; box-sizing: border-box;"><strong>Chitchat-Bot:开域闲聊机器人&nbsp;&nbsp;</strong></p></li></ul><p style="white-space: normal; box-sizing: border-box; text-align: justify;">著名的微软小冰属于这一类，是非常新的领域。常用的框架是端到端的模型，把用户的问题作为输入，最后产生系统给出的回答，这是端到端理论上非常漂亮的结论。这其中的重点问题是怎么样让系统的回答更加有信息量，需要把三个问题建模到目标函数里面去：</p><p style="white-space: normal; box-sizing: border-box; text-align: justify;">1）降低“我不知道”回答的概率，尽量产生用户不知晓的回答；</p><p style="white-space: normal; box-sizing: border-box; text-align: justify;">2）增加内容上的信息量；</p><p style="white-space: normal; box-sizing: border-box; text-align: justify;">3）语义的连贯性</p><p style="white-space: normal; box-sizing: border-box; line-height: normal;"><br></p><p style="white-space: normal; box-sizing: border-box;"><strong style="box-sizing: border-box;"><span style="color: rgb(74, 152, 227); box-sizing: border-box;"></span></strong></p><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="1" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; " data-color="#06A3E0"><section class="" style="border-left: 5px solid rgb(6, 163, 224); font-weight: bold; line-height: 32px; color: rgb(102, 102, 102); padding: 5px 10px; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box;"><p><strong>Bots 成熟度对比</strong></p></section></section></section><p style="white-space: normal; box-sizing: border-box; text-align: justify;">在行业和技术成熟度方面，如果把信息检索 IR-Bot 成熟度看成 5 分的话，Task-Bot 可以打 1 分，Chat-Bot 算是 3 分。因为 IR-Bot 基于检索/排序的流程，历史悠久，技术成熟。在引入深度学习后，计入长效依赖，可以生成更好的语句表达。现在深度学习在做希望把问题原来简单词基础上做更进一步的优化。Task-bots 是适合做任务解决型的框架，它强调是多人对话。闲聊是比较新的领域，基本属于所谓 LT 终极理想，还有很长路要走，完善度还非常低。这一块的发展还很快，每年有非常多的论文在开域闲聊这块发展出来。&nbsp;</p><p style="white-space: normal; box-sizing: border-box; text-align: justify;">&nbsp;&nbsp;&nbsp;</p><section style="white-space: normal; text-align: center;"><section style="margin-top: 5px; margin-bottom: -12px; border-width: 0px; border-style: initial; border-color: initial; box-sizing: border-box; display: inline-block;"><section><span style="color: rgb(6, 163, 224);"><strong><span style="font-size: 18px;">构建基于富媒体大数据的弹性深度学习计算平台</span></strong></span><strong style="color: rgb(6, 163, 224); font-size: 20px;">&nbsp;&nbsp;</strong></section></section></section><section style="white-space: normal; text-align: center;"><section style="display: inline-block;"><span style="color: rgb(127, 127, 127); font-size: 14px;"><span style="white-space: pre-wrap;">讲师：彭垚（七牛云 AI 实验室负责人）&nbsp;</span></span></section></section><p><br></p></section></section></section><section class="" style="   box-sizing: border-box; " powered-by="xiumi.us"><section class="" style="   box-sizing: border-box; "><section><p style="text-align: justify; white-space: normal; box-sizing: border-box; line-height: normal;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">七牛云从去年开始关注智能服务方向，这是一个很大的转变。七牛云平台已经有了数十万的客户的海量图像、音视频等数据，在提供高质量服务的基础上，接下去应该做的，就是帮助客户去了解自己数据中的价值，去把握这些非结构化数据里、APP 产品里、客户行为里需要审核和分析的东西，Ataraxia AI Lab 因此而生。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box; line-height: normal;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><strong style="box-sizing: border-box;"><span style="color: rgb(74, 152, 227); box-sizing: border-box;"><strong style="white-space: normal; box-sizing: border-box;"></strong></span></strong></p><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="1" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; " data-color="#06A3E0"><section class="" style="border-left: 5px solid rgb(6, 163, 224); font-weight: bold; line-height: 32px; color: rgb(102, 102, 102); padding: 5px 10px; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box;"><p><strong>基本业务逻辑</strong></p></section></section></section><p style="text-align: justify; white-space: normal; box-sizing: border-box;">概括来说，Ataraxia 实验室着力在解决两大问题：大数据和深度学习算法。首先用户行为会产生很多上传的图像、视频。在调整照片等动作的时候，要告诉抽样整理模块，这些图像标注的信息是什么。抽样整理模块是一个分布式的富媒体的处理模式，它会去不停地进行处理抽样和调整的工作，抽样调整完了以后就可以生成想要学习的样本集。得到这个样本集后会继续跟到训练集群里面，训练集群完成之后生成线上模型，模型根据一套 AVA 的生成器自动上升到推理服务上，最后就会出来一套用户数据访问推理服务，得到推理相应的一些结果，这是比较简单的一个逻辑。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box; line-height: normal;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><strong style="box-sizing: border-box;"><span style="color: rgb(74, 152, 227); box-sizing: border-box;"></span></strong></p><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="1" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; " data-color="#06A3E0"><section class="" style="border-left: 5px solid rgb(6, 163, 224); font-weight: bold; line-height: 32px; color: rgb(102, 102, 102); padding: 5px 10px; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box;"><p><strong>AVA深度学习平台</strong></p></section></section></section><p style="text-align: justify; white-space: normal; box-sizing: border-box;">AVA 最底层通过 IO 接口引入七牛云平台上的非结构化数据，进行统一的读写管理。这上面有两套系统：一套系统专门处理数据抽样和数据整理工作，会把图像做再次加工，去增加数据样本；另外一套是基于 Docker 的编排系统。这里一个支撑的是大数据分布式系统，还有一边是支持了 Distributed，这里结束以后通过 API Manager 的自动的代码生成器，生成自动评估模块。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">再上层是机器学习训练模型方向几个 APP 应用系统。第一个就是自动迭代系统，主要完成的是深度学习的识别功能；另一个是自增长数据级的系统，同样一个数据其实每天都会增长的，我们会取一个像流式的深度学习一样的，它会在每一个 snapshot 的时候出现一个数据级，滚进一个新的数据再去学习。还有一个半监督打标的系统，这套系统跟打标软件连接。这里会先做一些预标注，去跟分类器的一些中心做比较，比较出来以后拿出一部分的数据再去学习。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">后面做了大量的模型融合，模型融合是比较费资源的，但是能达到更高的准确率，就是把模型融合这个东西单独做成一个 APP，框架自动化，有时候在特定的场景还需要模型的方法把一些准确率能达到商用。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box; line-height: normal;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><strong style="box-sizing: border-box;"><span style="color: rgb(74, 152, 227); box-sizing: border-box;"></span></strong></p><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="1" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; " data-color="#06A3E0"><section class="" style="border-left: 5px solid rgb(6, 163, 224); font-weight: bold; line-height: 32px; color: rgb(102, 102, 102); padding: 5px 10px; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box;"><p><strong>更开放的 Argus 系统</strong></p></section></section></section><p style="text-align: justify; white-space: normal; box-sizing: border-box;">AVA 是一个解决单一的学习问题闭环，单到 AI 应用层面，他不能满足整个人工智能的一个设计框架。因此又做了一套 Argus 系统，实际上就是 API 网状的管理系统，它模仿了人类的大脑皮层结构，支持多几个层次的管道调用和并行处理。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">最底层通过 Argus 一些原子的 API，有了原子的 API 之后上层会有一些感知层，感知层会做一些基于原子 API 的抽象，抽象做一些复杂任务，像聚类这样一些基于原子 API 提取的特征之上执行一些的复杂任务，再高层是整个跟视觉相关的一些 API，再往上可能跟业务逻辑大数据分析，把这个东西分析到抽象层，或者说跟语言相关的加了一些 RNN 把语意描述出来之后就扔给业务逻辑处理了。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">上层很多应用和业务层的 API 是开放的，包括像感知层、综合视觉层，业务分析层的这种整体的业务逻辑的 API，直接可以通过图像出来原子层 API 写一些东西参与到 Argus 的机器视觉里面。 也就是说高层的业务型的智能的，或者说大数据的业务开发能力是开放给各个用户自主开发的。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">目前已经有很多基础的原子 API，包括一些业务型的人脸检测、人脸聚类、鉴黄、暴恐等深度学习的平台，它一直在产生一些基础的 API，原子 API 给 Argus 系统，让客户可以自己在 Argus 上面自己编 Docker 镜像。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><section class="" data-tools="135编辑器" data-id="85551" style=" border-width: 0px; border-style: none; border-color: initial;  "><section style="text-align:center;"><section style="border-width: 0px; border-style: initial; border-color: initial; margin-top: 5px; margin-bottom: -12px; box-sizing: border-box; display: inline-block;"><section><strong><span style="font-size: 18px; color: rgb(6, 163, 224);">搜狗深度学习技术在广告推荐领域的应用</span></strong><section style="display: inline-block; color: rgb(242, 159, 150); clear: both; box-sizing: border-box;"></section></section></section></section><section style="text-align: center;"><section style="display:inline-block;"><span style="color:#7F7F7F; font-size:14px"><span style="white-space: pre-wrap;"><span style="text-align: center;">讲师：舒鹏（搜狗资深研究员</span>）&nbsp;</span></span></section>&nbsp;&nbsp;</section></section></section></section></section><section class="" style="   box-sizing: border-box; " powered-by="xiumi.us"><section class="" style="   box-sizing: border-box; "><section><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="1" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; " data-color="#06A3E0"><section class="" style="border-left: 5px solid rgb(6, 163, 224); font-weight: bold; line-height: 32px; color: rgb(102, 102, 102); padding: 5px 10px; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box;"><p><strong>搜索广告背景知识</strong></p></section></section></section><p style="text-align: justify; white-space: normal; box-sizing: border-box;">对于搜索广告来说有几个步骤，第一个是查询理解，用户当前的查询到底干什么？他有什么目的？需要对他分析并且分词，以及查询倾向的分析，最后做广告召回。这个量比较大，目前搜狗的库在几个亿级，会先做初步筛选，最后剩下几千几百个广告量级，最后做评估。假定这个广告能够在前面展示，实际的点击率怎么样，因为点击率能够反映出很多的事情，包括广告的质量，以及广告价值。有的时候流量也是需要花钱购买，这个流量怎么变现更有效，通常靠这个保证。排序计价，有广告量之后会有后续的行为，这个应用叫结果展示。有了这个会有后面的收集功能，包括搜寻时间，把这些东西都作为后期的收集模块放在后端系统里面去，结下来会拿这个日志做各种各样的处理，包括 CTR 模型一些线下实验以及各种各样的事情，就完成了整个闭环，这是保护系统的介绍。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box; line-height: normal;"><br></p><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="1" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; " data-color="#06A3E0"><section class="" style="border-left: 5px solid rgb(6, 163, 224); font-weight: bold; line-height: 32px; color: rgb(102, 102, 102); padding: 5px 10px; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box;"><p>深度学习在搜狗搜索广告的一些应用</p></section></section></section><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify; white-space: normal; box-sizing: border-box;">图像理解——用于图片物料推荐，相关技术是 CNN</p></li><li><p style="text-align: justify; white-space: normal; box-sizing: border-box;">文本相关性——用于广告召回、创意生成，相关技术是 Word2Vec、CSR、LSTM</p></li><li><p style="text-align: justify; white-space: normal; box-sizing: border-box;">CTR 预估——用于广告排序、特征挖掘，相关技术是 DNN、MxNet、TensorFlow</p></li></ul><p style="text-align: justify; white-space: normal; box-sizing: border-box; line-height: normal;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><span style="color: rgb(74, 152, 227); box-sizing: border-box;"><strong style="box-sizing: border-box;"></strong></span></p><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="1" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; " data-color="#06A3E0"><section class="" style="border-left: 5px solid rgb(6, 163, 224); font-weight: bold; line-height: 32px; color: rgb(102, 102, 102); padding: 5px 10px; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box;"><p><strong>基于多模型融合的 CTR 预估</strong><span style="color: rgb(6, 163, 224);"><strong style=" color: rgb(74, 152, 227); text-align: justify ; ; ; ; ; ; ; ; "></strong></span></p></section></section></section><p style="text-align: justify; white-space: normal; box-sizing: border-box;">首先介绍 CTR 的流程。先搜集一个原始数据，包括查询点一致，这两个东西每天会实时产生的，每天会有很大量级。有了这些之后做特征的抽取，比如说本次查询特征，用户查询词是什么？他所处哪个地域？今天是星期几？还有一些广告特征，具体广告本身标题是什么？描述是什么？客户购买的关键词，以及这个广告和查询词之间的相关性，会导致广告的特征。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">匹配特征，这两个之间到底与哪个东西交叉在一起，有了这个之后会有模型进行训练，这里分别是线性模型和非线性模型。线性模型刚才提到的 DNN 跟深度学习有关。如果能把模型训练好的话，到了线上的 Server 会把整个的特征抽取一遍，具体抽取多少，会加上模型进行计算，然后形成 CTR 预估完整的结果。最后 Online 本身产生一致，形成完整的流程。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">CTR 预估，与之有关的三个方面：数据、特征和模型。平台是基础的，因为没有平台什么都做不了，常用的平台有 MPI、XgBoost、Parameter Server、MxNet 和 TensorFlow。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">前面提到，首先有线性的模型，LR 模型线性回归。本身有一个做自动实时的东西，其次有自动组合，两两交叉的。非线性的模型是 GBDT，是决策数的变体，可以多个做决策数的组合。然后是深度学习模型 DNN，以及模型融合，融合模型具体的做法分很多种：Bagging、级联模型和 WideDeep。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">数据这块，首先要有一个日志收集模块，模块来了之后会收集到最原始的数据，最开始要去噪。去噪是指原始数据会有一个噪声点，比如一个用户一个查询词连续搜到两次，第一次广告没点，第二次点了。第一次没点到底是因为广告出的不好，还是因为本人状态，这就需要考虑。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">其次是特征，在搜索广告领域里面特征是比较重要的，它有一个专用的名词是特征工程，主要包括特征的设计、选择、组合，所谓设计，是指你认为哪些因素对用户选择广告有影响，就把它找到设计一些新特征出来，单单有这个东西不够，有的时候判断这种新特征是否有效，这涉及到特征选择，特征选择需要进行词系的分析，看看最后能不能用。最后是特征组合，看看交叉特征，有的时候单个因素出现时并不能出现问题，如果两个因素出现或者一块出现时，可能出现不同的结果。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">&nbsp;</p><section class="" data-tools="135编辑器" data-id="85551" style=" border-width: 0px; border-style: none; border-color: initial;  "><section style="text-align:center;"><section style="border-width: 0px; border-style: initial; border-color: initial; margin-top: 5px; margin-bottom: -12px; box-sizing: border-box; display: inline-block;"><section><span style="color: rgb(6, 163, 224);"><strong><span style="font-size: 18px;">人工智能 + 微服务的最佳实践分享</span></strong></span><section style="display: inline-block; color: rgb(242, 159, 150); clear: both; box-sizing: border-box;"></section></section></section></section><section style="text-align: center;"><section style="display:inline-block;"><span style="color:#7F7F7F; font-size:14px"><span style="white-space: pre-wrap;">讲师：陈辉（深知科技 CEO）&nbsp;</span></span></section></section></section><section><section powered-by="xiumi.us"><section><section><section><p><br></p></section></section></section></section></section></section></section></section><section class="" style="   box-sizing: border-box; " powered-by="xiumi.us"><section class="" style="   box-sizing: border-box; "><section class="" style="line-height: 1.8; padding-right: 4px; padding-left: 4px; box-sizing: border-box;"><p style="text-align: justify;">如果是用 CPU 来做 Kuberntes 的话，深度学习模型的存储量主要是在 CPU上，所以使用带有弹性扩容的微服务架构是比较适合的。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box; line-height: normal;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><strong style="box-sizing: border-box;"><span style="color: rgb(74, 152, 227); box-sizing: border-box;"></span></strong></p><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="1" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; " data-color="#06A3E0"><section class="" style="border-left: 5px solid rgb(6, 163, 224); font-weight: bold; line-height: 32px; color: rgb(102, 102, 102); padding: 5px 10px; margin-top: 10px; margin-bottom: 10px; box-sizing: border-box;"><p>从训练模型到模型部署的坑</p></section></section></section><p style="text-align: justify; white-space: normal; box-sizing: border-box;">现在各种各样深度学习的讲座，大家对怎么部署模型基本上都是很简单就概括了，只会说内部有一个很牛逼的平台，但是在实际做的时候，就会发现从 Python 训练出来的模型到最终部署的 C++ 或者 GO 的代码中间，要有很多工作要做。那些工作其实是非常讨厌的。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify; white-space: normal; box-sizing: border-box;">&nbsp;Inference 模型需要重新提取</p></li></ul><p style="text-align: justify; white-space: normal; box-sizing: border-box;">问题描述：训练模型无法直接使用，inference 要有单独模型</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><strong>解决方案：</strong></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">1. 尽可能将数据预处理逻辑用 Tensorflow 原生的 operation 来实现，简化外部代码逻辑；</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">2. 需要单独写一段 inference 代码，载入 training 模型，去除&nbsp;&nbsp;training 中特有的逻辑（比如 batch ）,然后将 inference 模型写入到新的 checkpoint 中。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify; white-space: normal; box-sizing: border-box;">模型外计算效率很差</p></li></ul><p style="text-align: justify; white-space: normal; box-sizing: border-box;">问题描述：模型之外有其他计算代码（如 beam search），Python 实现效率很差</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><strong>解决方案：</strong></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">Python 其实并不适合写 inference 服务，虽然算法工程师倾向于这样做。这里推荐用&nbsp; IncepticonV3+LSTM+beam search，用 Go 实现了模型整合。最开始 Go 语言实现了 500 毫秒左右，中间做了一些很好的工具，一步一步降低到了 350 毫秒。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify; white-space: normal; box-sizing: border-box;">模型需要静态化</p></li></ul><p style="text-align: justify; white-space: normal; box-sizing: border-box;">问题描述：模型最好静态化为常量参数，而且要转化成为单一模型文件，方便加载</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><strong>解决方案：</strong></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">这里能提供一个工具，将解决方案一生成的 interence checkpoint model 静态转化为一个单一模型文件，方便加载。简单来说，就是导入一个在训练阶段得到的一个模型，然后对这个模型做一些操作，把其中的一些参数转为常量，最终写入到指定的一个文件里面去。这个好处就是用过 Tensorflow 的同学都知道它里面有很多的图片的，包括图的定义，包括原参数的定义等等。这个工具可以载入文件夹，最终生成的是单一的文件，在文件夹里面只需要调入这个单一文件就可以了。</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><br></p><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p style="text-align: justify; white-space: normal; box-sizing: border-box;">容器内部部署 Tensorflow 的环境</p></li></ul><p style="text-align: justify; white-space: normal; box-sizing: border-box;">问题描述：如何将 Tensorflow 的运行环境无痛地打包到容器里</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;"><strong>解决方案：</strong></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">1. 首先需要编译 libtensorflow.so 动态链接库，这里面有一个小坑，就是不要用1.0 的版本，因为 1.0 的版本很奇怪的，他不支持超过 32 兆的模型载入，如果模型超过 32 兆的话，它限定死了，这个文件不能超过 32 兆，所以用git HEAD 版本是可以的；</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">2. 然后直接用ADD命令将&nbsp;libtensorflow.so 复制到容器的/user/lib 下即可；</p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">这里已经打了一份Docker镜像，如果大家服务器上已经装了Docker，只要一行命令就可以启动这样一个服务：</p><section data-role="outer" label="Powered by 135editor.com" style="font-family:微软雅黑;font-size:16px;"><section class="" data-tools="135编辑器" data-id="86005" style=" border-width: 0px; border-style: none; border-color: initial;  box-sizing: border-box; "><section class="" style="overflow: auto; font-size: 15px; margin-bottom: 16px; line-height: 1.45; padding: 16px; border-radius: 3px; word-wrap: normal; color: rgb(51, 51, 51); box-sizing: border-box; background-color: rgb(247, 247, 247);"><p style="white-space: normal;"><span style="   ; ; ; ;   ">docker run -d -p 8080:80 unmerged/gotalk</span></p></section></section></section><p style="text-align: justify; white-space: normal; box-sizing: border-box; line-height: normal;"><br></p><p style="text-align: justify; white-space: normal; box-sizing: border-box;">以上是对本次 七牛云&amp;QCon 2017 深度学习专题分享的内容概括，每位讲师的 PPT 和详细讲稿文章后续会陆续推出，敬请关注～</p></section></section></section></section><p style="line-height: normal;"><br></p><section style="background-color: rgb(255, 255, 255); box-sizing: border-box;"><section class="" style="   box-sizing: border-box; " powered-by="xiumi.us"><section class="" style=" margin-top: 0.5em; margin-bottom: 0.5em;  box-sizing: border-box; "><section style="border-top-style: dashed; border-top-width: 1px; border-top-color: rgb(74, 152, 227); box-sizing: border-box;" class=""></section></section></section></section><p style="line-height: normal;"><br></p><p style="text-align: justify;">4 月 28 日周四晚 8 点，七牛 Tech online 直播课堂，英语流利说联合创始人&amp;CTO 胡哲人将会给大家带来主题为<strong>《从 1 到 10，创业初期如何快速规模化团队》</strong>的精彩分享。感兴趣的小伙伴可以扫描二维码获取报名方式~</p><p style="font-size: 12px; line-height: normal; font-family: 'Helvetica Neue';"><span style="font-size: 16px;"><span style="line-height: normal;"><br></span></span></p><p style="font-size: 12px; line-height: normal; font-family: 'Helvetica Neue';"><span style="font-size: 16px;"><span style="line-height: normal;"></span></span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ6zXoTxPVO0KpwKIvNBBgia0RaXpgpGrSxSHPtY7F2NLbWjpj4fOh2rLiaY1xEavm9xSiapmB57j5wHQ/0?wx_fmt=jpeg" style="width: 750px !important; height: 1192px !important;"></p>
{% endraw  %}

