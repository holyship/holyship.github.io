---
title: 一条命令搞定容器日志收集，轻松解决运维烦恼
author: 孙健波
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1512888278&src=3&ver=1&signature=0dsH*cvrb7sDcdE*f0PtKDDznxaO*-9UQi5mS4OJXXtF2eLQ98xfrZY*Ab6736flYmrmf3oKG1dJ4X4AA2s6FBvYWbYbVyDWccyaizW1oPLB15C0pzbDwfP69Ithyzl7EOuXTjqzuTCFek0WFVL8Ck8bDvqQX8OfbjIceks1u8o=
date: '2017-11-29 00:00:00 +0000'

---

{% raw  %}
<section style="background-color: rgb(255, 255, 255);box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="padding: 10px;background-color: rgb(229, 247, 252);box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">本文将以 Kubernetes 容器云平台运维和 Kubernetes 容器云用户 两个视角，为您介绍如何使用 logkit 进行日志收集。</p></section></section></section></section><section class="" style="width: 100%;text-align: right;margin-top: -4px;box-sizing: border-box;"><section style="width: 50px;height: 4px;background-color: rgb(6, 163, 224);box-sizing: border-box;"></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br></p><p class=""><strong>欢迎在文末<span style="color: rgb(6, 163, 224);">扫码</span>或点击<span style="color: rgb(6, 163, 224);">「阅读原文」</span>联系我们</strong></p><p style="white-space: normal;box-sizing: border-box;"><br></p><p style="white-space: normal;box-sizing: border-box;">看过 《<a href="https://mp.weixin.qq.com/s?__biz=MjM5NzAwNDI4Mg==&amp;mid=2652193426&amp;idx=1&amp;sn=937e4c1a6a079aac209acaa83fe9b076&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;box-sizing: border-box;color: rgb(6, 163, 224);"><span style="box-sizing: border-box;">10 分钟快速构建能够承载海量数据的 nginx 日志分析与报警平台</span></a>》 的朋友应该已经明白如何通过 Pandora 快速搭建实时监控与报警平台的整个过程。其实除了 nginx 这类常见基础组件之外，对于一些自研程序的日志收集处理需求，也可用与之类似的操作方法。&nbsp;<br><strong style="box-sizing: border-box;"></strong></p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">而随着现在市场上容器化的趋势愈演愈烈，我们也为程序运行在容器云（如 Kubernetes）上的用户推出了基于 logkit 的优雅方案：获取配置文件后，您只需要一条命令，即可轻松搞定容器日志收集。</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="border-bottom: 1px solid black;margin-top: 0.5em;margin-bottom: 0.5em;line-height: 1.2;box-sizing: border-box;"><section class="" style="display: inline-block;border-bottom: 6px solid rgb(6, 163, 224);margin-bottom: -1px;border-top-color: rgb(6, 163, 224);border-right-color: rgb(6, 163, 224);border-left-color: rgb(6, 163, 224);font-size: 20px;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="box-sizing: border-box;">Kubernetes 容器云平台运维视角<br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">作为 Kubernetes 容器云平台的运维，想要收集日志非常简单，因为 Kubernetes 已经将日志统一存放在&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">/var/log/containers/</span>&nbsp;文件夹下，如下图所示：</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJQibHQInFdJlllMHyq1Z2VXqyicltX92Urbjrm5Fhsy0mxbPxGaqibM44A/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 121px !important; visibility: visible !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">对于每一个日志，都是一个软连接，连接到实际的日志文件。对于此类日志，使用 logkit 的文件读取模式 (tailx) 即可直接读取，接入方式如下。</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="border-bottom: 1px solid black;margin-top: 0.5em;margin-bottom: 0.5em;line-height: 1.2;box-sizing: border-box;"><section class="" style="display: inline-block;border-bottom: 6px solid rgb(6, 163, 224);margin-bottom: -1px;border-top-color: rgb(6, 163, 224);border-right-color: rgb(6, 163, 224);border-left-color: rgb(6, 163, 224);font-size: 20px;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="box-sizing: border-box;">数据接入</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">-根据您机器的操作系统版本下载 logkit</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;"><span style="color: rgb(6, 163, 224);box-sizing: border-box;">https://github.com/qiniu/logkit/wiki/Download</span></p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">解压后您可以看到</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="font-size: 14px;box-sizing: border-box;"><p style="box-sizing: border-box;">logkit</p><p style="box-sizing: border-box;">logkit.conf</p><p style="box-sizing: border-box;">public/</p><p style="box-sizing: border-box;">confs/</p></section></section></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">其中&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">logkit.conf</span>&nbsp;为主配置文件，用于配置 logkit 的 web 页面及端口配置，其中</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><ul class="list-paddingleft-2" style=""><li><p style="box-sizing: border-box;"><span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">bind_host</span>&nbsp;是设置绑定的端口，启动后可以根据这个页面配置 logkit。</p></li><li><p style="box-sizing: border-box;"><span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">static_root_path</span>&nbsp;是 logkit 页面的静态资源路径，就是填写 public 文件夹所在路径，强烈建议写成<strong style="box-sizing: border-box;">绝对路径</strong>。</p></li></ul><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">-运行 logkit</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="font-size: 14px;box-sizing: border-box;"><p style="box-sizing: border-box;">nohup ./logkit -f logkit.conf &gt; logkit.log 2&gt;&amp;1</p></section></section></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">-访问 logkit 配置页面</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">假设我们<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">bind_host</span>填写的页面内容为："localhost:3000"，那么我们可以在浏览器打开这个页面 <span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">http://localhost:3000</span></p><p style="white-space: normal;box-sizing: border-box;"><span style="background-color: rgb(232, 232, 232);box-sizing: border-box;"><br style="box-sizing: border-box;"></span></p><p style="white-space: normal;box-sizing: border-box;">点击【增加 Runner】，第一步 【配置数据源】</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJwuW2OJPmACZfMOUW5lAjGwgAWgnTB7h4GjPRGZpGea9txFNkmZdmLA/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 376px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">注意选择数据源类型为 "tailx" 模式，填写日志路径为</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: rgb(255, 255, 255);padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="font-size: 14px;box-sizing: border-box;"><p style="box-sizing: border-box;">/var/log/containers/*.log</p></section></section></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">然后配置解析方式，选择 【raw】方式解析</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJbpu0lxTNS9nLJNiaQpGRDmmCovGaMb46jzN12pZN3VDvWmGElianjicHA/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 352px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">然后依次点击，直到配置发送方式时填写您的七牛账户"ak"，"sk"。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">此时 logkit 部分您就配置完毕了，下面让我们来看看，作为 Kubernetes 平台的用户，我们该如何使用 logkit 。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="border-bottom: 1px solid black;margin-top: 0.5em;margin-bottom: 0.5em;line-height: 1.2;box-sizing: border-box;"><section class="" style="display: inline-block;border-bottom: 6px solid rgb(6, 163, 224);margin-bottom: -1px;border-top-color: rgb(6, 163, 224);border-right-color: rgb(6, 163, 224);border-left-color: rgb(6, 163, 224);font-size: 20px;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;">Kubernetes 容器云平台用户视角</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">当你作为 Kubernetes 用户时，你无法将 logkit 安装在服务器上收集日志，但是你可以利用 Kubernetes 的&nbsp;Daemonset&nbsp;功能, 将 logkit 以 daemonset 的形式运行在 当你作为 Kubernetes 用户时，你无法将 logkit 安装在服务器上收集日志，但是你可以利用 Kubernetes 的&nbsp;Daemonset&nbsp;功能, 将 logkit 以 daemonset 的形式运行在 Kubernetes 的每一个机器上，此时 logkit 容器与您的实际容器通过共享 volume 的方式收集日志数据。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">Docker 的日志统一放置在宿主机的&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">/var/lib/docker/containers</span>&nbsp;目录上，作为 daemonset 的 logkit 会自动探测该目录中新生成的日志并将之收集。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="padding: 2px;display: inline-block;background-color: rgb(254, 255, 255);box-sizing: border-box;"><section class="" style="padding-right: 8px;padding-left: 8px;margin-right: 5px;display: inline-block;background-color: rgb(6, 163, 224);color: rgb(255, 255, 255);box-sizing: border-box;"><section style="box-sizing: border-box;">1</section></section><section class="" style="padding-right: 5px;padding-left: 5px;display: inline-block;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;">下载配置文件</p></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">您可以通过如下命令获取部署到 Kubernetes 的配置文件。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="font-size: 14px;box-sizing: border-box;"><p style="box-sizing: border-box;">curl -L -O</p><p style="box-sizing: border-box;">https://raw.githubusercontent.com/qiniu/logkit/develop/deploy/logkit_on_k8s.yaml</p></section></section></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="text-align: left;white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">执行后生成的配置文件为&nbsp;</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="font-size: 14px;box-sizing: border-box;"><p style="box-sizing: border-box;">logkit_on_k8s.yaml</p></section></section></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="padding: 2px;display: inline-block;background-color: rgb(254, 255, 255);box-sizing: border-box;"><section class="" style="padding-right: 8px;padding-left: 8px;margin-right: 5px;display: inline-block;background-color: rgb(6, 163, 224);color: rgb(255, 255, 255);box-sizing: border-box;"><p style="box-sizing: border-box;">2</p></section><section class="" style="padding-right: 5px;padding-left: 5px;display: inline-block;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;">修改配置文件</p></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">默认情况下，我们的配置文件会使用&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">kube-system</span>&nbsp;这个 Kubernetes 的 namespace ，所有的部署仅针对该 namespace 生效。如果你想要使用别的 namespace ，只需要修改配置文件的 namespace 部分，将之改为你的 namespace 名称。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">另外，这份默认的配置文件，你只需要修改2个基本参数，就可以运行。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="font-size: 14px;box-sizing: border-box;"><p style="box-sizing: border-box;">- name: QINIU_ACCESS_KEY</p><p style="box-sizing: border-box;">value: change_me_to_your_qiniu_access_key</p><p style="box-sizing: border-box;">- name: QINIU_SECRET_KEY</p><p style="box-sizing: border-box;">value: change_me_to_your_qiniu_secret_key</p></section></section></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">将&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">change_me_to_your_qiniu_access_key</span>&nbsp;改为您七牛账号的 AK(accesskey)&nbsp;，</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">将&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">change_me_to_your_qiniu_secret_key</span>&nbsp;改为您七牛账号的 SK(secretkey)。</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="padding: 2px;display: inline-block;background-color: rgb(254, 255, 255);box-sizing: border-box;"><section class="" style="padding-right: 8px;padding-left: 8px;margin-right: 5px;display: inline-block;background-color: rgb(6, 163, 224);color: rgb(255, 255, 255);box-sizing: border-box;"><p style="box-sizing: border-box;">3</p></section><section class="" style="padding-right: 5px;padding-left: 5px;display: inline-block;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="box-sizing: border-box;">部署到 Kubernetes</p></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">部署到 Kubernetes 非常简单，只需要运行一行命令即可</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="font-size: 14px;box-sizing: border-box;"><p style="box-sizing: border-box;">kubectl create -f logkit_on_k8s.yaml</p></section></section></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">通过以下命令查看部署是否成功：</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="display: inline-block;width: 100%;border-width: 1px;border-style: solid;border-color: transparent;padding: 10px;background-color: rgb(239, 239, 239);box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="font-size: 14px;box-sizing: border-box;"><p style="box-sizing: border-box;"><span style="letter-spacing: 0px;box-sizing: border-box;">$ kubectl --namespace=kube-system get ds/logkit</span><br style="box-sizing: border-box;"></p></section></section></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">部署完成后日志就源源不断的通过 logkit 汇聚到七牛的 <span style="font-size: 15px;letter-spacing: 1px;text-align: justify;background-color: rgb(255, 255, 255);">Pandora</span> 日志检索平台，可以随时登录查看分析。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="border-bottom: 1px solid black;margin-top: 0.5em;margin-bottom: 0.5em;line-height: 1.2;box-sizing: border-box;"><section class="" style="display: inline-block;border-bottom: 6px solid rgb(6, 163, 224);margin-bottom: -1px;border-top-color: rgb(6, 163, 224);border-right-color: rgb(6, 163, 224);border-left-color: rgb(6, 163, 224);font-size: 20px;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;">登录 Pandora 界面</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">运行后，在&nbsp;<span style="color: rgb(6, 163, 224);box-sizing: border-box;">https://portal.qiniu.com/logdb </span>上就已创建了日志仓库：<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">k8s_log</span>&nbsp;, 点击右边的设置修改按钮，可以设置仓库的保存时长( logkit 自动创建的仓库数据默认保存 ( logkit 自动创建的仓库数据默认保存 30 天)，以及设置不同类型的分词。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJLh8aTkwmCcibDd7QibFbDEM1SedcSYXFK5Snemz9RwXf5drSJnfOym2w/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 187px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">点击【修改图标】进入后可以看到如下图所示。</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJutlZWWKvGrMxFAj51Qn3hhSicwia7DlQtjtXywoAjkyx7dfxOrJIp2dA/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 615px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">注意</strong></p><ul class="list-paddingleft-2" style=""><li><p style="box-sizing: border-box;">修改仓库数据保存期限修改后即时生效。</p></li><li><p style="box-sizing: border-box;">修改数据的分词，修改后配置在 T+1 时间后生效，对之前的数据不生效。</p></li><li><p style="box-sizing: border-box;">纯英文的日志建议设置为标准分词，以便快速检索数据；带有中文的数据建议设置为中文分词；如果字段都是关键字，类似"INFO"、"ERROR"，则建议设置为「不分词」。</p><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p></li></ul></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="border-bottom: 1px solid black;margin-top: 0.5em;margin-bottom: 0.5em;line-height: 1.2;box-sizing: border-box;"><section class="" style="display: inline-block;border-bottom: 6px solid rgb(6, 163, 224);margin-bottom: -1px;border-top-color: rgb(6, 163, 224);border-right-color: rgb(6, 163, 224);border-left-color: rgb(6, 163, 224);font-size: 20px;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;">检索日志</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">进入日志检索页面，除用户的原始日志以外，默认就能获得各类基础信息，包括机器的 hostname 信息，Kubernetes container 信息， Kubernetes 的 namespace 信息，Kubernetes 的 pod 信息，容器的 IP 地址，机器的操作系统。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJQwcic7bLBiaahC6bAj1UWjsw25iccMZ3ibZIpklgo1siaoicVdkmuibrdLmyw/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 308px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">当然，你也可以去掉额外的信息，完全只关注日志本身，如下图所示，我们以关键字&nbsp;Stopping&nbsp;为例，检索&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">raw</span>&nbsp;字段结果如下。 (此处"raw"字段的分词为「标准分词」)</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJN5PZnnibz0hIedsjicLCGVCibvCtN0q1ibtSyGH5sGibYLCntLhYmeicVozA/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 380px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="border-bottom: 1px solid black;margin-top: 0.5em;margin-bottom: 0.5em;line-height: 1.2;box-sizing: border-box;"><section class="" style="display: inline-block;border-bottom: 6px solid rgb(6, 163, 224);margin-bottom: -1px;border-top-color: rgb(6, 163, 224);border-right-color: rgb(6, 163, 224);border-left-color: rgb(6, 163, 224);font-size: 20px;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;">Grafana 监控和告警</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br></p><p style="white-space: normal;box-sizing: border-box;">具体配置可参考 Pandora 文档站中的&nbsp;Grafana 简介&nbsp;此处不再赘述，下面只给出示例配置。</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="padding: 2px;display: inline-block;background-color: rgb(254, 255, 255);box-sizing: border-box;"><section class="" style="padding-right: 8px;padding-left: 8px;margin-right: 5px;display: inline-block;background-color: rgb(6, 163, 224);color: rgb(255, 255, 255);box-sizing: border-box;"><section style="box-sizing: border-box;">1</section></section><section class="" style="padding-right: 5px;padding-left: 5px;display: inline-block;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;">创建 Grafana App</p></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;">如图所示</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJUoiaxRxaoupJKjagiatSVxtml5jxW2LMf1y6RX8dvPeicPoj4gsGwyL6g/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 413px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="padding: 2px;display: inline-block;background-color: rgb(254, 255, 255);box-sizing: border-box;"><section class="" style="padding-right: 8px;padding-left: 8px;margin-right: 5px;display: inline-block;background-color: rgb(6, 163, 224);color: rgb(255, 255, 255);box-sizing: border-box;"><p style="box-sizing: border-box;">2</p></section><section class="" style="padding-right: 5px;padding-left: 5px;display: inline-block;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;">﻿配置 Grafana LogDB 数据源</p></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">如图所示，点击 logdb 使用指南，可以按照使用指南的指导在 Grafana 配置数据源。</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJRVNrgpqic9vtzrvZImvRz0aTaCqvwwibreG4UtASslD10ib9E2EqevSdQ/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 434px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">注意事项</strong></p><ul class="list-paddingleft-2" style=""><li><p style="box-sizing: border-box;">Default Query Settings 中， Group by interval 填写时间&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">10s</span>，注意单位为 <span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">s</span> , <span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">m</span> 等，不等，不能漏掉，必须小写。</p></li><li><p style="box-sizing: border-box;">Time Field Name 处填写您的 logdb 时间字段， 填您 nginx 配置的命名，在上述的截图示例中，是&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">time_local</span>&nbsp;, 没有默认的&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">$</span>&nbsp;符号</p></li><li><p style="box-sizing: border-box;">Index name 中，模式固定为&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">Daily</span>&nbsp;, 串固定为&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">[reponame-]YYYY.MM.DD</span>&nbsp;, 将 reponame 字符串改为您的数据源名称即可。</p></li><li><p style="box-sizing: border-box;">Version 固定为&nbsp;<span style="background-color: rgb(232, 232, 232);box-sizing: border-box;">2.x</span></p></li></ul><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="padding: 2px;display: inline-block;background-color: rgb(254, 255, 255);box-sizing: border-box;"><section class="" style="padding-right: 8px;padding-left: 8px;margin-right: 5px;display: inline-block;background-color: rgb(6, 163, 224);color: rgb(255, 255, 255);box-sizing: border-box;"><p style="box-sizing: border-box;">3</p></section><section class="" style="padding-right: 5px;padding-left: 5px;display: inline-block;color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;">新建 Grafana 的 dashboard 并创建 graph</p></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">设置 metrics</strong></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJP3ib58Xu8ey6Jn55ImxF9wtracp1ic8xGU55eLibr3q7AMnwRX55scQLw/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 305px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">设置 alert 告警</strong></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;"><br style="box-sizing: border-box;"></strong></p><p style="white-space: normal;box-sizing: border-box;">设置 condition，可以选择 sum(), count() 等，IS ABOUT 为设置的阈值</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJ1Z0EMCGicibfPzpI6zNfpbjas2hcxmTMJicw86Sj1PmiaN0xWIdtERiaRag/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 347px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">设置告警 email 通知</strong></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;"><br style="box-sizing: border-box;"></strong></p><p style="white-space: normal;box-sizing: border-box;">首先，设置邮件通知组</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJlefmJictkV3ibgBEz8O5W3BbeWeic3MOZhN3uTsqAEo2qia9jA5stKp22A/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 519px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">点击 sent test，测试是否可以收到邮件</strong></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJsStTpU06WE6XBjPFZxadficQWWIDmjib7kvEUaH6DYcfabo4TeicYg0Xg/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 511px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">设置告警通知</strong></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJjVC0fcEaJu86ehKNeotXMRmur2mrWmiasCrVcvRjpC46fhgsZBvBibLA/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 240px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">当超过设置的阈值后就出现告警，并发邮件，包含之前写好的 message，以及此刻 graph 截图。如下图所示：</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJTBshGtKk8XqUhN3yOGUv0L4kCxk4TMCB5AWB1cc6SH8NUF5K5tibDVQ/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 640px !important; height: 493px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;">以上就轻松完成利用 Pandora 日志分析平台，轻松收集容器云日志，完成运维查看、告警相关功能啦！</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="text-align: center;white-space: normal;box-sizing: border-box;">欢迎<span style="color: rgb(6, 163, 224);box-sizing: border-box;">扫码</span>或点击<span style="color: rgb(6, 163, 224);box-sizing: border-box;">「阅读原文」</span>联系我们</p><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;width: 40%;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_jpg/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJibQrTl6Sau75iaUwkZfasQKu4ibTBrmwrZv8DOswG30RzH5icnJtvHIfSQ/0?wx_fmt=jpeg" style="vertical-align: middle; box-sizing: border-box; width: 308px !important; height: 308px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: justify;font-size: 15px;letter-spacing: 1px;padding-right: 4px;padding-left: 4px;box-sizing: border-box;"><p style="white-space: normal;box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="max-width: 100%;vertical-align: middle;display: inline-block;overflow: hidden !important;box-sizing: border-box;"><img src="http://mmbiz.qpic.cn/mmbiz_png/v6uP0lGcBZ4xZ3k0VzjSenCbNFfUKxpJsmpjpdzavGOMzehUy1ZbuzeF8cxzLDXssFG4o0plUtfPjCMLQuS7gQ/0?wx_fmt=gif" style="vertical-align: middle; box-sizing: border-box; width: 630px !important; height: 16px !important;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="display: inline-block;width: 100%;border-width: 8px;border-style: solid;border-color: rgb(221, 242, 252);padding: 10px;box-sizing: border-box;"><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: center;font-size: 15px;box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="margin-top: 10px;margin-bottom: 10px;text-align: center;box-sizing: border-box;"><section class="" style="display: inline-block;vertical-align: middle;box-sizing: border-box;"><section style="border-left: 2px solid rgb(6, 163, 224);border-top: 2px solid rgb(6, 163, 224);width: 12px;height: 12px;border-right-color: rgb(6, 163, 224);border-bottom-color: rgb(6, 163, 224);box-sizing: border-box;"></section><section style="padding-right: 10px;padding-left: 10px;margin-top: -8px;margin-bottom: -8px;box-sizing: border-box;"><section class="" style="color: rgb(6, 163, 224);box-sizing: border-box;"><p style="box-sizing: border-box;">七牛云 Contributor 征集中！</p></section></section><section style="border-right: 2px solid rgb(6, 163, 224);margin-left: auto;border-bottom: 2px solid rgb(6, 163, 224);width: 12px;height: 12px;border-top-color: rgb(6, 163, 224);border-left-color: rgb(6, 163, 224);box-sizing: border-box;"></section></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: center;font-size: 15px;box-sizing: border-box;"><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p><p style="box-sizing: border-box;">详情请点击</p></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="text-align: center;margin-top: 10px;margin-bottom: 10px;box-sizing: border-box;"><section class="" style="display: inline-block;vertical-align: middle;width: 0.8em;height: 0.8em;line-height: 1;padding: 2px;border-left: 2px solid rgb(6, 163, 224);border-bottom: 2px solid rgb(6, 163, 224);transform: rotate(-45deg);-webkit-transform: rotate(-45deg);-moz-transform: rotate(-45deg);-o-transform: rotate(-45deg);border-top-color: rgb(6, 163, 224);border-right-color: rgb(6, 163, 224);box-sizing: border-box;"></section></section></section><section class="" style="box-sizing: border-box;" powered-by="xiumi.us"><section class="" style="box-sizing: border-box;"><section class="" style="text-align: center;font-size: 15px;box-sizing: border-box;"><p style="box-sizing: border-box;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5NzAwNDI4Mg==&amp;mid=2652193858&amp;idx=1&amp;sn=991d29a96bf845c1c8b9529bb9eef007&amp;chksm=bd0172d78a76fbc1f9800712f0c811faebf3e9012e644f73866aed5284ef59b027c923a926ed&amp;scene=21#wechat_redirect" target="_blank"><span style="color: rgb(6, 163, 224);letter-spacing: 0px;box-sizing: border-box;text-decoration: underline;">成为七牛云 Contributor&nbsp;如何贡献 logkit 代码</span></a><br style="box-sizing: border-box;"></p><p style="box-sizing: border-box;"><br style="box-sizing: border-box;"></p></section></section></section></section></section></section></section><p><br></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1512888278&src=3&ver=1&signature=0dsH*cvrb7sDcdE*f0PtKDDznxaO*-9UQi5mS4OJXXtF2eLQ98xfrZY*Ab6736flYmrmf3oKG1dJ4X4AA2s6FBvYWbYbVyDWccyaizW1oPLB15C0pzbDwfP69Ithyzl7EOuXTjqzuTCFek0WFVL8Ck8bDvqQX8OfbjIceks1u8o=">微信地址</a> | <a href="http://qiniuyun.mikecrm.com/srmyU8L">阅读原文</a>
{% endraw  %}

