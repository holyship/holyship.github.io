---
title: 十分钟快速构建Influxdb+cadvisor+grafana监控
author: 陈爱珍
date: '2016-09-27 00:00:00 +0000'

---

{% raw  %}
<p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: inherit;">安装过程</strong></p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">三个都直接下载镜像启动容器</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">cadvisor：数据采集</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">Influxdb：数据存储</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">grafana：数据展示</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">&nbsp;</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: inherit;">启动influxdb容器</strong></p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">docker run -d -p 8083:8083 -p 8086:8086 --expose 8090 --expose 8099 --name influxsrv tutum/influxdb</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">通过主机IP+8083端口访问控制台</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">&nbsp;</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: inherit;">进入influxdb容器安装cadvisor数据库&nbsp;</strong></p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">＃docker exec -ti influxsrv /bin/bash</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">$ influx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">Visit&nbsp;https://enterprise.influxdata.com&nbsp;to register for updates, InfluxDB server management, and monitoring.</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">Connected to&nbsp;http://localhost:8086&nbsp;version 0.9.6.1</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">InfluxDB shell 0.9.6.1</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">&gt; CREATE DATABASE cadvisor</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">&gt; use cadvisor</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">&gt; CREATE USER "root" WITH PASSWORD 'root' WITH ALL PRIVILEGES</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">&gt; exit</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">&nbsp;</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">&nbsp;<strong style="box-sizing: inherit;">启动cadvisor容器</strong></p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">docker run --volume=/:/rootfs:ro --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro --publish=8080:8080 --detach=true<span style="box-sizing: inherit; color: rgb(255, 0, 0);">&nbsp;--link influxsrv:influxsrv</span>&nbsp;--name=cadvisor google/cadvisor:latest&nbsp;<span style="box-sizing: inherit; color: rgb(0, 0, 255);">-storage_driver=influxdb -storage_driver_db=cadvisor -storage_driver_host=influxsrv:8086</span></p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">通过主机IP+8080端口访问控制台</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">&nbsp;</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: inherit;">启动grafana容器</strong></p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">docker run -d -p 3000:3000 -e INFLUXDB_HOST=&nbsp;10.105.72.79&nbsp;&nbsp;-e INFLUXDB_PORT=8086 -e&nbsp;<span style="box-sizing: inherit; color: rgb(0, 0, 255);">INFLUXDB_NAME=cadvisor</span>&nbsp;-e INFLUXDB_USER=root -e INFLUXDB_PASS=root&nbsp;<span style="box-sizing: inherit; color: rgb(255, 0, 0);">--link influxsrv:influxsrv</span>&nbsp;--name grafana grafana/grafana</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">通过主机IP+3000端口访问控制台，用户名密码为admin/admin</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">&nbsp;</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">配置<strong style="box-sizing: inherit;">grafana</strong></p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">Adding the data source</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;"><img src="/noellachen/images/ef564a5f089bc3f7c6f8cbcbf887d9de7b980889.jpeg" style="box-sizing: inherit; border: none; margin: auto; max-width: 80%; width: 770px !important; height: 476.513px !important;"></p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">在这个面板里配置Influxdb的连接信息（端口为8060），CAdvisor数据库的认证信息(root/root)。</p><p><span style="box-sizing: inherit; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;"></span><span style="color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;  background-color: rgb(248, 248, 248);"></span></p><h2 style="box-sizing: inherit; font-size: 22px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">Adding&nbsp;Dashboards</h2><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;"><img src="/noellachen/images/c75e850e49bc4b39b098c3a9dd714ec9d3efe14f.png" style="box-sizing: inherit; border: none; margin: auto; max-width: 80%; width: 770px !important; height: 665.5px !important;"></p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;"><img src="/noellachen/images/e5b1a268bcf954bbd7eb08591e063854a2663bbb.png" style="box-sizing: inherit; border: none; margin: auto; max-width: 80%; width: 770px !important; height: 517.928px !important;"></p><p><span style="box-sizing: inherit; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;"></span><span style="color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;  background-color: rgb(248, 248, 248);"></span></p><h2 style="box-sizing: inherit; font-size: 22px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">Adding&nbsp;Query Editor</h2><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;"><img src="/noellachen/images/0d84abba6ce4b49b0ecb2ec87e144a7eec5315f1.png" style="box-sizing: inherit; border: none; margin: auto; max-width: 80%; width: 770px !important; height: 156.436px !important;"></p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">如果不显示数据且左上角报错：</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">error parsing query: time dimension must have one duration argument</p><p style="box-sizing: inherit; margin-bottom: 16px; color: rgb(61, 70, 77); font-family: 'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif; white-space: normal;">需要把查询条件里的group by time (internal)改成具体的时间。</p><p><br></p>
{% endraw  %}

