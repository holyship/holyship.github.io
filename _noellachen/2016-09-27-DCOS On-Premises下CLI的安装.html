---
title: DC/OS On-Premises下CLI的安装
author: 陈爱珍
date: '2016-09-27 00:00:00 +0000'

---

{% raw  %}
<h3 style="box-sizing: inherit; font-size: 18px;">环境</h3><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">OS</span><span class="" style="box-sizing: inherit;">:CentOS</span> 7<span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.2</span> 64<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">bit</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">Kernel</span><span class="" style="box-sizing: inherit;">:4.3.3</span><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">IP</span>: &nbsp; &nbsp;<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">DCOSBootstrap</span> &nbsp; &nbsp; &nbsp; &nbsp;172<span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.30</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.250</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.175</span> &nbsp; &nbsp;<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">DCOSmaster1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172<span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.30</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.250</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.210</span> &nbsp; &nbsp;<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">DCOSmaster2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172<span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.30</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.250</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.211</span> &nbsp; &nbsp;<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">DCOSmaster3</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172<span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.30</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.250</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.178</span><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">DCOSnode1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172<span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.30</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.250</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.18</span> &nbsp; &nbsp;<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">DCOSnode2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172<span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.30</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.250</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.181</span><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">DCOSnode3</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172<span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.30</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.250</span><span class="" style="box-sizing: inherit; color: rgb(239, 239, 143);">.182</span></code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">本地平台只支持centos和coreos，其他操作系统不支持，我用的是centos7.2，自己升的4.3.3的内核，默认3.10的内核也可以，需要支持overlay模块的内核。 七台机器分为三种类型：</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;">Bootstrap：用于DC/OS安装
master：运行DC/OS
node：运行服务</code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">安装有三种模式，GUI,CLI,高级模式，这里采用在虚拟机上使用CLI方式安装。</p><h1 style="box-sizing: inherit; font-size: 24px;">开始安装</h1><h2 style="box-sizing: inherit; font-size: 22px;">第一步，配置引导节点ssh到所有节点免密码</h2><p style="box-sizing: inherit; margin-bottom: 16px;">1.所有节点生成ssh密钥</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$ssh</span>-genkey</code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">2.引导节点上执行以下命令，实现可免密码ssh到远程节点</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$ssh</span>-copy-id -i ~<span class="" style="box-sizing: inherit;">/.ssh/id</span>_rsa.pub <span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$remote</span>-host<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$ssh</span> <span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$remote</span>-host</code></pre><h2 style="box-sizing: inherit; font-size: 22px;">第二步，引导节点安装docker</h2><p style="box-sizing: inherit; margin-bottom: 16px;">1.升级内核，关防火墙，安装依赖包，添加用户组</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$sudo</span> yum update 
<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$sudo</span> systemctl stop firewalld &amp;&amp; sudo systemctl <span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">disable</span> firewalld<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$sudo</span> yum install -y tar xz unzip curl ipset<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$sudo</span> sed -i s/SELINUX=enforcing/SELINUX=permissive/g /etc/selinux/config 
<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$sudo</span> groupadd nogroup</code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">2.生成三个文件，分别是开启overlay，配置SYSTEMD，添加Docker仓库</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;">$ sudo tee /etc/modules-<span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">load</span>.d/overlay.conf &lt;&lt;-<span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">'EOF'</span>overlay
EOF</code></pre><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;">$ sudo mkdir -p <span class="" style="box-sizing: inherit;">/etc/</span>systemd<span class="" style="box-sizing: inherit;">/system/</span>docker.service.d &amp;&amp; sudo tee <span class="" style="box-sizing: inherit;">/etc/</span>systemd<span class="" style="box-sizing: inherit;">/system/</span>docker.service.d/override.conf &lt;&lt;- EOF
[Service]
ExecStart=
ExecStart=<span class="" style="box-sizing: inherit;">/usr/</span>bin<span class="" style="box-sizing: inherit;">/docker daemon --storage-driver=overlay -H fd:/</span>/
EOF</code></pre><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$ </span>sudo tee /etc/yum.repos.d/docker.repo &lt;&lt;-<span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">'EOF'</span>[dockerrepo]
name=Docker Repository
baseurl=<span class="" style="box-sizing: inherit; color: rgb(220, 163, 163);">https:</span>/<span class="" style="box-sizing: inherit;">/yum.dockerproject.org/repo</span><span class="" style="box-sizing: inherit;">/main/centos</span><span class="" style="box-sizing: inherit;">/$releasever/</span>enabled=<span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">1</span>gpgcheck=<span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">1</span>gpgkey=<span class="" style="box-sizing: inherit; color: rgb(220, 163, 163);">https:</span>/<span class="" style="box-sizing: inherit;">/yum.dockerproject.org/gpg</span>EOF</code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">3.重启,查看overlay模块是否已载，显示overlay表示已加载</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$ </span>reboot<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$ </span>lsmod | grep overlay
overlay</code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">4.安装docker,启动docker,要确保所有节点上docker都是启动的</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;">$ sudo yum <span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">install</span> <span class="" style="box-sizing: inherit; color: rgb(127, 159, 127);">--assumeyes --tolerant docker-engine</span>$ sudo systemctl <span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">start</span> docker
$ sudo systemctl <span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">enable</span> docker</code></pre><h2 style="box-sizing: inherit; font-size: 22px;">第三步，配置引导节点</h2><p style="box-sizing: inherit; margin-bottom: 16px;">首先要确保docker是运行的</p><p style="box-sizing: inherit; margin-bottom: 16px;">1.登陆到引导节点~目录下，下载安装文件，创建安装目录，复制密钥到安装目录</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$ </span>curl -O <span class="" style="box-sizing: inherit; color: rgb(220, 163, 163);">https:</span>/<span class="" style="box-sizing: inherit;">/downloads.dcos.io/dcos</span><span class="" style="box-sizing: inherit;">/EarlyAccess/dcos</span>_generate_config.sh<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$ </span>mkdir -p genconf<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$ </span>cp ~<span class="" style="box-sizing: inherit;">/.ssh/id</span>_rsa genconf/ssh_key &amp;&amp; chmod <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">0600</span> genconf/ssh_key</code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">安装文件<code style="box-sizing: inherit; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; padding: 2px; font-size: 13px;">dcos_generate_config.sh</code>有500多Ｍ</p><p style="box-sizing: inherit; margin-bottom: 16px;">2.在genconf目录下创建两个文件</p><h2 style="box-sizing: inherit; font-size: 22px;">genconf/config.yaml</h2><p style="box-sizing: inherit; margin-bottom: 16px;">这个文件里写明要安装的所有节点的信息，登陆的用户名密码等：</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">bootstrap_url</span>: <span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">http</span>:<span class="" style="box-sizing: inherit; color: rgb(127, 159, 127);">//183.131.54.102:9001</span><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">cluster_name</span>: dcoscluster-name<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">exhibitor_storage_backend</span>: static<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">ip_detect_filename</span>: /genconf/ip-detect<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">master_list</span>:
- <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">172.30</span>.<span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">250.211</span>- <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">172.30</span>.<span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">250.210</span>- <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">172.30</span>.<span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">250.178</span><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">resolvers</span>:
- <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">192.168</span>.<span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">250.190</span>- <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">114.255</span>.<span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">243.230</span><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">agent_list</span>:
- <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">172.30</span>.<span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">250.181</span>- <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">172.30</span>.<span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">250.182</span>- <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">172.30</span>.<span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">250.18</span><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">ssh_port</span>: <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">22</span><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">ssh_user</span>: root<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">superuser_password</span>: &nbsp;<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">superuser_username</span>: chenaizhen<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">@qiniu</span>.com</code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">官网的安装指导里resolvers写的是google的DNSservers地址8.8.8.8和8.8.4.4,我这里写的是自己公司的地址。</p><h2 style="box-sizing: inherit; font-size: 22px;">genconf/ip-detect</h2><p style="box-sizing: inherit; margin-bottom: 16px;">官网的手册上提供了四种ip-detect的方式，下面这种要求主机只能有一个ip，这个文件表示通过节点指定的ip来发现，这个文件执行的结果就是本机的IP。</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><span class="" style="box-sizing: inherit; color: rgb(127, 159, 127);">#!/usr/bin/env bash</span><span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">set</span> -o nounset -o errexit<span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">export</span> PATH=/usr/sbin:/usr/bin:<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$PATH</span><span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">echo</span> $(ip addr show eth0 | grep -Eo <span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">'[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}'</span> | head -1)</code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">3.定制DC/OS 下面这个命令会根据前面写在genconf里两个文件定制创建DC/OS</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;">$ sudo bash dcos_generate_config.sh <span class="" style="box-sizing: inherit; color: rgb(127, 159, 127);">--genconf</span></code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">结束后的文件目录：&nbsp;<img src="/noellachen/images/f54be0a8c6c1e9b7169450ff3a0c37289bfc50c6.jpeg" style="box-sizing: inherit; border: none; margin: auto; max-width: 80%; width: 610px !important; height: 420px !important;"></p><p style="box-sizing: inherit; margin-bottom: 16px;">4.为DC/OS的所有节点安装Docker，配置SELinux等。可以通过以下命令自动的准备所有节点：</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;">$ sudo bash dcos_generate_config.sh --install-prereqs
Running mesosphere/dcos-genconf docker with BUILD_DIR set to /root/genconf
=<span class="" style="box-sizing: inherit;">===&gt; EXECUTING INSTALL PREREQUISITES</span>=<span class="" style="box-sizing: inherit;">===&gt; START install_prereqs</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE install_prereqs</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE install_prereqs</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE install_prereqs</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE install_prereqs</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE install_prereqs</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE install_prereqs</span>=<span class="" style="box-sizing: inherit;">===&gt; OUTPUT FOR install_prereqs</span>=<span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">===&gt; </span></span></span><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">END</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> install_prereqs with </span></span></span><span class="" style="box-sizing: inherit; color: rgb(220, 163, 163);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">returncode:</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> </span></span></span><span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">0</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"></span></span></span></span>=<span class="" style="box-sizing: inherit;">===&gt; SUMMARY FOR install_prereqs</span>6 out of 6 hosts successfully completed install_prereqs stage.
=<span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">===&gt; </span></span></span><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">END</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> OF SUMMARY FOR install_prereqs</span></span></span></span></code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">以上命令可加-v参数显示安装过程，可以看到有如下信息：</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><span class="" style="box-sizing: inherit; color: rgb(127, 159, 127);">#/bin/sh</span><span class="" style="box-sizing: inherit; color: rgb(127, 159, 127);"># setenforce is in this path</span>PATH=<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$PATH</span>:/sbin

dist=$(cat /etc/*-release | sed -n <span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">'s@^ID="\(.*\)"$@\1@p'</span>)<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">if</span> ([ x<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$dist</span> != <span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">'xrhel'</span> ] &amp;&amp; [ x<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$dist</span> != <span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">'xcentos'</span> ]); <span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">then</span>
 &nbsp;<span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">echo</span> <span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">"</span></span></span><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);"><span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);"><span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);"><span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$dist</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> is not supported. Only RHEL and CentOS are supported"</span></span></span></span> &gt;&amp;2 &nbsp;<span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">exit</span> 0<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">fi</span>version=$(cat /etc/*-release | sed -n <span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">'s@^VERSION_ID="\(.*\)"$@\1@p'</span>)<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">if</span> [ <span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$version</span> <span class="" style="box-sizing: inherit;">-lt</span> 7 ]; <span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">then</span>
 &nbsp;<span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">echo</span> <span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">"</span></span></span><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);"><span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);"><span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);"><span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);"><span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$version</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> is not supported. Only &gt;= 7 version is supported"</span></span></span></span> &gt;&amp;2 &nbsp;<span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">exit</span> 0<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">fi</span>sudo setenforce 0 &amp;&amp; sudo sed -i <span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">'s/^SELINUX=.*/SELINUX=disabled/g'</span> /etc/sysconfig/selinux

sudo tee /etc/yum.repos.d/docker.repo &lt;&lt;-<span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">'EOF'</span>[dockerrepo]
name=Docker Repository
baseurl=https://yum.dockerproject.org/repo/main/centos/<span class="" style="box-sizing: inherit; color: rgb(239, 220, 188);">$releasever</span>/
enabled=1
gpgcheck=1
gpgkey=https://yum.dockerproject.org/gpg
EOF

sudo yum -y update

sudo mkdir -p /etc/systemd/system/docker.service.d
sudo tee /etc/systemd/system/docker.service.d/override.conf &lt;&lt;- EOF
[Service]
ExecStart=
ExecStart=/usr/bin/docker daemon --storage-driver=overlay -H fd://
EOF

sudo yum install -y docker-engine
sudo systemctl start docker
sudo systemctl <span class="" style="box-sizing: inherit; color: rgb(204, 147, 147);">enable</span> docker

sudo yum install -y wget
sudo yum install -y git
sudo yum install -y unzip
sudo yum install -y curl
sudo yum install -y xz
sudo yum install -y ipset

sudo getent group nogroup || sudo groupadd nogroup</code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">5.安装前验证所有节点是可以安装的</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;">$ sudo bash dcos_generate_config.sh --preflight
=<span class="" style="box-sizing: inherit;">===&gt; EXECUTING PREFLIGHT</span>=<span class="" style="box-sizing: inherit;">===&gt; START run_preflight</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE preflight_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; OUTPUT FOR run_preflight</span>=<span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">===&gt; </span></span></span><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">END</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> run_preflight with </span></span></span><span class="" style="box-sizing: inherit; color: rgb(220, 163, 163);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">returncode:</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> </span></span></span><span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">0</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"></span></span></span></span>=<span class="" style="box-sizing: inherit;">===&gt; SUMMARY FOR run_preflight</span>6 out of 6 hosts successfully completed run_preflight stage.
=<span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">===&gt; </span></span></span><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">END</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> OF SUMMARY FOR run_preflight</span></span></span></span></code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">6.安装DC/OS到所有节点</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;">￥sudo bash dcos_generate_config.sh --deploy
Running mesosphere/dcos-genconf docker with BUILD_DIR set to /root/genconf
=<span class="" style="box-sizing: inherit;">===&gt; EXECUTING DC/OS INSTALLATION</span>=<span class="" style="box-sizing: inherit;">===&gt; START install_dcos</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy</span>=<span class="" style="box-sizing: inherit;">===&gt; STAGE deploy_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; OUTPUT FOR install_dcos</span>=<span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">===&gt; </span></span></span><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">END</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> install_dcos with </span></span></span><span class="" style="box-sizing: inherit; color: rgb(220, 163, 163);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">returncode:</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> </span></span></span><span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">0</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"></span></span></span></span>=<span class="" style="box-sizing: inherit;">===&gt; SUMMARY FOR install_dcos</span>6 out of 6 hosts successfully completed install_dcos stage.
=<span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">===&gt; </span></span></span><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">END</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> OF SUMMARY FOR install_dcos</span></span></span></span></code></pre><p style="box-sizing: inherit; margin-bottom: 16px;">7.确认服务是否启动正常</p><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;">Running mesosphere/dcos-genconf docker with BUILD_DIR set to /home/centos/genconf
=<span class="" style="box-sizing: inherit;">===&gt; dcos_installer.action_lib.prettyprint:: ====&gt; EXECUTING POSTFLIGHT</span>=<span class="" style="box-sizing: inherit;">===&gt; dcos_installer.action_lib.prettyprint:: ====&gt; START run_postflight</span>=<span class="" style="box-sizing: inherit;">===&gt; dcos_installer.action_lib.prettyprint:: ====&gt; STAGE postflight</span>=<span class="" style="box-sizing: inherit;">===&gt; dcos_installer.action_lib.prettyprint:: ====&gt; STAGE postflight</span>=<span class="" style="box-sizing: inherit;">===&gt; dcos_installer.action_lib.prettyprint:: ====&gt; STAGE postflight_cleanup</span>=<span class="" style="box-sizing: inherit;">===&gt; dcos_installer.action_lib.prettyprint:: ====&gt; STAGE postflight_cleanup</span>=<span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">===&gt; dcos_installer.action_lib.prettyprint:: ====&gt; </span></span></span><span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">END</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> run_postflight with </span></span></span><span class="" style="box-sizing: inherit; color: rgb(220, 163, 163);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">returncode:</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> </span></span></span><span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">0</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"></span></span></span></span>=<span class="" style="box-sizing: inherit;">===&gt; dcos_installer.action_lib.prettyprint:: ====&gt; SUMMARY</span>=<span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">===&gt; dcos_installer.action_lib.prettyprint:: </span></span></span><span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">6</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> out of </span></span></span><span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;">6</span></span></span></span></span></span></span><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"><span class="" style="box-sizing: inherit;"> hosts successfully completed run_postflight stage.</span></span></span></span></code></pre><h2 style="box-sizing: inherit; font-size: 22px;">最后，登陆</h2><h3 style="box-sizing: inherit; font-size: 18px;">zookeeper的监控管理页面</h3><p style="box-sizing: inherit; margin-bottom: 16px;">任意选一个master节点的ip都可以登，地址：http://183.131.54.89:8181/exhibitor/v1/ui/index.html&nbsp;<img src="/noellachen/images/3bc208a60cc4b7e065a63235237c212589da7bf3.jpeg" style="box-sizing: inherit; border: none; margin: auto; max-width: 80%; width: 770px !important; height: 430.164px !important;"></p><h3 style="box-sizing: inherit; font-size: 18px;">DC/OS的登陆页面</h3><p style="box-sizing: inherit; margin-bottom: 16px;">任意选一个master节点的ip,如http://183.131.54.89,用户名密码为config.yaml里配置的，登陆后的页面</p><p style="font-size: 12px; line-height: normal; font-family: Helvetica;"><span style="font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: 16px;"><img src="/noellachen/images/20e6e3338f1bb5f4c1d2c288b0fd883a66275392.jpeg" style="width: 770px !important; height: 465.609px !important;"><br></span></p><p style="font-size: 12px; line-height: normal; font-family: Helvetica;"><span style="font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: 16px;"><br></span></p><p style="font-size: 12px; line-height: normal; font-family: Helvetica;"><span style="font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; font-size: 16px;">Tip:183.131.54.89是节点172.30.250.177的外网ip</span></p><h2 style="box-sizing: inherit; font-size: 22px;">端口说明：</h2><pre class="" style="box-sizing: inherit; overflow-x: auto; padding: 2px; background-color: rgb(63, 63, 63); color: rgb(220, 220, 220); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; line-height: 1.4; word-wrap: normal; font-size: 13px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;"><code class="" style="box-sizing: inherit; display: block; overflow-x: auto; padding: 10px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; line-height: 1.4; word-wrap: normal; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;">port <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">80</span> &nbsp;mesos-ui
port <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">53</span> &nbsp;mesos-dns
port <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">15055</span> dcos-<span class="" style="box-sizing: inherit; color: rgb(227, 206, 171);">history</span>port <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">5050</span> mesos-master 
port <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">2181</span> zookeeper
port <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">8080</span> marathon
port <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">3888</span> zookeeper 
port <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">8181</span> exhibitor
port <span class="" style="box-sizing: inherit; color: rgb(140, 208, 211);">8123</span> mesos-dns</code></pre><p><br></p>
{% endraw  %}

