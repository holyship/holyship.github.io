---
title: mysql-proxy数据库中间件架构 | 架构师之路
author: 58沈剑
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1495452139&src=3&ver=1&signature=l12Tij*JEXuplVxFRWdZeW-T5kTNB0lmNIDfirdmdp3IhNxo89xisNdP56ZXTe4KJtg9Glou1t4ppqeRe4PZrWh8mhTneut4p5dqAw4Ve-Kfvlx9SRE3sznujnfkWR5oTm0-GR5mKvP-57tgQxW*5VVXLO9GcoCdf3pVvrCYbjM=
date: '2017-05-20 00:00:00 +0000'

---

{% raw  %}
<h1><span style="font-size: 14px;"><strong>一、mysql-proxy简介</strong></span></h1><p><span style="font-size: 14px;">mysql-proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">是</span>mysql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">官方提供的</span>mysql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">中间件<strong><span style="color: red; font-size: 14px;">服务</span></strong>，上游可接入若干个</span>mysql-client<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">，后端可连接若干个</span>mysql-server<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">。</span></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">它<strong><span style="color: red; font-size: 14px;">使用</span></strong></span><strong><span style="color: red; font-size: 14px;">mysql</span></strong><strong><span style="color: red; font-family: 微软雅黑,sans-serif; font-size: 14px;">协议</span></strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">，任何使用mysql-client的上游无需修改任何代码，即可迁移至</span>mysql-proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">上。</span></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></p><p><span style="font-size: 14px;">mysql-proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">最基本的用法，就是作为一个请求拦截，请求中转的中间层：</span></span></p><p><img src="/road5858/images/8cda3ab931a74ca09239766e6608987bf80b8cd4" style="width: 124px !important; height: 176px !important; visibility: visible !important;"></p><p><br></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">进一步的，</span>mysql-proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">可以分析与修改请求。<strong><span style="color: red; font-size: 14px;">拦截查询和修改结果，需要通过编写</span></strong></span><strong><span style="color: red; font-size: 14px;">Lua</span></strong><strong><span style="color: red; font-family: 微软雅黑,sans-serif; font-size: 14px;">脚本来完成</span></strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">。</span></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"></span>mysql-proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">允许用户指定</span>Lua<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">脚本对请求进行拦截，对请求进行分析与修改，它还允许用户指定</span>Lua<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">脚本对服务器的返回结果进行修改，加入一些结果集或者去除一些结果集均可。</span></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></p><p><span style="font-size: 14px;">所以说，根本上，mysql-proxy是一个官方提供的框架，具备良好的扩展性，可以用来完成：</span></p><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p><span style="font-size: 14px;">sql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">拦截与修改</span></span></p></li><li><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">性能分析与监控</span></p></li><li><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">读写分离</span></p></li><li><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">请求路由</span></p></li><li><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">...</span></p></li></ul><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">这个框架提供了</span>6<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">个</span>hook<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">点，能够让用户能够动态的介入到</span>client<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">与</span>server<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">中的通讯中去。</span></span></p><p><br></p><h1><span style="font-size: 14px;"><strong><span style="font-size: 16px;">二、mysql-proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">架构与原理</span></span></strong></span></h1><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">如“简介”中所述，</span>mysql-proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">向用户提供了</span>6<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">个</span>hook<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">点，让用户实现</span>Lua<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">脚本来完成各种功能，这些</span>hook<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">点是以函数的形式提供的，用户可以实现这些函数，在不同事件、不同操作发生时，做我们期望的事情。</span></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></p><p><span style="color: rgb(255, 0, 0); font-size: 14px;"><strong>connect_server()</strong></span></p><p><span style="font-size: 14px;">mysql-client<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">向</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">发起连接时，</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">会调用这个函数。用户可以实现该函数，来做一些负载均衡的事情，例如选择将要连向那个</span>mysql-server<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">。假设有多个</span>mysql-server<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">后端，而用户又没有实现这个函数，</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">默认采用轮询（</span>round-robin<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">）策略。</span></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></p><p><span style="color: rgb(255, 0, 0); font-size: 14px;"><strong>read_handshake()</strong></span></p><p><span style="font-size: 14px;">mysql-server<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">向</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">返回“初始握手信息”时，</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">会调用这个函数。用户可以实现这个函数，来做更多的权限验证工作。</span></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></p><p><span style="color: rgb(255, 0, 0); font-size: 14px;"><strong>read_auth()</strong></span></p><p><span style="font-size: 14px;">mysql-client<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">向</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">发送认证报文（</span>user_name, password,database<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">）时，</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">会调用这个函数。</span></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></p><p><span style="color: rgb(255, 0, 0); font-size: 14px;"><strong>read_auth_result()</strong></span></p><p><span style="font-size: 14px;">mysql-server<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">向</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">返回认证结果时，</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">会调用这个函数。</span></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></p><p><span style="color: rgb(255, 0, 0); font-size: 14px;"><strong>read_query()</strong></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">认证完成后，</span>mysql-client<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">每次经过</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">向</span>mysql-server<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">发送</span>query<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">报文时，</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">会调用这个函数。用户如果要拦截请求，就可以模拟</span>mysql-server<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">直接返回了，当然用户亦可以实现各种策略，修改请求，路由请求等各种不同的业务逻辑。</span></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></p><p><span style="color: rgb(255, 0, 0); font-size: 14px;"><strong>read_query_result()</strong></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">认证完成后，</span>mysql-server<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">每次经过</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">向</span>mysql-client<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">返回</span>query<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">结果时，</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">会调用这个函数。需要注意，如果用户没有显示实现</span>read_query()<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">函数，则</span>read_query_result()<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">函数是不会被调用的。用户可以在此处实现各种合并策略，或者对结果集进行修改。</span></span></p><p><br></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">下图是一个各</span>hook<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">函数的触发架构图，箭头方向表示触发时机：</span></span></p><p><img src="/road5858/images/937d6622b6997b4bb6ce2ee76d8b603b95751587" style="width: 651px !important; height: 168px !important;"></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">可以发现，</span><span style="color: rgb(255, 41, 65); font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">最重要的两个函数其实是</span>read_query()<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">和</span>read_query_result()</span><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">，各种</span>sql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">的改写与结果集的改写逻辑，都是在这两个函数中实现的，更细节的</span>query<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">过程如下图：</span></span></p><p><img src="/road5858/images/d690c6b618251842477ccd4862d47afd4253dc14" style="width: 551px !important; height: 190px !important;"></p><p><br></p><p><span style="font-size: 14px;"><span style="font-size: 14px;"><strong><span style="font-size: 16px;">三、mysql-proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">典型应用</span></span></strong></span></span><br></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">案例一：</span> sql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">时间统计分析</span></strong></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">假设</span>mysql-client<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">提交的原</span>sql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">为：</span></span></p><blockquote><p><span style="font-size: 14px;">XYZ;</span></p></blockquote><p><span style="font-size: 14px;">proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">可以在</span>read_query()<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">里将其改写为：</span></span></p><blockquote><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"></span><span style="color: red; font-size: 14px;">SELECT NOW();</span> </span></p><p><span style="font-size: 14px;">XYZ</span><span style="font-size: 14px;">;</span></p><p><span style="font-size: 14px;"><span style="color: red; font-size: 14px;">SELECT NOW();</span></span></p></blockquote><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">这样在返回结果集时，就可以在应用层对</span>sql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">时间进行记录，以方便统计分析。</span></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">案例二：</span>sql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">性能统计分析</span></strong></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">假设</span>mysql-client<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">提交的原</span>sql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">为：</span></span></p><blockquote><p><span style="font-size: 14px;">XYZ;</span></p></blockquote><p><span style="font-size: 14px;">proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">可以在</span>read_query()<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">里将其改写为：</span></span></p><blockquote><p><span style="font-size: 14px;">XYZ;</span></p><p><span style="font-size: 14px;"><span style="color: red; font-size: 14px;">EXPLAIN XYZ;</span></span><br></p></blockquote><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">这样在返回结果集时，就可以在应用层对</span>sql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">性能进行记录，以方便统计分析。</span></span></p><p><br></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">需要强调的是</span></strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">，这两个案例，由于</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">在</span>read_query()<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">时对</span>sql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">进行了改写，故在</span>read_query_result()<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">时，</span>mysql-server<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">其实返回了比原请求更多的信息，</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">一定要将多余的信息去掉，再返回</span>mysql-client<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">。多说一句，可以<span style="color: red; font-size: 14px;">加入一个唯一</span></span><span style="color: red; font-size: 14px;">ID</span><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">，来对请求</span>sql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">和返回结果进行配对。</span></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></span></p><div><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">案例三：读写分离</span></strong></span></div><div><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">mysql-proxy启动时，通过参数即可配置后端mysql-server是主server还是read-only，无需修改任何代码：</span></span><br></div><blockquote><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"></span></strong></span><span style="background: rgb(217, 217, 217); font-size: 14px;">shell&gt; mysql-proxy \</span></p><p><span style="background: rgb(217, 217, 217); font-size: 14px;">--proxy-backend-addresses=10.0.1.2:3306 \</span></p><p><span style="background: rgb(217, 217, 217); font-size: 14px;">--proxy-read-only-backend-addresses=10.0.1.3:3306</span></p></blockquote><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">注意，这里的两个mysql-server为<strong>主从架构</strong>。</span></span></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></strong></span></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">案例四：性能水平扩展</span></strong></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><span style="font-family:微软雅黑">mysql-proxy启动时，通过参数配置多个后端，即可实现性能的水平扩展，无需修改任何代码：</span></span><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><span style="font-family:微软雅黑"></span><br></span></strong></span></p><blockquote><p><span style="background: rgb(217, 217, 217); font-size: 14px;">shell&gt; mysql-proxy \</span></p><p><span style="background: rgb(217, 217, 217); font-size: 14px;">--proxy-backend-addresses=10.0.1.2:3306 \</span></p><p><span style="background: rgb(217, 217, 217); font-size: 14px;">--<span style="background-color: rgb(217, 217, 217);">proxy-backend-addresses</span>=10.0.1.3:3306</span></p></blockquote><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">注意，这里的两个mysql-server为<strong>主主架构</strong>，如果不做特殊修改，负载均衡策略为round-robin。</span></span></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"></span></strong></span><br></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><span style="font-size: 14px;"><span style="font-size: 14px;"><strong><span style="font-size: 16px;">四、mysql-proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">其他问题</span></span></strong></span></span></span></strong></span></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">提问：</span>Lua<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">脚本引入的额外开销有多大？</span></strong><br></span></p><p><strong><span style="font-size: 14px;">官网回答</span></strong><span style="font-size: 14px;">：Lua<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">很快，对于大部分应用来说，额外开销很小，原始包（</span>raw packet<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">）开销大概在</span>400<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">微秒左右。</span></span></p><p><strong><span style="font-size: 14px;">楼主</span></strong><span style="font-size: 14px;">：<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">这，，，我不太相信。</span></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></span></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">提问：mysql-</span></strong></span><span style="font-size: 14px;"><strong>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">和</span>mysql-server可以<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">部署在一台机器上么？</span></strong><br></span></p><p><strong><span style="font-size: 14px;">官网回答</span></strong><span style="font-size: 14px;">：proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">单独部署也可以，和</span>mysql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">部署在同一台机器上也可以。相比</span>mysql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">而言，</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">不怎么占</span>CPU<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">和内存，其性能损耗可以忽略不计。</span></span></p><p><strong><span style="font-size: 14px;"><span style="font-size: 14px;">楼主</span></span></strong><span style="font-size: 14px;"><span style="font-size: 14px;">：<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"></span></span><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">这，，，性能损耗可以忽略，这我也不太信。</span></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></span></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">提问：</span>proxy<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">可以处理</span>SSL<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">连接么？<strong>proxy</strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><strong>不会获取和保存我的明文密码吧？</strong></span></span></strong><br></span></p><p><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">官网回答</span></strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">：作为中间人，不能处理加密信息。</span><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">不会获取密码，也获取不到。</span>mysql<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">协议不允许密码以明文传输，传输的都是加密后的密文。</span></span></p><p><span style="font-size: 14px;"><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><br></span></span></p><p><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">提问：</span></strong></span><span style="font-size: 14px;"><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">在</span>Lua<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">脚本里可以使用</span>LuaSocket<span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">，连缓存，连其他服务么？</span></strong></span></p><p><strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">官网回答</span></strong><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">：理论上可以。但是，大哥，你确定要这样做么，强烈不建议这样。</span></p><p><br></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">==【完】==</span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;">相关推荐：</span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651960032&amp;idx=1&amp;sn=1f818d415842d544dc33ab78e8adffea&amp;chksm=bd2d073c8a5a8e2a38e7534d57ca0cad613893b9c3b578a220c4beef5d7495c5a1569cf4768e&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651960032&amp;idx=1&amp;sn=1f818d415842d544dc33ab78e8adffea&amp;chksm=bd2d073c8a5a8e2a38e7534d57ca0cad613893b9c3b578a220c4beef5d7495c5a1569cf4768e&amp;scene=21#wechat_redirect">用uid分库，uname上的查询怎么办？</a></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651959992&amp;idx=1&amp;sn=eb2fbd7d7922db42a593c304e50a65b7&amp;chksm=bd2d07648a5a8e72d489022ec6006274d7e43ab48449b255d5661658c2af8e9221977a9609ed&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651959992&amp;idx=1&amp;sn=eb2fbd7d7922db42a593c304e50a65b7&amp;chksm=bd2d07648a5a8e72d489022ec6006274d7e43ab48449b255d5661658c2af8e9221977a9609ed&amp;scene=21#wechat_redirect">100亿数据平滑数据迁移,不影响服务</a></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651959942&amp;idx=1&amp;sn=e9d3fe111b8a1d44335f798bbb6b9eea&amp;chksm=bd2d075a8a5a8e4cad985b847778aa83056e22931767bb835132c04571b66d5434020fd4147f&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651959942&amp;idx=1&amp;sn=e9d3fe111b8a1d44335f798bbb6b9eea&amp;chksm=bd2d075a8a5a8e4cad985b847778aa83056e22931767bb835132c04571b66d5434020fd4147f&amp;scene=21#wechat_redirect">业界难题-“跨库分页”的四种方案</a></span></p><p><span style="font-family: 微软雅黑,sans-serif; font-size: 14px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651959906&amp;idx=1&amp;sn=2cbdc66cfb5b53cf4327a1e0d18d9b4a&amp;chksm=bd2d07be8a5a8ea86dc3c04eced3f411ee5ec207f73d317245e1fefea1628feb037ad71531bc&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651959906&amp;idx=1&amp;sn=2cbdc66cfb5b53cf4327a1e0d18d9b4a&amp;chksm=bd2d07be8a5a8ea86dc3c04eced3f411ee5ec207f73d317245e1fefea1628feb037ad71531bc&amp;scene=21#wechat_redirect">58到家数据库30条军规解读</a></span></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1495452139&src=3&ver=1&signature=l12Tij*JEXuplVxFRWdZeW-T5kTNB0lmNIDfirdmdp3IhNxo89xisNdP56ZXTe4KJtg9Glou1t4ppqeRe4PZrWh8mhTneut4p5dqAw4Ve-Kfvlx9SRE3sznujnfkWR5oTm0-GR5mKvP-57tgQxW*5VVXLO9GcoCdf3pVvrCYbjM=">微信地址</a> | <a href="https://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&amp;mid=2651960032&amp;idx=1&amp;sn=1f818d415842d544dc33ab78e8adffea&amp;chksm=bd2d073c8a5a8e2a38e7534d57ca0cad613893b9c3b578a220c4beef5d7495c5a1569cf4768e#rd">阅读原文</a>
{% endraw  %}

