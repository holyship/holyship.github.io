---
title: 高并发的常见应对方案
author: 架构师之路
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1515986097&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siBo3oPDK8DK*88F4CWijxQ5EFX6jGrv3BrjQoFMwQzo-*jiN8gkDoGNv71FTxFvM1LqZEi0wj0QfD73rv5tlOCLHQGlYYIXBfUYQmnRROLrMNaeXSejQbqj1nCrPOLGqm*qPJCvOyhWP3YZfURRXoYo=
date: '2018-01-11 00:00:00 +0000'

---

{% raw  %}
<section class="" powered-by="xiumi.us"><section class=""><section class=""><section class=""><section class=""><span style="font-size: 16px;"><strong><span style="letter-spacing: 1px;">一、关于并发</span></strong></span></section><section class=""><strong><span style="letter-spacing: 1px;font-size: 14px;">我们说的高并发是什么？</span></strong><span style="letter-spacing: 1px;font-size: 14px;"><br></span></section></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><span style="font-size: 14px;letter-spacing: 1px;">在互联网时代，高并发，通常是指，在某个时间点，有很多个访问同时到来。</span></p><p><span style="font-size: 14px;letter-spacing: 1px;"><br></span></p></section></section></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><strong><span style="font-size: 14px;letter-spacing: 1px;">高并发，通常关心的系统指标与业务指标？</span></strong></p></section></section></section><ul class="list-paddingleft-2" style="list-style-type: disc;"><li><p><span style="letter-spacing: 1px;"><strong><span style="letter-spacing: 1px;font-size: 14px;">QPS</span></strong><span style="letter-spacing: 1px;font-size: 14px;">：每秒钟查询量，广义的，通常指指每秒请求数</span></span></p></li><li><p><span style="letter-spacing: 1px;"><strong><span style="letter-spacing: 1px;font-size: 14px;">响应时间</span></strong><span style="letter-spacing: 1px;font-size: 14px;">：从请求发出到收到响应花费的时间，例如：系统处理一个HTTP请求需要100ms，这个100ms就是系统的响应时间</span></span><span style="font-size: 14px;letter-spacing: 1px;"></span></p></li><li><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><strong><span style="font-size: 14px;letter-spacing: 1px;">带宽</span></strong><span style="font-size: 14px;letter-spacing: 1px;">：计算带宽大小需关注两个指标，<span style="color: rgb(255, 76, 0);">峰值流量</span>和<span style="color: rgb(255, 76, 0);">页面的平均大小</span>&nbsp;</span></p></section></section></section></section></section></section></li><li><p><span style="letter-spacing: 1px;"><strong><span style="letter-spacing: 1px;font-size: 14px;">PV</span></strong><span style="letter-spacing: 1px;font-size: 14px;">：<span style="letter-spacing: 1px;font-size: 14px;color: rgb(255, 76, 0);">综合浏览量</span>(Page View)，即页面浏览量或者点击量，通常关注在24小时内访问的页面数量，即“日PV”</span></span></p></li><li><p><strong><span style="font-size: 14px;letter-spacing: 1px;">UV</span></strong><span style="font-size: 14px;letter-spacing: 1px;">：<span style="font-size: 14px;letter-spacing: 1px;color: rgb(255, 76, 0);">独立访问</span>(UniQue Visitor)，即去重后的访问用户数，通常关注在24小时内访问的用户，即“日UV”</span></p></li></ul><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><br></p><p><span style="font-size: 16px;"><strong><span style="letter-spacing: 1px;">二、关于三种应对大并发的常见优化方案</span></strong></span><br></p></section></section></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><strong><span style="font-size: 14px;letter-spacing: 1px;">【数据库缓存】</span></strong><br></p></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class=""><p><strong><span style="font-size: 14px;letter-spacing: 1px;">为什么是要使用缓存？</span></strong><br></p></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><span style="font-size: 14px;letter-spacing: 1px;">缓存数据是为了让客户端很少甚至不访问数据库，减少磁盘IO，提高并发量，</span><span style="font-size: 14px;letter-spacing: 1px;">提高应用数据的响应速度。</span></p><p><span style="font-size: 14px;letter-spacing: 1px;"><br></span></p></section></section></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><strong><span style="font-size: 14px;letter-spacing: 1px;">【CDN加速】</span></strong></p></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class=""><p><strong><span style="font-size: 14px;letter-spacing: 1px;">什么是CDN？</span></strong></p></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><span style="font-size: 14px;letter-spacing: 1px;">CDN的全称是Content Delivery Network，</span><span style="font-size: 14px;letter-spacing: 1px;">CDN系统能够实时地根据网络流量和各节点的连接、负载状况以及<span style="font-size: 14px;letter-spacing: 1px;color: rgb(255, 76, 0);">到用户的距离</span>等综合信息将用户的请求重新<span style="font-size: 14px;letter-spacing: 1px;color: rgb(255, 76, 0);">导向离用户最近的服务节点</span>上。</span></p><p><span style="font-size: 14px;letter-spacing: 1px;"><br></span></p></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class=""><p><strong><span style="font-size: 14px;letter-spacing: 1px;">使用CDN的优势？</span></strong></p></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><span style="font-size: 14px;letter-spacing: 1px;">CDN的本质是内存缓存，就近访问，它提高了企业站点(尤其含有大量图片和静态页面站点)的访问速度，</span><span style="font-size: 14px;letter-spacing: 1px;">跨运营商的网络加速，保证不同网络的用户都得到良好的访问质量。</span></p><p><span style="font-size: 14px;letter-spacing: 1px;"><br></span></p><p><span style="font-size: 14px;letter-spacing: 1px;">同时，</span><span style="font-size: 14px;letter-spacing: 1px;">减少远程访问的带宽，分担网络流量，减轻原站点WEB服务器负载。</span></p><p><span style="font-size: 14px;letter-spacing: 1px;"><br></span></p></section></section></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><strong><span style="font-size: 14px;letter-spacing: 1px;">【服务器的集群化，以及负载均衡】</span></strong></p></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class=""><p><strong><span style="font-size: 14px;letter-spacing: 1px;">什么是七层负载均衡？</span></strong></p></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><span style="font-size: 14px;letter-spacing: 1px;">七层负载均衡，是基于http协议等应用信息的负载均衡，最常用的就是Nginx，它</span><span style="font-size: 14px;letter-spacing: 1px;">能够自动剔除工作不正常的后端服务器，</span><span style="font-size: 14px;letter-spacing: 1px;">上传文件使用异步模式，</span><span style="font-size: 14px;letter-spacing: 1px;">支持多种分配策略，可以分配权重，分配方式灵活。</span></p><p><span style="font-size: 14px;letter-spacing: 1px;"><br></span></p></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><span style="font-size: 14px;letter-spacing: 1px;">内置策略：IP Hash、<span style="font-size: 14px;letter-spacing: 1px;color: rgb(255, 76, 0);">加权轮询</span></span></p><p><span style="font-size: 14px;letter-spacing: 1px;">扩展策略：fair策略、通用hash、一致性hash</span></p><p><span style="font-size: 14px;letter-spacing: 1px;"><br></span></p></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class=""><p><strong><span style="font-size: 14px;letter-spacing: 1px;">什么是加权轮询策略？</span></strong></p></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><span style="font-size: 14px;letter-spacing: 1px;">首先将请求都分给高权重的机器，直到该机器的权值降到了比其他机器低，才开始将请求分给下一个高权重的机器，<span style="font-size: 14px;letter-spacing: 1px;color: rgb(255, 76, 0);">即体现了加权权重，又体现了轮询</span>。</span></p><p><span style="font-size: 14px;letter-spacing: 1px;"><br></span></p><p><span style="font-size: 16px;"><strong><span style="letter-spacing: 1px;">三、新年礼物</span></strong></span></p></section></section></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><span style="font-size: 14px;letter-spacing: 1px;">年末了，送给各位热爱编程的小伙伴一个福利，免费在线知识分享，不定期<strong>PHP</strong>、缓存redis、高并发解决方案、自研MVC框架、百万数据量索引优化等分享。</span></p></section></section></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><section class="" powered-by="xiumi.us"><section class=""><section class=""><section><section class=""><p><span style="font-size: 14px;letter-spacing: 1px;">长按识别二维码</span></p><p><span style="font-size: 14px;letter-spacing: 1px;">或</span></p><p><span style="font-size: 14px;letter-spacing: 1px;">搜索QQ群号：541224351</span></p></section></section><section class=""><img src="https://mmbiz.qpic.cn/mmbiz_png/PHoKvpweI43ROwQXv8wOhypCKraicukq8hZPVRVzcL4iaxicqE9Gl4Xflnb6OfrLjMkicpuW7x11xs4fTBXYJhINAQ/?wx_fmt=png" style="box-sizing: border-box; vertical-align: middle; word-wrap: break-word !important; visibility: visible !important; width: 195.391px !important; height: 195.391px !important;"></section></section></section></section><section class="" powered-by="xiumi.us"><section class=""><section class=""><p><br></p></section></section></section></section></section></section><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1515986097&src=3&ver=1&signature=yyLj*6br2FUtW3BtBE3siBo3oPDK8DK*88F4CWijxQ5EFX6jGrv3BrjQoFMwQzo-*jiN8gkDoGNv71FTxFvM1LqZEi0wj0QfD73rv5tlOCLHQGlYYIXBfUYQmnRROLrMNaeXSejQbqj1nCrPOLGqm*qPJCvOyhWP3YZfURRXoYo=">微信地址</a>
{% endraw  %}

