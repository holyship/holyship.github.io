---
title: 要不是因为苹果，混合应用开发将完胜 Native
author: kayson 译
wechat_source: >-
  http://mp.weixin.qq.com/s?timestamp=1499131566&src=3&ver=1&signature=iU4hCwtQzyv2pey6SDTnZ3i0rC89bkAj2aXa57Pgg6dvHZBlWIj1S8FOqHe4*f6AKQ38niscoOEIajuE5ND4q9ZNhu6qTFYdKnnB9uvK7xZjwkwNZaSdK5C-UeHa6ysxYt29hV4LvIOG1GmtPdjyrfS75pro-XtQTi4P0WouPo8=
date: '2017-06-25 00:00:00 +0000'

---

{% raw  %}
<p style="max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); white-space: normal; font-size: 14px; line-height: normal; font-family: 'Helvetica Neue'; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(0, 128, 255); font-size: 18px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">关注奇舞周刊<span style="max-width: 100%; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important;">，</span>由<span style="max-width: 100%; line-height: normal; box-sizing: border-box !important; word-wrap: break-word !important;">360</span>前端团队奇舞团带你领略前端前沿技术</strong></span></p><p style="max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); white-space: normal; font-size: 14px; line-height: normal; font-family: 'Helvetica Neue'; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(0, 128, 255); font-size: 18px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></strong></span></p><p style="max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-size: 16px; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; orphans: 2; white-space: pre-wrap; widows: 2; background-color: rgb(255, 254, 213); box-sizing: border-box !important; word-wrap: break-word !important;">编者按：本文由kayson在众成翻译平台上翻译。</span></p><p><img src="http://mmbiz.qpic.cn/mmbiz_gif/d8tibSEfhMMrEGhG182HJvkaWuepGyb2ciacLmIjeocpZ07CEDyVyz3RQrT7NbxyUKK18T8ZgGiaibmjWiczhBFdviaw/0?wx_fmt=gif" style="width: 770px !important; height: 577.5px !important; visibility: visible !important;"></p><p style="text-align: center;"><span style="color: rgb(136, 136, 136); font-size: 15px;">(图片来自网络)</span></p><p><span style="color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2;  widows: 2;"></span></p><p><span style="color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2;  widows: 2;"></span><span style="color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2;  widows: 2;">在过去的 6 个月里，我一直在开发&nbsp;</span><span class="" style="border: 0px; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">Rizer</span><span style="color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2;  widows: 2;">。这是个手机应用，它让用户给各种分类（目前有动物、小孩、食物、搞笑、男人、自然和女人）的照片 PK 赛评分，用户也可以提交自己的照片到这些分类里，让别人评分。照片采用 ELO 算法来排名（就是&nbsp;</span><span class="" style="border: 0px; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">电影《社交网络》里介绍FaceMash网站的场景中</span><span style="color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2;  widows: 2;">Eduardo Saverin 在窗户上画的那个公式），评分最高的将出现在 Rizer 的排行榜上。</span></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">Rizer 是一个混合应用，采用 <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">Apache Cordova</span>开发， 通过它上面<span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">大量的 native 插件</span>来获取用户设备上的重要的原生功能，例如推送通知、用相机拍照以及进行应用内购买。</p><p class="" style="margin: 15px auto; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; overflow: hidden; text-align: center; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><img src="http://mmbiz.qpic.cn/mmbiz_png/d8tibSEfhMMrEGhG182HJvkaWuepGyb2cqyJ1Q9ArohnN4MgUwMbNicdpVI2MEUvpO0ib8mcicX5ydY69ZGNtRflgQ/0?wx_fmt=png" style="border: 0px; vertical-align: middle; width: 600px !important; height: 1223px !important;"></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><span style="color: rgb(136, 136, 136);">目前我霸占了男人排行榜😎</span></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">一开始，一般用户并不知道 Rizer 是混合应用，这对我来说至关重要。这意味着它必须设计良好，性能出色 (performant。<span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">嘿，performant不是个英语单词！</span>)，不缺少用户会对此类应用期望的任何原生功能，并且当设备失去网络连接时不至于无法使用。幸运的是，根据我的40名亲友做beta测试的反馈，我实现了这个目标（我甚至可能都同意他们的看法了）。</p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">如果你不相信我，或者你已经玩过一阵子混合应用，那么我推荐你去<span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">下载 Rizer</span>，给照片比赛评分，看看排行榜上的一些分类，并且如果你有勇气的话，上传一些自己的照片。体验完后你很可能会被混合应用的能力所折服，如果没有，那至少也欣赏了一些可爱的动物和小宝贝。</p><h2 style="margin-top: 20px; margin-bottom: 12px; border-width: 0px 0px 1px; border-bottom-style: solid; border-bottom-color: rgb(25, 128, 230); font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 20px; color: rgb(25, 128, 230); text-align: center; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;"><strong style="border: 0px; font-size: inherit !important;">毫无疑问，转向混合应用是绝大多数应用的正确选择</strong></h2><h4 style="margin-top: 8px; margin-bottom: 5px; border: 0px; font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 18px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;">理解以下三个关键点非常重要：</h4><ul style="border: 0px; padding-left: 20px; line-height: 1.8; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;" class="list-paddingleft-2"><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">一个应用的混合版本一定不会跟原生版本一样快，但这无关紧要，只要混合版本足够快。</strong> 简单来说，如果你的用户从来不抱怨应用的性能，那么你的应用就是足够快的。作为一个性能狂，自己的应用运行得尽可能地快，我理解这种吸引力，但是我们必须小心避免过早、过度的优化。知道自己的原生应用在页面上渲染 100 张照片比混合应用版本快 8 毫秒，内心可能自我感觉良好，但用户能感觉得到或者在乎吗？不会。</p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">非常耗资源的 3D 游戏或类似的东西，不在我定义的 “应用”范围内。</strong> 这种情况下原生应用当然是你的最好选择，因为混合应用想要变快会非常吃力。Canvas 的性能在最近几年已经改善了很多，但是在旧设备上运行耗资源的应用还是会很慢。</p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">设计良好的混合应用，在现代 JavaScript UI 框架上运行，绝对够快</strong>。性能差不再是放弃混合方式的借口了。如果你最近尝试做一个混合应用，发现性能不够满意，那你应该认真重新评估一下你选择的设计模式，或者是用了大量像 jQuery 这样<span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">不需要的</span>库。学习下现代的 DOM API，如果还没学的话。我们的应用的所有的目标设备都支持它。</p></li></ul><h4 style="margin-top: 8px; margin-bottom: 5px; border: 0px; font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 18px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;"><strong style="border: 0px; font-size: inherit !important;">混合方式有一些主要的优势：</strong></h4><ul style="border: 0px; padding-left: 20px; line-height: 1.8; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;" class="list-paddingleft-2"><li><p><strong style="border: 0px;">你可以利用现有的 JS，HTML和CSS技术开发一套代码，可同时运行在 iOS 和 Android 上。</strong>这是混合应用最明显的优势，但也不能过分强调。在我的项目中，需要根据运行的平台来写分支代码的次数不超过十次（这只是为了解决一个 iOS 上的 bug，后面再详细说）。代码里的分支看起来像这样：</p></li></ul><blockquote class="" style="border: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;"><pre class="" style="border: 0px; padding: 1em; overflow: auto; background-color: rgb(39, 40, 34); color: rgb(248, 248, 242); font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace; max-width: 100%; word-wrap: normal; text-shadow: rgba(0, 0, 0, 0.298039) 0px 1px; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; border-top-left-radius: 0.3em; border-top-right-radius: 0.3em; border-bottom-right-radius: 0.3em; border-bottom-left-radius: 0.3em; box-sizing: border-box !important;"><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;"><span class="" style="border: 0px; color: rgb(102, 217, 239);">if</span>&nbsp;<span class="" style="border: 0px;">(</span>device<span class="" style="border: 0px;">.</span>platform&nbsp;<span class="" style="border: 0px;">===</span>&nbsp;<span class="" style="border: 0px; color: rgb(166, 226, 46);">"iOS"</span><span class="" style="border: 0px;">)</span>&nbsp;<span class="" style="border: 0px;">{</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(230, 219, 116);">doRidiculousWorkaround</span><span class="" style="border: 0px;">(</span><span class="" style="border: 0px;">)</span><span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;"><span class="" style="border: 0px;">}</span>&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">else</span>&nbsp;<span class="" style="border: 0px;">{</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(230, 219, 116);">doThingThatWorksAsExpected</span><span class="" style="border: 0px;">(</span><span class="" style="border: 0px;">)</span><span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;"><span class="" style="border: 0px;">}</span></p></pre></blockquote><ul style="border: 0px; padding-left: 20px; line-height: 1.8; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;" class="list-paddingleft-2"><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">开发阶段在设备上查看变动几乎是瞬时的。</strong>整个开发过程中，我在自己的 Galaxy S7 Edge 上测试了所有代码改动。这个手机连上我的电脑，启用 USB 调试模式，运行 Rizer 的 debug 版本。在 Chrome 地址栏输入 <span class="" style="margin-right: 2px; margin-left: 2px; border: 1px solid rgb(225, 225, 232); padding: 2px 4px; font-size: 14px; font-family: monospace; color: rgb(221, 17, 68); background-color: rgb(247, 247, 249); border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-break: break-word; word-wrap: break-word;">chrome://inspect/#devices</span> ，你会看到连接到你的电脑的设备上运行的所有 Chrome 标签页。点击列表里的 Rizer 页面，将会打开一个开发工具窗口，我就可以完整地分析 App 了，就像调试一个普通网站一样。这个功能加上构建系统里的 live reload 工具，我就可以在改动代码后几秒内在设备屏幕上看到更新后的结果了。棒呆。</p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">你可以把更新后的 JS，CSS，HTML，字体文件和图片直接推送给用户，无需重新编译 App 的二进制代码，也无需 App store 的审核。</strong>Rizer 使用了 <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">微软的 CodePush</span> 服务（目前免费）以及它的<span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">Cordova 插件</span>，每次启动时用来检查更新，说实话没有它我都不知道该怎么做。或者， <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">Ionic 的 Deploy</span> 也可以用同样的方式使用，但是因为它不免费并且我没有用 Ionic，没理由去用它。</p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">你可以选择自己最喜欢的 UI 框架和构建工具。</strong> Rizer 运行在我自己的前端框架 <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">Samson.js</span>上（别去用这个，它没有文档，并且为了满足我个人的需求经常变化），但我本来也可以用 React，Vue 或者 Ionic/Angular 来开发。</p></li></ul><blockquote class="" style="margin-top: 10px; margin-bottom: 10px; border-width: 0px 0px 0px 2px; border-left-color: rgb(18, 122, 230); padding-top: 10px; padding-right: 10px; padding-bottom: 10px; background-color: rgb(239, 239, 239); font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2; background-position: initial initial; background-repeat: initial initial;"><p style="border: 0px; line-height: 1.5; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; text-overflow: ellipsis; overflow: hidden;">“哇，Sam，那些优势听起来好赞！那有什么缺点吗？”</p></blockquote><h4 style="margin-top: 8px; margin-bottom: 5px; border: 0px; font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 18px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;">混合应用方式有一个主要的缺点：</h4><ul style="border: 0px; padding-left: 20px; line-height: 1.8; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;" class="list-paddingleft-2"><li><p><strong style="border: 0px;">作为开发者，我们仍然需要操心 iOS，也就是说我们不得不忍受苹果的那些狗屎。</strong>嘿，还押韵呢。</p></li></ul><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">你可能会困惑。即使选择原生方式，我们仍然要操心 iOS，因此也要忍受苹果的那些狗屎。对吧？</p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">还真是。</p><h4 style="margin-top: 8px; margin-bottom: 5px; border: 0px; font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 18px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;"><strong style="border: 0px; font-size: inherit !important;">无论采用哪种方式，我们都无法避免苹果的这些狗屎：</strong></h4><ul style="border: 0px; padding-left: 20px; line-height: 1.8; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;" class="list-paddingleft-2"><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">Xcode</strong></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">配置文件</strong></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">需要一台 Mac 来编译 App</strong></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">需要使用 TestFlight 构建 beta 版本</strong></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">App 审核流程</strong> 不可否认，app 审核时长已经缩短到<span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">平均 2 天</span>，但是当你的 app 像 Rizer 一样被拒 7 次（因为一些愚蠢的理由），你的耐心真的会磨没了。</p></li></ul><h4 style="margin-top: 8px; margin-bottom: 5px; border: 0px; font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 18px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;"><strong style="border: 0px; font-size: inherit !important;">除了以上几点，混合应用还要处理这坨狗屎：</strong></h4><ul style="border: 0px; padding-left: 20px; line-height: 1.8; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;" class="list-paddingleft-2"><li><p><strong style="border: 0px;">iOS WebView</strong></p></li></ul><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">等等，什么？iOS WebView 真的有那么差劲吗？没错。</p><h2 style="margin-top: 20px; margin-bottom: 12px; border-width: 0px 0px 1px; border-bottom-style: solid; border-bottom-color: rgb(25, 128, 230); font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 20px; color: rgb(25, 128, 230); text-align: center; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;">两种 WebView 的故事</h2><p style="margin-top: 8px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">混合应用里引入的 JavaScript 代码运行在 WebView 中，本质上它就是 app 里附带的原生浏览器。在 Android 上，我们的代码运行在基于 Chromium 的 WebView 里，大多数情况下会完全按照预期运行。在 iOS 上，我们可以选择让代码运行在两种 WebView 中： UIWebView 或 WKWebView.</p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><strong style="border: 0px;">如何选择这两种 WebViews <em style="border: 0px;">很伤脑筋</em>.</strong></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">UIWebView 在 iOS 2 中引入，当时是唯一的选择，直到 iOS 8 中加入了 WKWebView。UIWebView 与现有的大部分 Cordova 插件兼容性很好，但总体上太过臃肿、缓慢。两者之间 <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">对 HTML 5 的支持情况差异很小</span>， 但由于 WKWebView 使用了 Nitro JavaScript 引擎，性能差距非常大。</p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">据 <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">Nitishkumar Singh</span> 所说， WKWebView 提供了：</p><blockquote class="" style="margin-top: 10px; margin-bottom: 10px; border-width: 0px 0px 0px 2px; border-left-color: rgb(18, 122, 230); padding-top: 10px; padding-right: 10px; padding-bottom: 10px; background-color: rgb(239, 239, 239); font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2; background-position: initial initial; background-repeat: initial initial;"><p style="border: 0px; line-height: 1.5; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; text-overflow: ellipsis; overflow: hidden;">极大减少内存占用，启动更快，JavaScript 即时编译，独立进程渲染，占用更少的存储空间，稳定性更好，更安全，采用最新 web 标准等等。</p></blockquote><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">在 2014 年 iOS 8 发行之前，很多鼓吹 <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">WKWebView 对混合应用的重要性</span>的文章开始冒出来。能够利用 WKWebView 提供的以上优化特性，让混合应用的开发者们兴奋不已。</p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><strong style="border: 0px;">不幸的是，当 iOS 8 最终发版以后，WKWebView 完全不能兼容现有的混合应用，因为它缺少一些</strong> <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">必备的功能</strong></span><strong style="border: 0px;">。整整 3 年之后，情况只是稍微改观了一点。</strong></p><h2 style="margin-top: 20px; margin-bottom: 12px; border-width: 0px 0px 1px; border-bottom-style: solid; border-bottom-color: rgb(25, 128, 230); font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 20px; color: rgb(25, 128, 230); text-align: center; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;">WKWebView 的现状</h2><p style="margin-top: 8px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">感谢 <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">Ionic 团队的出色工作</span>，一些自讨苦吃的开发者（包括我自己）开始在他们的混合应用里使用 WKWebView。我会第一个站出来说，当 WKWebView 不出问题的时候，的确非常好用。<strong style="border: 0px;">在我老婆的 iPhone 7 上，Rizer 冷启动并安装 CodePush 更新的速度比在我的 Galaxy S7 Edge 上快多了。</strong>但如果它出问题时会怎样？让我们继续探究。</p><h4 style="margin-top: 8px; margin-bottom: 5px; border: 0px; font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 18px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;">那些需要奇技淫巧的变通方案或者只能干脆放弃功能的 WKWebView 问题：</h4><ul style="border: 0px; padding-left: 20px; line-height: 1.8; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;" class="list-paddingleft-2"><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">不能访问应用根部 <span class="" style="margin-right: 2px; margin-left: 2px; border: 1px solid rgb(225, 225, 232); padding: 2px 4px; font-size: 14px; font-family: monospace; color: rgb(221, 17, 68); background-color: rgb(247, 247, 249); border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-break: break-word; word-wrap: break-word;">www</span>目录以外的文件</strong></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">各种跨域问题，包括不能从 canvas 里提取图片数据，而这个 canvas 是用本地图片画上去的。</strong> 这差点搅黄了 Rizer，因为我需要允许用户裁剪照片和加滤镜效果，两者都需要在 canvas 里操作图片，然后从中提取像素数据。我之所以说 <em style="border: 0px;">差点搅黄</em>，是因为实际上我在 iOS 上通过代码分支曲线救国，做了下面这种扯淡的事：</p></li></ul><blockquote class="" style="border: 0px; padding-left: 0px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;"><pre class="" style="border: 0px; padding: 1em; overflow: auto; background-color: rgb(39, 40, 34); color: rgb(248, 248, 242); font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace; max-width: 100%; word-wrap: normal; text-shadow: rgba(0, 0, 0, 0.298039) 0px 1px; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; border-top-left-radius: 0.3em; border-top-right-radius: 0.3em; border-bottom-right-radius: 0.3em; border-bottom-left-radius: 0.3em; box-sizing: border-box !important;"><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;"><span class="" style="border: 0px; color: rgb(174, 129, 255);">1</span><span class="" style="border: 0px;">.</span>&nbsp;把从设备上获取的照片 fileURL 传给 FileReader API 的&nbsp;<span class="" style="border: 0px; color: rgb(166, 226, 46);">"readAsArrayBuffer"</span>&nbsp;函数。</p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 0; word-break: break-word; word-wrap: break-word; font-size: 14px; height: 6px; white-space: nowrap !important;"><br style="border: 0px;"></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;"><span class="" style="border: 0px; color: rgb(174, 129, 255);">2</span><span class="" style="border: 0px;">.</span>&nbsp;用下面的函数将&nbsp;<span class="" style="border: 0px; color: rgb(166, 226, 46);">"readAsArrayBuffer"</span>&nbsp;函数返回的 arrayBuffer 转成 base64 字符串：</p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 0; word-break: break-word; word-wrap: break-word; font-size: 14px; height: 6px; white-space: nowrap !important;"><br style="border: 0px;"></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 0; word-break: break-word; word-wrap: break-word; font-size: 14px; height: 6px; white-space: nowrap !important;"><br style="border: 0px;"></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">function</span>&nbsp;<span class="" style="border: 0px; color: rgb(230, 219, 116);">arrayBufferToBase64</span><span class="" style="border: 0px;">(</span>arrayBuffer<span class="" style="border: 0px;">)</span>&nbsp;<span class="" style="border: 0px;">{</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">var</span>&nbsp;binary&nbsp;<span class="" style="border: 0px;">=</span>&nbsp;<span class="" style="border: 0px; color: rgb(166, 226, 46);">''</span><span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">var</span>&nbsp;bytes&nbsp;<span class="" style="border: 0px;">=</span>&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">new</span>&nbsp;<span class="" style="border: 0px;">Uint8Array</span><span class="" style="border: 0px;">(</span>arrayBuffer<span class="" style="border: 0px;">)</span><span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">var</span>&nbsp;len&nbsp;<span class="" style="border: 0px;">=</span>&nbsp;bytes<span class="" style="border: 0px;">.</span>byteLength<span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">for</span>&nbsp;<span class="" style="border: 0px;">(</span><span class="" style="border: 0px; color: rgb(102, 217, 239);">var</span>&nbsp;i&nbsp;<span class="" style="border: 0px;">=</span>&nbsp;<span class="" style="border: 0px; color: rgb(174, 129, 255);">0</span><span class="" style="border: 0px;">;</span>&nbsp;i&nbsp;<span class="" style="border: 0px;">&lt;</span>&nbsp;len<span class="" style="border: 0px;">;</span>&nbsp;i<span class="" style="border: 0px;">++</span><span class="" style="border: 0px;">)</span>&nbsp;<span class="" style="border: 0px;">{</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary&nbsp;<span class="" style="border: 0px;">+</span><span class="" style="border: 0px;">=</span>&nbsp;String<span class="" style="border: 0px;">.</span><span class="" style="border: 0px; color: rgb(230, 219, 116);">fromCharCode</span><span class="" style="border: 0px;">(</span>bytes<span class="" style="border: 0px;">[</span>i<span class="" style="border: 0px;">]</span><span class="" style="border: 0px;">)</span><span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px;">}</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">return</span>&nbsp;window<span class="" style="border: 0px;">.</span><span class="" style="border: 0px; color: rgb(230, 219, 116);">btoa</span><span class="" style="border: 0px;">(</span>binary<span class="" style="border: 0px;">)</span><span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px;">}</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 0; word-break: break-word; word-wrap: break-word; font-size: 14px; height: 6px; white-space: nowrap !important;"><br style="border: 0px;"></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 0; word-break: break-word; word-wrap: break-word; font-size: 14px; height: 6px; white-space: nowrap !important;"><br style="border: 0px;"></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;"><span class="" style="border: 0px; color: rgb(174, 129, 255);">3</span><span class="" style="border: 0px;">.</span>&nbsp;在返回的 base64 字符串前面加上&nbsp;<span class="" style="border: 0px; color: rgb(166, 226, 46);">"data:image/jpeg;base64,"</span>，以创建 DOM 可读的&nbsp;<span class="" style="border: 0px; color: rgb(166, 226, 46);">"imageDataURL"</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 0; word-break: break-word; word-wrap: break-word; font-size: 14px; height: 6px; white-space: nowrap !important;"><br style="border: 0px;"></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;"><span class="" style="border: 0px; color: rgb(174, 129, 255);">4</span><span class="" style="border: 0px;">.</span>&nbsp;创建一个 Image 对象，加载我们的 imageDataURL 作为它的&nbsp;<span class="" style="border: 0px; color: rgb(166, 226, 46);">"src"</span>，当 image 加载完成时，创建一个新的 canvas 元素，把图片画上去。就像这样：</p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 0; word-break: break-word; word-wrap: break-word; font-size: 14px; height: 6px; white-space: nowrap !important;"><br style="border: 0px;"></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">var</span>&nbsp;image&nbsp;<span class="" style="border: 0px;">=</span>&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">new</span>&nbsp;<span class="" style="border: 0px;">Image</span><span class="" style="border: 0px;">(</span><span class="" style="border: 0px;">)</span><span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image<span class="" style="border: 0px;">.</span>onload&nbsp;<span class="" style="border: 0px;">=</span>&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">function</span><span class="" style="border: 0px;">(</span><span class="" style="border: 0px;">)</span>&nbsp;<span class="" style="border: 0px;">{</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(102, 217, 239);">var</span>&nbsp;canvas&nbsp;<span class="" style="border: 0px;">=</span>&nbsp;document<span class="" style="border: 0px;">.</span><span class="" style="border: 0px; color: rgb(230, 219, 116);">createElement</span><span class="" style="border: 0px;">(</span><span class="" style="border: 0px; color: rgb(166, 226, 46);">"canvas"</span><span class="" style="border: 0px;">)</span><span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;canvas<span class="" style="border: 0px;">.</span>width&nbsp;<span class="" style="border: 0px;">=</span>&nbsp;image<span class="" style="border: 0px;">.</span>width<span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;canvas<span class="" style="border: 0px;">.</span>height&nbsp;<span class="" style="border: 0px;">=</span>&nbsp;image<span class="" style="border: 0px;">.</span>height<span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;canvas<span class="" style="border: 0px;">.</span><span class="" style="border: 0px; color: rgb(230, 219, 116);">getContext</span><span class="" style="border: 0px;">(</span><span class="" style="border: 0px; color: rgb(166, 226, 46);">"2d"</span><span class="" style="border: 0px;">)</span><span class="" style="border: 0px;">.</span><span class="" style="border: 0px; color: rgb(230, 219, 116);">drawImage</span><span class="" style="border: 0px;">(</span>image<span class="" style="border: 0px;">,</span>&nbsp;<span class="" style="border: 0px; color: rgb(174, 129, 255);">0</span><span class="" style="border: 0px;">,</span>&nbsp;<span class="" style="border: 0px; color: rgb(174, 129, 255);">0</span><span class="" style="border: 0px;">)</span><span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px; color: rgb(230, 219, 116);">callback</span><span class="" style="border: 0px;">(</span>canvas<span class="" style="border: 0px;">)</span><span class="" style="border: 0px;">;</span>&nbsp;<span class="" spellcheck="true" style="border: 0px; color: slategray;">// No CORS issues</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="" style="border: 0px;">}</span><span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image<span class="" style="border: 0px;">.</span>src&nbsp;<span class="" style="border: 0px;">=</span>&nbsp;imageDataURL<span class="" style="border: 0px;">;</span></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 0; word-break: break-word; word-wrap: break-word; font-size: 14px; height: 6px; white-space: nowrap !important;"><br style="border: 0px;"></p><p class="" style="margin-top: 3px; margin-bottom: 3px; border: 0px; line-height: 16px; word-break: break-word; word-wrap: break-word; font-size: 14px; white-space: nowrap !important;"><span class="" style="border: 0px; color: rgb(174, 129, 255);">5</span><span class="" style="border: 0px;">.</span>&nbsp;把你的电脑扔出窗外&nbsp;<span class="" style="border: 0px;">:</span><span class="" style="border: 0px;">)</span></p></pre></blockquote><ul style="border: 0px; padding-left: 20px; line-height: 1.8; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;" class="list-paddingleft-2"><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">捉摸不定的垂直滚动行为，以及从我的经历来看完全不可用的水平滚动</strong>。有好几次，我老婆打开 Rizer 的排行榜页面后无法滚动照片，必须回到上一个页面并重新打开排行榜页面。这个问题如此严重，我到头来需要去实现 <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">iScroll</span>。 <em style="border: 0px;">唉</em>。</p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">完全不支持 getUserMedia</strong>。这对 Rizer 来说不是问题，但是它阻止了我开始另一个需要这个特性的项目。都 2017 年了，这完全不可接受。也进一步证明了 <span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">Safari 成了新的 IE</span>。</p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">无法通过程序控制显示和隐藏键盘</strong></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">跟稳定版的 Cordova SplashScreen 插件有导致 App 崩溃的冲突</strong></p></li><li><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word;"><strong style="border: 0px;">跟稳定版的 Cordova In-App Browser 插件有导致 App 崩溃的冲突</strong></p></li></ul><h4 style="margin-top: 8px; margin-bottom: 5px; border: 0px; font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 18px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;"><strong style="border: 0px; font-size: inherit !important;">你要知道，运行在 Android 上的混合应用不存在以上任何一个问题。</strong></h4><p style="margin-top: 8px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">说真的，我对 Google 提供的应用开发部署流程没有任何不满。Google Play 开发者控制台非常不可思议，有健壮的发布管理，A/B 测试，应用内产品创建，订单管理，应用安装和使用统计，用户反馈收集，并且也没有<span class="" style="border: 0px; word-break: break-word; word-wrap: break-word;">荒唐的审核流程</span>。锦上添花的是，我们知道混合应用会按照预期来渲染和运行，这要感谢 Android 基于 Chromium 的 WebView。 <strong style="border: 0px;">苹果在这点上落后太多了，以至于我一说起谷歌的产品就像个狂热粉丝。</strong></p><h4 style="margin-top: 8px; margin-bottom: 5px; border: 0px; font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 18px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;">毫无疑问，Rizer 的开发过程比我想象的更费时，也更令人沮丧……拜苹果所赐。</h4><p style="margin-top: 8px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">当我的家人问及 Rizer 的开发进度时，他们可以证明我对苹果和 iOS 有多深的怨念。我一直被这样一个事实打败： <strong style="border: 0px;">世界上最有价值的公司</strong>提供了如此糟糕的开发体验。</p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">我试图找出苹果为什么没有动力去改善混合应用开发的流程并让 Safari 像其他现代浏览器一样功能相当（它不像是没有资源去做这个），或者像其他平台（包括 Windows）一样直接允许使用第三方浏览器。难道他们是想让开发者在 Android 应用之前开发出 iOS 应用，然后 iPhone 或 iPad 用户就没那么想转向 Android 设备，因为他们每天使用的 App 在 Google Play 上没有？ <em style="border: 0px;">我真心希望不是这样</em>。</p><h2 style="margin-top: 20px; margin-bottom: 12px; border-width: 0px 0px 1px; border-bottom-style: solid; border-bottom-color: rgb(25, 128, 230); font-weight: bold; word-break: break-all; word-wrap: break-word; font-size: 20px; color: rgb(25, 128, 230); text-align: center; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-variant-ligatures: normal; orphans: 2; white-space: normal; widows: 2;">好吧，那……选择混合还是原生？</h2><p style="margin-top: 8px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">从我的经验来看，选择混合方式引起的所有潜在的卡壳问题，都有变通方案。发现和实现这些方案很麻烦，但的确能解决问题。因为这个原因，我很乐意说<strong style="border: 0px;">混合方式是你下一个 App 的正确选择</strong>。开发一个混合应用肯定会让你花费更长时间，但是依然比开发两个独立的原生应用要省时间，并且如果设计合理，对你的用户来说也会足够快。</p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 2; white-space: pre-wrap; word-break: break-word; word-wrap: break-word; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;">嘿，或许将来某一天苹果迷途知返，会为我们提供我们应得的开发体验。在那天到来之前，我还是希望这个“混合与原生”之争继续火下去。</p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 25.6px; white-space: pre-wrap; word-break: break-word; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); background-color: rgb(255, 255, 255); word-wrap: break-word !important; box-sizing: border-box !important;"><span style="border: 0px; max-width: 100%; line-height: 1.6; color: rgb(68, 68, 68); box-sizing: border-box !important; word-wrap: break-word !important;"><br style="border: 0px; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></span></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 25.6px; white-space: pre-wrap; word-break: break-word; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); background-color: rgb(255, 255, 255); word-wrap: break-word !important; box-sizing: border-box !important;"><span style="border: 0px; max-width: 100%; line-height: 1.6; color: rgb(68, 68, 68); box-sizing: border-box !important; word-wrap: break-word !important;"></span></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 25.6px; white-space: pre-wrap; word-break: break-word; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); text-align: center; background-color: rgb(255, 255, 255); word-wrap: break-word !important; box-sizing: border-box !important;"><span style="border: 0px; max-width: 100%; color: rgb(68, 68, 68); box-sizing: border-box !important; word-wrap: break-word !important;">奇舞周刊</span></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 25.6px; white-space: pre-wrap; word-break: break-word; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); text-align: center; background-color: rgb(255, 255, 255); word-wrap: break-word !important; box-sizing: border-box !important;"><span style="border: 0px; max-width: 100%; color: rgb(68, 68, 68); box-sizing: border-box !important; word-wrap: break-word !important;">———<span style="border: 0px; max-width: 100%; color: rgb(136, 136, 136); line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important;">————————————</span>———</span></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 25.6px; white-space: pre-wrap; word-break: break-word; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); text-align: center; background-color: rgb(255, 255, 255); word-wrap: break-word !important; box-sizing: border-box !important;"><span style="border: 0px; max-width: 100%; color: rgb(68, 68, 68); box-sizing: border-box !important; word-wrap: break-word !important;">领略前端技术 阅读奇舞周刊</span></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 25.6px; white-space: pre-wrap; word-break: break-word; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); text-align: center; background-color: rgb(255, 255, 255); word-wrap: break-word !important; box-sizing: border-box !important;"><br style="border: 0px; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: 1.5em; white-space: pre-wrap; word-break: break-word; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); text-align: center; background-color: rgb(255, 255, 255); word-wrap: break-word !important; box-sizing: border-box !important;"><span style="border: 0px; max-width: 100%; font-size: 13px; color: rgb(68, 68, 68); box-sizing: border-box !important; word-wrap: break-word !important;">长按二维码，关注奇舞周刊</span></p><p style="margin-top: 10px; margin-bottom: 10px; border: 0px; line-height: normal; white-space: pre-wrap; word-break: break-word; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; max-width: 100%; min-height: 1em; color: rgb(32, 32, 32); text-align: center; background-color: rgb(255, 255, 255); word-wrap: break-word !important; box-sizing: border-box !important;"><span style="border: 0px; max-width: 100%; font-size: 10px; color: rgb(68, 68, 68); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="border: 0px; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">▼</strong></span></p><p class="" style="margin: 15px auto; border: 0px; line-height: 25.6px; white-space: normal; word-break: break-word; overflow: hidden; text-align: center; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei'; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); background-color: rgb(255, 255, 255); word-wrap: break-word !important; box-sizing: border-box !important;"><img src="http://mmbiz.qpic.cn/mmbiz/d8tibSEfhMMpC84jhdw7cmZFzrDoG5IsHcpRcls0Ahx6PhRMAicM1gc2ZmG68Tb8t3cyaia5lFicoY8kWXWibCb609A/640?wx_fmt=jpeg" style="border: 0px; vertical-align: middle; box-sizing: border-box !important; word-wrap: break-word !important; visibility: visible !important; width: 200px !important; height: 200px !important;"></p><hr/><a href="http://mp.weixin.qq.com/s?timestamp=1499131566&src=3&ver=1&signature=iU4hCwtQzyv2pey6SDTnZ3i0rC89bkAj2aXa57Pgg6dvHZBlWIj1S8FOqHe4*f6AKQ38niscoOEIajuE5ND4q9ZNhu6qTFYdKnnB9uvK7xZjwkwNZaSdK5C-UeHa6ysxYt29hV4LvIOG1GmtPdjyrfS75pro-XtQTi4P0WouPo8=">微信地址</a> | <a href="http://zcfy.cc/article/if-it-weren-t-for-apple-hybrid-app-development-would-be-the-clear-winner-over-native-3241.html?t=new">阅读原文</a>
{% endraw  %}

